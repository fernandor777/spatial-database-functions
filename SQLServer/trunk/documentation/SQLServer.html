<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><link rel="shortcut icon" href="http://www.spatialdbadvisor.com/images/243t.png"/>
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-type" content="text/html; charset=ISO-8859-1" />
<link rel="stylesheet" href="./c_SQLServer.css" type="text/css" />
<title>./documentation/c_SQLServer</title>
<!-- Source: ./src/general/ -->
</head>
<body>
<div id="logo">
<a name="robo_top_of_doc">SPDBA General Function Documentation</a>
</div> <!-- logo -->
<h3>TABLE OF CONTENTS</h3>
<ul>
<li>1. <a href="#robo0">AFFINE/STMove (2008)</a></li>
<li>2. <a href="#robo1">AFFINE/STRotate (2008)</a></li>
<li>3. <a href="#robo2">AFFINE/STScale (2008)</a></li>
<li>4. <a href="#robo3">COGO/DD2DMS (2008)</a></li>
<li>5. <a href="#robo4">COGO/DMS2DD (2008)</a></li>
<li>6. <a href="#robo5">COGO/DMSS2DD (2008)</a></li>
<li>7. <a href="#robo6">COGO/STAddSegmentByCOGO (2008)</a></li>
<li>8. <a href="#robo7">COGO/STArcToChordSeparation (2008)</a></li>
<li>9. <a href="#robo8">COGO/STAzimuth (2008)</a></li>
<li>10. <a href="#robo9">COGO/STBearing (2008)</a></li>
<li>11. <a href="#robo10">COGO/STBearingBetweenPoints (2008)</a></li>
<li>12. <a href="#robo11">COGO/STCircle2Polygon (2008)</a></li>
<li>13. <a href="#robo12">COGO/STCogo2Line (2008)</a></li>
<li>14. <a href="#robo13">COGO/STComputeArcLength (2008)</a></li>
<li>15. <a href="#robo14">COGO/STComputeChordLength (2008)</a></li>
<li>16. <a href="#robo15">COGO/STComputeLengthToMidPoint (2012)</a></li>
<li>17. <a href="#robo16">COGO/STComputeTangentPoint (2012)</a></li>
<li>18. <a href="#robo17">COGO/STCreateCircle (2012)</a></li>
<li>19. <a href="#robo18">COGO/STCrossProductLength (2008)</a></li>
<li>20. <a href="#robo19">COGO/STDotProduct (2008)</a></li>
<li>21. <a href="#robo20">COGO/STFindAngleBetween (2012)</a></li>
<li>22. <a href="#robo21">COGO/STFindCircle (2008)</a></li>
<li>23. <a href="#robo22">COGO/STFindCircleByPoint (2012)</a></li>
<li>24. <a href="#robo23">COGO/STFindCircleFromArc (2012)</a></li>
<li>25. <a href="#robo24">COGO/STFindDeflectionAngle (2012)</a></li>
<li>26. <a href="#robo25">COGO/STFindLineIntersection (2008)</a></li>
<li>27. <a href="#robo26">COGO/STFindLineIntersectionBySegment (2008)</a></li>
<li>28. <a href="#robo27">COGO/STFindLineIntersectionDetails (2008)</a></li>
<li>29. <a href="#robo28">COGO/STFindPointBisector (2012)</a></li>
<li>30. <a href="#robo29">COGO/STGreatCircleBearing (2008)</a></li>
<li>31. <a href="#robo30">COGO/STGreatCircleDistance (2008)</a></li>
<li>32. <a href="#robo31">COGO/STisClockwiseAngle (2008)</a></li>
<li>33. <a href="#robo32">COGO/STisClockwiseArc (2008)</a></li>
<li>34. <a href="#robo33">COGO/STLine2Cogo (2008)</a></li>
<li>35. <a href="#robo34">COGO/STLine2CogoAsTable (2008)</a></li>
<li>36. <a href="#robo35">COGO/STNormalizeBearing (2008)</a></li>
<li>37. <a href="#robo36">COGO/STOptimalCircleSegments (2008)</a></li>
<li>38. <a href="#robo37">COGO/STPointFromBearingAndDistance (2008)</a></li>
<li>39. <a href="#robo38">COGO/STPointFromCOGO (2008)</a></li>
<li>40. <a href="#robo39">COGO/STResection - Computes resection point using Tienstra's Method from supplied parameters.</a></li>
<li>41. <a href="#robo40">COGO/STSubtendedAngle (2008)</a></li>
<li>42. <a href="#robo41">COGO/STSubtendedAngleByPoint (2008)</a></li>
<li>43. <a href="#robo42">COGO/STTileGeom (2008)</a></li>
<li>44. <a href="#robo43">COGO/STTiler (2012)</a></li>
<li>45. <a href="#robo44">COGO/STTileXY (2008)</a></li>
<li>46. <a href="#robo45">CONVERSION/STPointGeomAsText (2008)</a></li>
<li>47. <a href="#robo46">CONVERSION/STToGeography (2008)</a></li>
<li>48. <a href="#robo47">CONVERSION/STToGeometry (2012)</a></li>
<li>49. <a href="#robo48">CREATE/STMakeCircularLine (2008)</a></li>
<li>50. <a href="#robo49">CREATE/STMakeEnvelope (2008)</a></li>
<li>51. <a href="#robo50">CREATE/STMakeEnvelopeFromText (2008)</a></li>
<li>52. <a href="#robo51">CREATE/STMakeLine (2008)</a></li>
<li>53. <a href="#robo52">CREATE/STMakeLineFromGeometryCollection (2008)</a></li>
<li>54. <a href="#robo53">CREATE/STMakeLineFromMultiPoint (2008)</a></li>
<li>55. <a href="#robo54">CREATE/STMakeLineWktFromGeographyCollection (2008)</a></li>
<li>56. <a href="#robo55">CREATE/STMakeLineWktFromGeometryCollection (2008)</a></li>
<li>57. <a href="#robo56">CREATE/STMakeLineXY (2008)</a></li>
<li>58. <a href="#robo57">CREATE/STMakePoint (2008)</a></li>
<li>59. <a href="#robo58">EDITOR/STAppend (2012)</a></li>
<li>60. <a href="#robo59">EDITOR/STConvertToLineString (2008)</a></li>
<li>61. <a href="#robo60">EDITOR/STDelete (2008)</a></li>
<li>62. <a href="#robo61">EDITOR/STDeleteN (2008)</a></li>
<li>63. <a href="#robo62">EDITOR/STDensify (2012)</a></li>
<li>64. <a href="#robo63">EDITOR/STExtend (2008)</a></li>
<li>65. <a href="#robo64">EDITOR/STInsertN (2008)</a></li>
<li>66. <a href="#robo65">EDITOR/STInsertN (2012)</a></li>
<li>67. <a href="#robo66">EDITOR/STIsCompound (2012)</a></li>
<li>68. <a href="#robo67">EDITOR/STMulti (2012)</a></li>
<li>69. <a href="#robo68">EDITOR/STReduce (2008)</a></li>
<li>70. <a href="#robo69">EDITOR/STRemoveCollinearPoints (2012)</a></li>
<li>71. <a href="#robo70">EDITOR/STReverse (2012)</a></li>
<li>72. <a href="#robo71">EDITOR/STSetZ (2012)</a></li>
<li>73. <a href="#robo72">EDITOR/STSwapOrdinates (2008)</a></li>
<li>74. <a href="#robo73">EDITOR/STUpdate (2012)</a></li>
<li>75. <a href="#robo74">EDITOR/STUpdateN (2012)</a></li>
<li>76. <a href="#robo75">GEOPROCESSING/STBoundingDiagonal (2008)</a></li>
<li>77. <a href="#robo76">GEOPROCESSING/STCentroid</a></li>
<li>78. <a href="#robo77">GEOPROCESSING/STCentroid_A (2008)</a></li>
<li>79. <a href="#robo78">GEOPROCESSING/STCentroid_L (2008)</a></li>
<li>80. <a href="#robo79">GEOPROCESSING/STCentroid_P (2008)</a></li>
<li>81. <a href="#robo80">GEOPROCESSING/STCheckRadii (2008)</a></li>
<li>82. <a href="#robo81">GEOPROCESSING/STDump (2012)</a></li>
<li>83. <a href="#robo82">GEOPROCESSING/STDumpPoints (2008)</a></li>
<li>84. <a href="#robo83">GEOPROCESSING/STDumpRings (2012)</a></li>
<li>85. <a href="#robo84">GEOPROCESSING/STExplode (2012)</a></li>
<li>86. <a href="#robo85">GEOPROCESSING/STExtract (2008)</a></li>
<li>87. <a href="#robo86">GEOPROCESSING/STExtract (2012)</a></li>
<li>88. <a href="#robo87">GEOPROCESSING/STExtractPolygon (2012)</a></li>
<li>89. <a href="#robo88">GEOPROCESSING/STFilterRings (2008)</a></li>
<li>90. <a href="#robo89">GEOPROCESSING/STFlipVectors (2008)</a></li>
<li>91. <a href="#robo90">GEOPROCESSING/STOneSidedBuffer (2012)</a></li>
<li>92. <a href="#robo91">GEOPROCESSING/STParallel (2012)</a></li>
<li>93. <a href="#robo92">GEOPROCESSING/STParallelSegment (2012)</a></li>
<li>94. <a href="#robo93">GEOPROCESSING/STSegmentize (1.0)</a></li>
<li>95. <a href="#robo94">GEOPROCESSING/STSquareBuffer (2012)</a></li>
<li>96. <a href="#robo95">GEOPROCESSING/STVectorize (2008)</a></li>
<li>97. <a href="#robo96">GEOPROCESSING/STVertices (2008)</a></li>
<li>98. <a href="#robo97">INSPECT/STCoordDim (2008)</a></li>
<li>99. <a href="#robo98">INSPECT/STCoordDim (2012)</a></li>
<li>100. <a href="#robo99">INSPECT/STDetermine (2008)</a></li>
<li>101. <a href="#robo100">INSPECT/STEndPoint (2008)</a></li>
<li>102. <a href="#robo101">INSPECT/STEquals (2012)</a></li>
<li>103. <a href="#robo102">INSPECT/STGeometryTypes (2012)</a></li>
<li>104. <a href="#robo103">INSPECT/STIsPseudoMultiCurve (2012)</a></li>
<li>105. <a href="#robo104">INSPECT/STNumDims (2012)</a></li>
<li>106. <a href="#robo105">INSPECT/STNumRings (2012)</a></li>
<li>107. <a href="#robo106">INSPECT/STStartPoint (2008)</a></li>
<li>108. <a href="#robo107">MBR/STGeography2MBR (2008)</a></li>
<li>109. <a href="#robo108">MBR/STGeometry2MBR (2008)</a></li>
<li>110. <a href="#robo109">MBR/STMBR2Geography (2008)</a></li>
<li>111. <a href="#robo110">MBR/STMBR2Geometry (2008)</a></li>
<li>112. <a href="#robo111">MBR/STMBRLongestSide (2008)</a></li>
<li>113. <a href="#robo112">MBR/STMBRShortestSide (2008)</a></li>
<li>114. <a href="#robo113">SORT/ST_Morton (2008)</a></li>
<li>115. <a href="#robo114">SORT/STMorton (2008)</a></li>
<li>116. <a href="#robo115">TOOLS/_STArray (2008)</a></li>
<li>117. <a href="#robo116">TOOLS/dhms (2008)</a></li>
<li>118. <a href="#robo117">TOOLS/Generate_Series (2008)</a></li>
<li>119. <a href="#robo118">TOOLS/STIsGeographicSrid (2012)</a></li>
<li>120. <a href="#robo119">TOOLS/STNumArray (2008)</a></li>
<li>121. <a href="#robo120">TOOLS/STPointAsText (2008)</a></li>
<li>122. <a href="#robo121">TOOLS/Tokenizer (2008)</a></li>
<li>123. <a href="#robo122">TOOLS/Tokenizer (2012)</a></li>
</ul>
<a name="robo0"></a>
<a name="AFFINE2fSTMove2028200829"></a>
<h1>1.  AFFINE/STMove (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMove -- Function which moves a geometry using the supplied delta X, Y, Z and M ordinate values.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMove (
               @p_geometry geometry,
               @p_dX       float,
               @p_dY       float,
               @p_dZ       float,
               @p_dM       float,
               @p_round_xy int = 3,
               @p_round_zm int = 2
             )
     Returns geometry
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STMove](geometry::ST_GeomFromText('LINESTRING(0.1 0.2,1.4 45.2)',0),-5.0,30.1,default,default,2,1).AsTextZM() as movedGeom;
    # movedGeom
    'LINESTRING(-4.9 30.2,-3.6 31.5)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that moves the supplied geometry's ordinates the supplied x, y, z and m deltas.
    The computed ordinates of the new geometry are rounded to @p_round_xy/@p_round_zm number of decimal digits of precision.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Supplied geometry of any type.
    @p_dX          (float) - X ordinate delta shift.
    @p_dy          (float) - Y ordinate delta shift.
    @p_dZ          (float) - Z ordinate delta shift.
    @p_dM          (float) - M ordinate delta shift.
    @p_round_xy      (int) - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm      (int) - Decimal degrees of precision to which calculated ZM ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    moved geom  (geometry) - Input geometry moved by supplied X and Y ordinate deltas.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo1"></a>
<a name="AFFINE2fSTRotate2028200829"></a>
<h1>2.  AFFINE/STRotate (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STRotate -- Function which rotates a geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STRotate (
               @p_geometry geometry,
               @p_rX       float,
               @p_rY       float,
               @p_angle    float,
               @p_round_xy int,
               @p_round_zm int 
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    With data as (
    select 'Original' as name, geometry::STGeomFromText('POLYGON((1 1, 1 6, 11 6, 11 1, 1 1))',0) as geom
    )
    SELECT name, geom.STAsText() as rGeom 
      FROM (select name, geom 
              from data as d
            union all
            select '45' + CHAR(176) + ' rotate about 0,0' as name, [$(owner)].[STRotate](d.geom,0.0,0.0,45,3,3) as geomO
              from data as d
            union all
            select '45' + CHAR(176) + ' rotate about MBR centre' as name, [$(owner)].[STRotate](d.geom,(a.minx + a.maxx) / 2.0,(a.miny + a.maxy) / 2.0,45,3,3) as geom
              from data as d
                   cross apply
                   [$(owner)].[STGEOMETRY2MBR](d.geom) as a
          ) as f
    GO
    name    rGeom
    Original    POLYGON ((1 1, 1 6, 11 6, 11 1, 1 1))
    45° rotate about 0,0    POLYGON ((0 1.414, -3.536 4.95, 3.536 12.021, 7.071 8.485, 0 1.414))
    45° rotate about MBR centre    POLYGON ((4.232 -1.803, 0.697 1.732, 7.768 8.803, 11.303 5.268, 4.232 -1.803))
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function which rotates the supplied geometry around a supplied rotation point (X,Y) a required angle in degrees between 0 and 360.
    The computed ordinates of the new geometry are rounded to the appropriate decimal digits of precision.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - supplied geometry of any type.
    @p_rX       (float)    - X ordinate of rotation point.
    @p_rY       (float)    - Y ordinate of rotation point.
    @p_angle    (float)    - Rotation angle expressed in decimal degrees between 0 and 360.
    @p_round_xy (int)      - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm (int)      - Decimal degrees of precision to which calculated XM ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    geometry -- Input geometry rotated by supplied values.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Server.
  COPYRIGH
    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo2"></a>
<a name="AFFINE2fSTScale2028200829"></a>
<h1>3.  AFFINE/STScale (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STScale -- TSQL Function that moves a geometry object's ordinates using the supplied delta X, Y, Z and M.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STScale (@p_geometry geometry,
                      @p_xFactor  float,
                      @p_yFactor  float,
                      @p_zFactor  float,
                      @p_mFactor  float,
                      @p_round_xy int = 3,
                      @p_round_zm int = 2 
                    )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    -- XY
    SELECT [dbo].[STScale](
                    geometry::STGeomFromText('LINESTRING(0.1 0.2,1.4 45.2)',0),
                    -5.0,
                     3.2,
                     NULL,
                     NULL,
                     3,
                     2
           ).AsTextZM() as scaledGeom;

    scaledGeom
    LINESTRING (-0.5 0.64, -7 144.64)

    -- XYM
    SELECT [dbo].[STScale](
                    geometry::STGeomFromText('LINESTRING(0.1 0.2 NULL 1.0,1.4 45.2 NULL 45.02)',0),
                     NULL,
                     NULL,
                     NULL,
                     1.5,
                     3,
                     2
            ).AsTextZM() as scaledGeom;
     
     scaledGeom
     LINESTRING (0.1 0.2 NULL 1.5, 1.4 45.2 NULL 67.53)

    -- XYZM
    SELECT [dbo].[STScale](
                    geometry::STGeomFromText('LINESTRING(0.1 0.2 0.9 1.0,1.4 45.2 2.1 45.02)',0),
                     1.0,
                     1.0,
                     2.0,
                     1.5,
                     3,
                     2
            ).AsTextZM() as scaledGeom;
     
     scaledGeom
     LINESTRING (0.1 0.2 1.8 1.5, 1.4 45.2 4.2 67.53)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that scales the supplied geometry's ordinates using the supplied scale factors.
    The computed ordinates of the new geometry are rounded to the appropriate decimal digits of precision.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - supplied geometry of any type.
    @p_xFactor  (double)   - X ordinate scale factor.
    @p_yFactor  (double)   - Y ordinate scale factor.
    @p_zFactor  (double)   - Z ordinate scale factor.
    @p_mFactor  (double)   - M ordinate scale factor.
    @p_round_xy (int)      - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm (int)      - Decimal degrees of precision to which calculated XM ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    geometry -- Input geometry scaled by supplied ordinate factor values.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo3"></a>
<a name="COGO2fDD2DMS2028200829"></a>
<h1>4.  COGO/DD2DMS (2008) [ Methods ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Methods ]</p>
<p class="item_name">NAME</p>
<pre>    DD2DMS -- Function converts a decimal degree floating point number to its string equivalent.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(cogoowner)].[DD2DMS] (
               @dDecDeg       Float,
               @pDegreeSymbol NVarChar(1),
               @pMinuteSymbol NVarChar(1),
               @pSecondSymbol NVarChar(1) 
             )
     Returns nvarchar(50)
</pre>
<p class="item_name">USAGE</p>
<pre>     SELECT [$(cogoowner)].[DD2DMS](45.5083333333333,'^','''','"') as DMS;
     DMS
     45^30'30.00"
     
     SELECT [$(cogoowner)].[DD2DMS](45.5083333333333,CHAR(176),CHAR(39),'"') as DMS;
     DMS
     45°30'30.00"
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that converts the supplied decimal degrees value to a string using the supplied symbols.
</pre>
<p class="item_name">NOTES</p>
<pre>    Normalization of the returned value to ensure values are between 0 and 360 degrees can be conducted via the STNormalizeBearing function.
    Useful for working with Google Earth
</pre>
<p class="item_name">INPUTS</p>
<pre>    @dDecDeg       (Float)       - Decimal degrees value.
    @pDegreeSymbol (NVarChar(1)) - Degrees symbol eg ^
    @pMinuteSymbol (NVarChar(1)) - Seconds symbol eg '
    @pSecondSymbol (NVarChar(1)) - Seconds symbol eg "
</pre>
<p class="item_name">RESULT</p>
<pre>    DMS (string) : Decimal degrees string equivalent.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2012-2017 by TheSpatialDBAdvisor/Simon Greener
  LICENSE
      Creative Commons Attribution-Share Alike 2.5 Australia License.
      <a href="http://creativecommons.org/licenses/by-sa/2.5/au/">http://creativecommons.org/licenses/by-sa/2.5/au/</a>
</pre>
<a name="robo4"></a>
<a name="COGO2fDMS2DD2028200829"></a>
<h1>5.  COGO/DMS2DD (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    DMS2DD -- Function computes a decimal degree floating point number from individual degrees, minutes and seconds values.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function DMS2DD(@p_dDeg  Int,
                    @p_dMin  Int,
                    @p_dSec  Float )
     Returns Float
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(cogoowner)].[DMS2DD](45,30,30) as DD;
    DD
    45.5083333333333
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that computes the decimal equivalent to the supplied degrees, minutes and seconds values.
    No checking of the values of each of the inputs is conducted: one can supply 456 minutes if one wants to!
</pre>
<p class="item_name">NOTES</p>
<pre>    Normalization of the returned value to ensure values are between 0 and 360 degrees can be conducted via the STNormalizeBearing function.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dDeg (int)   : Non-NULL degree value (0-360)
    @p_dMin (int)   : Non-NULL minutes value (0-60)
    @p_dSec (float) : Non-NULL seconds value (0-60)
</pre>
<p class="item_name">RESULT</p>
<pre>    DecimalDegrees (float) : Decimal degrees equivalent value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
  LICENSE
      Creative Commons Attribution-Share Alike 2.5 Australia License.
      <a href="http://creativecommons.org/licenses/by-sa/2.5/au/">http://creativecommons.org/licenses/by-sa/2.5/au/</a>
</pre>
<a name="robo5"></a>
<a name="COGO2fDMSS2DD2028200829"></a>
<h1>6.  COGO/DMSS2DD (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    DMSS2DD -- Function computes a decimal degree floating point number from individual degrees, minutes and seconds values encoded in supplied string.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function DMSS2DD(@p_strDegMinSec nvarchar(100))
     Returns Float
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(cogoowner)].[DMSS2DD]('43° 0'' 50.00"S') as DD;
    DD
    -43.0138888888889
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    The function parses the provided string (eg extracted from Google Earth) that contains DD MM SS.SS values, extracts and creates a single floating point decimal degrees value.
    No checking of the values of each of the inputs is conducted: one can supply 456 minutes if one wants to!
    The function honours N, S, E and W cardinal references.
</pre>
<p class="item_name">NOTES</p>
<pre>    Normalization of the returned value to ensure values are between 0 and 360 degrees can be conducted via the STNormalizeBearing function.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_strDegMinSec (nvarchar(100)) : DD MM SS.SS description eg 43° 0'' 50.00"S
</pre>
<p class="item_name">RESULT</p>
<pre>    DecimalDegrees (float) : Decimal degrees equivalent value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
  LICENSE
      Creative Commons Attribution-Share Alike 2.5 Australia License.
      <a href="http://creativecommons.org/licenses/by-sa/2.5/au/">http://creativecommons.org/licenses/by-sa/2.5/au/</a>
</pre>
<a name="robo6"></a>
<a name="COGO2fSTAddSegmentByCOGO2028200829"></a>
<h1>7.  COGO/STAddSegmentByCOGO (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STAddSegmentByCOGO - Returns a projected point given starting point, a bearing in Degrees, and a distance (geometry SRID units).
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STAddSegmentByCOGO (
               @p_linestring geometry,
               @p_dBearing   float,
               @p_dDistance  float
               @p_round_xy   int = 3,
               @p_round_zm   int = 2
             )
     Returns float 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(cogoowner)].[STAddSegmentByCOGO] (geometry::STGeomFromText('LINESTRING(0 0,10 0)',0),90,10,3,2).STAsText() as newSegment;
    newSegment
    LINESTRING (0 0,10 0,20 0)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that adds a new segment (two vertices) to an existing linestring's beginning or end. 
    New point is created from a start or end coordinate, using a whole circle bearing (p_dBearing) and a distance (p_dDistance) in SRID Units.
    Returned point's XY ordinates are rounded to @p_round_xy decimal digits of precision.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring (geometry) - Linestring.
    @p_dBearing      (float) - Whole circle bearing between 0 and 360 degrees.
    @p_dDistance     (float) - Distance in SRID units from starting point to required point.
    @p_round_xy        (int) - XY ordinates decimal digitis of precision.
    @p_round_zm        (int) - ZM ordinates decimal digitis of precision.
</pre>
<p class="item_name">RESULT</p>
<pre>    Modified line (geometry) - modified Linestring.
</pre>
<p class="item_name">TODO</p>
<pre>    Z,M extrapolation.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo7"></a>
<a name="COGO2fSTArcToChordSeparation2028200829"></a>
<h1>8.  COGO/STArcToChordSeparation (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STArcToChordSeparation -- Returns the distance between the midpoint of the Arc and the Chord for an angle given the radius
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STArcToChordSeparation ( 
               @p_dRadius Float,
               @p_dAngle  Float
             )
     Returns float
    SELECT [$(cogoowner)].[STArcToChordSeparation](100, 10);
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Chords are needed when "stroking" a circularstring to a vertex-connected linestring.
    To do this, one needs to compute such parameters as arc length, chord length and arc to chord separation.
    The arc to chord separation is important in that large values create linestring segments that clearly diverge from the cicular arc.
    Different values therefore given different ascetic results.
    This function computes the arc to chord separation (meters or in srid distance units) given a radius and an 
    angle (degrees 0..360) subtended at the centre of the circle defining the CircularString
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dRadius          (float) : Radius of Circle.
    @p_dAngle           (float) : The Angle subtended at the centre of the circle in degrees between 0 and 360.
</pre>
<p class="item_name">RESULT</p>
<pre>    separation distance (float) - ArcToChord separation distance.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>   Simon Greener - Feb 2015 - Converted to TSQL for SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo8"></a>
<a name="COGO2fSTAzimuth2028200829"></a>
<h1>9.  COGO/STAzimuth (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STAzimuth -- Returns a (Normalized) azimuth in Degrees between two non-geodetic (XY) coordinates
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STBearing (
               @p_dE1 float,
               @p_dN1 float,
               @p_dE2 float,
               @p_dN2 float
             )
     Returns float 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(cogoowner)].[STAzimuth](0,0,45,45) as Bearing;
    Bearing
    45
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that computes the azimuth from the supplied start point (@p_dx1) to the supplied end point (@p_dx2).
    The result is expressed as a whole circle bearing in decimal degrees.
    This function is an alternate implemetation of STBearing whose results should always be the same.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dE1 (float) - X ordinate of start point.
    @p_dN1 (float) - Y ordinate of start point.
    @p_dE2 (float) - Z ordinate of start point.
    @p_dN2 (float) - M ordinate of start point.
</pre>
<p class="item_name">RESULT</p>
<pre>    decimal degrees (float) - Azimuth between point 1 and 2 from 0-360.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo9"></a>
<a name="COGO2fSTBearing2028200829"></a>
<h1>10.  COGO/STBearing (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STBearing -- Returns a (Normalized) bearing in Degrees between two non-geodetic (XY) coordinates
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STBearing (
               @p_dE1 float,
               @p_dN1 float,
               @p_dE2 float,
               @p_dN2 float
             )
     Returns float 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(cogoowner)].[STBearing](0,0,45,45) as Bearing;
    Bearing
    45
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that computes the bearing from the supplied start point (@p_dx1) to the supplied end point (@p_dx2).
    The result is expressed as a whole circle bearing in decimal degrees.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dE1 (float) - X ordinate of start point.
    @p_dN1 (float) - Y ordinate of start point.
    @p_dE2 (float) - Z ordinate of start point.
    @p_dN2 (float) - M ordinate of start point.
</pre>
<p class="item_name">RESULT</p>
<pre>    decimal degrees (float) - Bearing between point 1 and 2 from 0-360.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo10"></a>
<a name="COGO2fSTBearingBetweenPoints2028200829"></a>
<h1>11.  COGO/STBearingBetweenPoints (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STBearingBetweenPoints -- Returns a (Normalized) bearing in Degrees between two non-geodetic (XY) geometry points
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STBearingBetweenPoints (
               @p_start_point geometry,
               @p_end_point   geometry
             )
     Returns float 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(cogoowner)].[STBearingBetweenPoints] (
             geometry::Point(0,0,0),
             geometry::Point(45,45,0) 
           ) as Bearing;
    Bearing
    45
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that computes the bearing from the supplied start point to the supplied end point.
    The result is expressed as a whole circle bearing in decimal degrees.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_start_point (geometry) - Start point.
    @p_end_point   (geometry) - End point.
</pre>
<p class="item_name">RESULT</p>
<pre>    decimal degrees (float) - Bearing between point 1 and 2 from 0-360.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2008 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo11"></a>
<a name="COGO2fSTCircle2Polygon2028200829"></a>
<h1>12.  COGO/STCircle2Polygon (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STCircle2Polygon -- Returns stroked Polygon shape from circle definition of centre XY and radius.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STCircle2Polygon ( 
               @p_dCentreX  Float,
               @p_dCentreY  Float,
               @p_dRadius   Float
               @p_iSegments int
               @p_srid      int,
               @p_round_xy  Int = 3
             )
     Returns geometry
   SELECT [$(cogoowner)].[STCircle2polygon](100,100,5.0,144,0,3);
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Given a 3 points defining a circular arc this function computes the centre and radius of the circle of 
    which it is a part of its circumference.
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
    Created polyon geometry has required ring rotation.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dCentreX  (float) : X Ordinate of centre of Circle
    @p_dCentreY  (float) : Y Ordinate of centre of Circle
    @p_dRadius   (float) : Radius of Circle
    @p_iSegments   (int) : Number of arc (chord) segments in circle (+ve clockwise, -ve anti-clockwise)
    @p_Srid        (int) : Spatial Reference Id of geometry
    @p_Round_xy    (int) : Precision of any XY ordinate value ie number of significant digits. If null then 3 is assumed (ie 1 mm): 3456.2345245 -&gt; 3456.235.
</pre>
<p class="item_name">RESULT</p>
<pre>    polygon   (geometry) : Circle as stroked polygon.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>   Simon Greener - May 2011 - Converted to TSQL for SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo12"></a>
<a name="COGO2fSTCogo2Line2028200829"></a>
<h1>13.  COGO/STCogo2Line (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STCogo2Line - Creates linestring from move, bearing and distance instructions supplied in the XML parameter.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>   Function [$(cogoowner)].[STCogo2Line] (
       @p_cogo     xml,
       @p_round_xy int = 3,
       @p_round_z  int = 2
    )
    Returns Geometry
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    Print 'Generate XYZ linestring using ordinate string moveTo.';
    Declare @v_cogo xml;
    SET @v_cogo = 
    '&lt;Cogo srid="28356"&gt;
    &lt;Segments&gt;
    &lt;Segment id="1"&gt;&lt;MoveTo&gt;10 10 -1&lt;/MoveTo&gt;&lt;DegMinSec&gt; 345°21''48.75"&lt;/DegMinSec&gt;&lt;Distance&gt;7.26992&lt;/Distance&gt;&lt;DeltaZ&gt;1&lt;/DeltaZ&gt;&lt;/Segment&gt;
    &lt;Segment id="2"&gt;&lt;DegMinSec&gt;  83° 2''4.652"&lt;/DegMinSec&gt;&lt;Distance&gt;151.712&lt;/Distance&gt;&lt;DeltaZ&gt;2&lt;/DeltaZ&gt;&lt;/Segment&gt;
    &lt;Segment id="3"&gt;&lt;DegMinSec&gt; 186°34''30.73"&lt;/DegMinSec&gt;&lt;Distance&gt;10.3924&lt;/Distance&gt;&lt;DeltaZ&gt;3&lt;/DeltaZ&gt;&lt;/Segment&gt;
    &lt;/Segments&gt;
    &lt;/Cogo&gt;';
    select [cogo].[STCogo2Line] (@v_cogo, 3, 2).AsTextZM() as cogoLine
    GO
    LINESTRING(10 10 -1,8.163 17.034 0,158.755 35.432 2,157.565 25.108 5)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function takes a set of bearings and distances supplied in XML format, and creates a linestring from it.
    The COGO bearings can be supplied as decimal degrees or as a text string sutable for use with DMSS2DD.
    If @p_start_point is supplied then its XY ordinates, and SRID, are used for the starting point of the line, otherwise 0,0 and 0 SRID.
    The final geometry will have its XY ordinates rounded to @p_round_xy of precision, similarly for Z.
    COGO XML Format:
      &lt;Cogo srid={int}&gt;
       &lt;Segments&gt;
         &lt;Segment id="?"&gt;
           &lt;MoveTo&gt;&lt;/MoveTo&gt;
           &lt;DegMinSec&gt;&lt;/DegMinSec&gt;
           &lt;Bearing&gt;&lt;/Bearing&gt;
           &lt;Distance&gt;&lt;/Distance&gt;
           &lt;DeltaZ&gt;&lt;/DeltaZ&gt;
         &lt;Segment id="?"&gt;
         &lt;Segment&gt;
           ....
         &lt;Segment&gt;
       &lt;/Segments&gt;
      &lt;/Cogo&gt;
    &lt;moveTo&gt; allows for a point object to be provided for the start point, or can denote a break between linestrings.
    &lt;moveTo&gt; should contain either a POINT() WKT object or the coordinate string part of a POINT() WKT object eg
       POINT(1 2 -1) -- XYZ
       1 2 -1
    &lt;moveTo&gt; associated with first &lt;Segment&gt; determines if linestring 2D or 3D. 
    If &lt;moveTo&gt; missing for first &lt;Segment&gt;, linestring is 2D regardless as to whether any other &lt;moveTo&gt;s exist in any other &lt;Segment&gt;
    If linestring is XYZ then &lt;DeltaZ&gt; elements are expected.
    &lt;DegMinSec&gt; does not have to exist if &lt;Bearing&gt; (decimal degrees) exists.
    &lt;DeltaZ&gt; is optional, if not, a 3D &lt;MoveTo&gt; is expected for the first &lt;Segment&gt;
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_cogo     (xml) - MoveTos, Bearings, Distances and DeltaZ instructions
    @p_round_xy (int) - Rounding factor for XY ordinates.
    @p_round_z  (int) - Rounding factor for Z ordinate.
</pre>
<p class="item_name">RESULT</p>
<pre>    linestring geometry - New linestring geometry object.
  NOTE 
    Measures not supported: see LRS functions.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - June 2018 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2017 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo13"></a>
<a name="COGO2fSTComputeArcLength2028200829"></a>
<h1>14.  COGO/STComputeArcLength (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STComputeArcLength -- Returns the length of the Circular Arc subtended by @p_dAngle (degrees between 0 and 360) at the centre of a circular of radius @p_dRadius.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STComputeArcLength ( 
                @p_dRadius Float,
                @p_dAngle  Float
             )
     Returns float
    SELECT [$(cogoowner)].[STComputeArcLength](100, 0.003);
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns the length of the chord subtended by the supplied angle (degrees between 0 and 360) at the centre of a circular with the given radius.
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dRadius (float) : Radius of Circle.
    @p_dAngle  (float) : The Angle subtended at the centre of the circle in degrees between 0 and 360.
</pre>
<p class="item_name">RESULT</p>
<pre>    ArcLength  (float) : The length of the circular arc.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>   Simon Greener - Feb 2015 - Converted to TSQL for SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo14"></a>
<a name="COGO2fSTComputeChordLength2028200829"></a>
<h1>15.  COGO/STComputeChordLength (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STComputeChordLength -- Returns the length of the chord for an angle given the radius.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STComputeChordLength ( 
                @p_dRadius Float,
                @p_dAngle  Float
             )
     Returns float
    SELECT [$(cogoowner)].[STComputeChordLength](100, 0.003);
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns the length of the chord subtended by an angle (degrees between 0 and 360) at the centre of a circular of radius @p_dRadius.
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dRadius   (float) : Radius of Circle.
    @p_dAngle    (float) : The Angle subtended at the centre of the circle in degrees between 0 and 360.
</pre>
<p class="item_name">RESULT</p>
<pre>    ChordLength  (float) : The length of the chord in metres.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>   Simon Greener - May 2011 - Converted to TSQL for SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo15"></a>
<a name="COGO2fSTComputeLengthToMidPoint2028201229"></a>
<h1>16.  COGO/STComputeLengthToMidPoint (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STComputeLengthToMidPoint - Returns the length of the arc defined by the first and second (mid) points of a CircularString.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STComputeLengthToMidPoint (
               @p_circular_arc geometry 
             )
     Returns float (arc length)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with a circular arc with 3 points, this function computes the arc length from the first to the second points.
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
    Only supports SQL Server Spatial 2012 onwards as 2008 does not support CIRCULARSTRINGs
</pre>
<p class="item_name">TODO</p>
<pre>    Support measuring arc length from 1st to 3rd or 2nd to 3rd point
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_circular_arc (geometry) - A Single CircularString with 3 points.
</pre>
<p class="item_name">RESULT</p>
<pre>    length             (float) - The length of the arc in SRID units.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2017 - Original TSQL coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo16"></a>
<a name="COGO2fSTComputeTangentPoint2028201229"></a>
<h1>17.  COGO/STComputeTangentPoint (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STComputeTangentPoint -- Computes point that would define a tangential line at the start or end of a circular arc
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STComputeTangentPoint ( 
               @p_circular_arc geometry,
               @p_position     varchar(5) = 'START', -- or 'END'
               @p_round_xy     int = 3
             )
     Returns geometry
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT [cogo].[STComputeTangentPoint](
                     geometry::STGeomFromText('CIRCULARSTRING(10 0, 15 5, 20 0)',0),
                     'START',
                     2)
                 .STAsText() as tangentPoint;
    
    tangentPoint
    POINT (10 5)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    There is a need to be able to compute an angle between a linestring and a circularstring. 
    To do this, one needs to compute a tangential line at the start or end of a circularstring.
    This function computes point that would define a tangential line at the start or end of a circular arc.
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
    Only supports SQL Server Spatial 2012 onwards as 2008 does not support CircularString
</pre>
<p class="item_name">TODO</p>
<pre>    Enable creating of tangent at mid point of circularstring (@p_position=MID).
    Enable creating of tangent at a distance along the circularstring.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_circular_arc (geometry) - CircularString.
    @p_position     (varchar5) - Requests tangent point for 'START' or 'END' of circular arc.
    @p_round_xy          (int) - Decimal degrees of precision for XY ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    point           (geometry) - A tangent point that combined with the start or end of the circularstring creates a tangential line.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>   Simon Greener - Feb 2015 - Converted to TSQL for SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo17"></a>
<a name="COGO2fSTCreateCircle2028201229"></a>
<h1>18.  COGO/STCreateCircle (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STCreateCircle -- Creates Circular polygon from Centre XY, Radius, Srid and Ordinate Round
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STCreateCircle ( 
               @dCentreX Float,
               @dCentreY Float,
               @dRadius  Float
               @iSrid    int,
               @iRound   Int = 3
             )
     Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Given a 3 points defining a circular arc this function computes the centre and radius of the circle of 
    which it is a part of its circumference.
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
    Only supports SQL Server Spatial 2012 onwards as 2008 does not support CURVEPOLYGONs
</pre>
<p class="item_name">INPUTS</p>
<pre>    dCentreX   (float) : X Ordinate of centre of Circle
    @dCentreY  (float) : Y Ordinate of centre of Circle
    @dRadius   (float) : Radius of Circle
    @dSrid       (int) : Spatial Reference Id of geometry
    @iRound      (int) : Float of decimal digits for ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    polygon (geometry) : Circle as CURVEPOLYGON object
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>   Simon Greener - Oct 2015 - Original coding for TSQL.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo18"></a>
<a name="COGO2fSTCrossProductLength2028200829"></a>
<h1>19.  COGO/STCrossProductLength (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STCrossProductLength -- Computes cross product between two vectors subtended at centre.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STCrossProductLength ( 
               @dStartX  float,
               @dStartY  float,
               @dCentreX float,
               @dCentreY float,
               @dEndX    float,
               @dEndY    float
             )
     Returns float
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Computes cross product between vector Centre/Start and Centre/ENd
</pre>
<p class="item_name">INPUTS</p>
<pre>    @dStartX      (float) - X Ordinate of end of first vector
    @dStartY      (float) - Y Ordinate of end of first vector
    @dCentreX     (float) - X Ordinate of common end point of vectors
    @dCentreY     (float) - Y Ordinate of common end point of vectors
    @dEndX        (float) - X Ordinate of end of second vector
    @dEndY        (float) - Y Ordinate of end of second vector
</pre>
<p class="item_name">RESULT</p>
<pre>    cross product (float) - FLoating point cross product value
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>   Simon Greener - Feb 2011 - Converted to TSQL for SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo19"></a>
<a name="COGO2fSTDotProduct2028200829"></a>
<h1>20.  COGO/STDotProduct (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STDotProduct -- Computes Dot product between two vectors subtended at centre.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STDotProduct ( 
               @dStartX  float,
               @dStartY  float,
               @dCentreX float,
               @dCentreY float,
               @dEndX    float,
               @dEndY    float
             )
     Returns float
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Computes Dot product between vector Centre/Start and Centre/ENd
</pre>
<p class="item_name">INPUTS</p>
<pre>    @dStartX    (float) - X Ordinate of end of first vector
    @dStartY    (float) - Y Ordinate of end of first vector
    @dCentreX   (float) - X Ordinate of common end point of vectors
    @dCentreY   (float) - Y Ordinate of common end point of vectors
    @dEndX      (float) - X Ordinate of end of second vector
    @dEndY      (float) - Y Ordinate of end of second vector
</pre>
<p class="item_name">RESULT</p>
<pre>    Dot product (float) - FLoating point Dot product value
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>   Simon Greener - Feb 2011 - Converted to TSQL for SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo20"></a>
<a name="COGO2fSTFindAngleBetween2028201229"></a>
<h1>21.  COGO/STFindAngleBetween (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STFindAngleBetween - Computes left or right angle between first and second linestrings in the direction from @p_line to @p_next_line
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STFindAngleBetween
               @p_line      geometry 
               @p_next_line geometry,
               @p_side      int = -1 /* Left -1; Right +1 */
             )
      Return Float
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with a second linestring (@p_next_line) whose first point is the same as 
    the last point of @p_line, this function computes the angle between the two linestrings 
    on either the left (-1) or right (+1) side in the direction of the two segments.
</pre>
<p class="item_name">NOTES</p>
<pre>    Only supports CircularStrings from SQL Server Spatial 2012 onwards, otherwise supports LineStrings from 2008 onwards.
    @p_line must be first segment whose STEndPoint() is the same as @p_next_line STStartPoint(). No other combinations are supported.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_line      (geometry) - A vector that touches the next vector at one end point.
    @p_next_line (geometry) - A vector that touches the previous vector at one end point.
    @p_side           (int) - The side whose angle is required; 
                              A negative value instructs the function to compute the left angle; 
                              and a positive value the right angle.
</pre>
<p class="item_name">RESULT</p>
<pre>    angle           (float) - Left or right side angle
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - April 2018 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo21"></a>
<a name="COGO2fSTFindCircle2028200829"></a>
<h1>22.  COGO/STFindCircle (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STFindCircle -- Finds a circle's centre X and Y and Radius from three points.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>     Function STFindCircle ( 
                @p_X1 float, @p_Y1 float,
                @p_X2 float, @p_Y2 float,
                @p_X3 float, @p_Y3 float,
                @p_SRID int)
       Returns Geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Given a 3 points defining a circular arc this function computes the centre and radius of the circle of 
    which it is a part of its circumference.
</pre>
<p class="item_name">NOTES</p>
<pre>    Returns geometry POINT with X = CX, Y = CY, Z = Radius.
    Returns -1 as value of all parameters if three points do not define a circle.
    Assumes planar projection eg UTM.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_X1    (Float) : X ordinate of first point on circle
    @p_Y1    (Float) : Y ordinate of first point on circle
    @p_X2    (Float) : X ordinate of second point on circle
    @p_Y2    (Float) : Y ordinate of second point on circle
    @p_X3    (Float) : X ordinate of third point on circle
    @p_Y3    (Float) : Y ordinate of third point on circle
    @p_srid    (int) : Planar SRID value.
</pre>
<p class="item_name">RESULT</p>
<pre>    Point (geometry) : X ordinate of centre of circle.
                       Y ordinate of centre of circle.
                       Z radius of circle.
                       SRID as supplied.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo22"></a>
<a name="COGO2fSTFindCircleByPoint2028201229"></a>
<h1>23.  COGO/STFindCircleByPoint (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STFindCircleByPoint -- Finds the circle centre X and Y and Radius for supplied three points.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>     Function STFindCircleByPoint ( 
                 @p_point_1 geometry,
                 @p_point_2 geometry,
                 @p_point_3 geometry
              )
      Returns Geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Given 3 points on circumference of a circle this function computes the centre and radius of the circle that defines it.
</pre>
<p class="item_name">NOTES</p>
<pre>    Returns geometry POINT with X = CX, Y = CY, Z = Radius.
    Returns -1 as value of all parameters if three points do not define a circle.
    Assumes planar projection eg UTM.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_point_1 (geometry) - First point on circumference of circle
    @p_point_2 (geometry) - Second point on circumference of circle
    @p_point_3 (geometry) - Third point on circumference of circle
</pre>
<p class="item_name">RESULT</p>
<pre>    Point           (geometry) : With STX = CX, STY = CY, Z = Radius, STSrid = @p_circular_arc.STSrid
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - June 2018 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo23"></a>
<a name="COGO2fSTFindCircleFromArc2028201229"></a>
<h1>24.  COGO/STFindCircleFromArc (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STFindCircleFromArc -- Finds the circle centre X and Y and Radius for supplied CircularString
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>     Function STFindCircleFromArc ( 
                @p_circular_arc geometry 
              )
      Returns Geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Given a 3 point circular arc this function computes the centre and radius of the circle that defines it.
</pre>
<p class="item_name">NOTES</p>
<pre>    Returns geometry POINT with X = CX, Y = CY, Z = Radius.
    Returns -1 as value of all parameters if three points do not define a circle.
    Assumes planar projection eg UTM.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_circular_arc (geometry) : 3 Point Circular Arc geometry
</pre>
<p class="item_name">RESULT</p>
<pre>    Point           (geometry) : With STX = CX, STY = CY, Z = Radius, STSrid = @p_circular_arc.STSrid
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo24"></a>
<a name="COGO2fSTFindDeflectionAngle2028201229"></a>
<h1>25.  COGO/STFindDeflectionAngle (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STFindDeflectionAngle - Computes deflection angle between from line and to line.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STFindDeflectionAngle
               @p_from_line geometry 
               @p_to_line   geometry
             )
      Return Float
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with a second linestring (@p_next_line) whose first point is the same as 
    the last point of @p_line, this function computes the deflection angle from the first line to the second
    in the direction of the first line.
</pre>
<p class="item_name">NOTES</p>
<pre>    Only supports CircularStrings from SQL Server Spatial 2012 onwards, otherwise supports LineStrings from 2008 onwards.
    @p_line must be first segment whose STEndPoint() is the same as @p_next_line STStartPoint(). No other combinations are supported.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_from_line (geometry) - A linestring segment
    @p_to_line   (geometry) - A second linestring segment whose direction is computed from the start linestring direction + deflection angle.
</pre>
<p class="item_name">RESULT</p>
<pre>    angle           (float) - Deflection angle in degrees.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - April 2018 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo25"></a>
<a name="COGO2fSTFindLineIntersection2028200829"></a>
<h1>26.  COGO/STFindLineIntersection (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STFindLineIntersection -- Finds intersection point between two simple, two ordinate, line segments. 
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STFindLineIntersection (
               @x11     float, @y11     float,
               @x12     float, @y12     float,
               @x21     float, @y21     float,
               @x22     float, @y22     float 
             )
     Returns geometry
</pre>
<p class="item_name">USAGE</p>
<pre>    Print 'Crossed Lines ...';
    GO
    SELECT f.intersections.AsTextZM() as intersection,
           f.intersections.STGeometryN(1).AsTextZM() as iPoint,
           f.intersections.STGeometryN(2).AsTextZM() as iPointOnSegment1,
           f.intersections.STGeometryN(3).AsTextZM() as iPointOnSegment1
      FROM (SELECT [cogo].[STFindLineIntersection](0,0,10,10,0,10,10,0) as intersections ) as f;
     GO
     intersection                     iPoint      iPointOnSegment1 iPointOnSegment1
     -------------------------------- ----------- ---------------- ----------------
     MULTIPOINT ((5 5), (5 5), (5 5)) POINT (5 5) POINT (5 5)      POINT (5 5)

     Print 'Extended Intersection ...';
     GO
    SELECT f.intersections.AsTextZM() as intersection,
           f.intersections.STGeometryN(1).AsTextZM() as iPoint,
           f.intersections.STGeometryN(2).AsTextZM() as iPointOnSegment1,
           f.intersections.STGeometryN(3).AsTextZM() as iPointOnSegment1
      FROM (SELECT [cogo].[STFindLineIntersection](0,0,10,10,0,10,10,0) as intersections ) as f;
     GO
     intersection                     iPoint      iPointOnSegment1 iPointOnSegment1
     -------------------------------- ----------- ---------------- ----------------
     MULTIPOINT ((5 5), (5 5), (4 6)) POINT (5 5) POINT (5 5)      POINT (4 6)

     Print 'Parallel Lines (meet at single point)....';
     GO
     SELECT f.intersections.AsTextZM() as intersection,
            f.intersections.STGeometryN(1).AsTextZM() as iPoint,
            f.intersections.STGeometryN(2).AsTextZM() as iPointOnSegment1,
            f.intersections.STGeometryN(3).AsTextZM() as iPointOnSegment1
       FROM (SELECT [$(cogoowner)].[STFindLineIntersection] (0,0,10,0, 0,20,10,0) as intersections ) as f;
     GO
     intersection                        iPoint       iPointOnSegment1 iPointOnSegment1
     ----------------------------------- ------------ ---------------- ----------------
     MULTIPOINT ((10 0), (10 0), (10 0)) POINT (10 0) POINT (10 0)     POINT (10 0)
 
     Print 'Parallel Lines that do not meet at single point....';
     GO
     SELECT f.intersections.AsTextZM() as intersection,
            f.intersections.STGeometryN(1).AsTextZM() as iPoint,
            f.intersections.STGeometryN(2).AsTextZM() as iPointOnSegment1,
            f.intersections.STGeometryN(3).AsTextZM() as iPointOnSegment1
       FROM (SELECT [$(cogoowner)].[STFindLineIntersection] (0,0,10,0, 0,1,10,1) as intersections ) as f;
     GO
     intersection                        iPoint       iPointOnSegment1 iPointOnSegment1
     ----------------------------------- ------------ ---------------- ----------------
     MULTIPOINT ((10 0), (10 0), (10 0)) POINT (10 0) POINT (10 0)     POINT (10 0)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Finds intersection point between two lines: 
      1. If first and second segments have a common point, it is returned for all three points.
      2. Point(1) is the point where the lines defined by the segments intersect.
      3. Point(2) is the point on segment 1 that is closest to segment 2 (can be Point(1) or Start/End point )
      4. Point(3) is the point on segment 2 that is closest to segment 1 (can be Point(1) or Start/End point )
      5. If the lines are parallel, all returned ordinates are set to @c_MaxFloat of -1.79E+308 
      6. If the point of intersection is not on both segments, then this is almost certainly not the
         point where the two segments are closest.

     If the lines are parallel, all returned 
     -------
     Method:
     Treat the lines as parametric where line 1 is:
       X = x11 + dx1 * t1
       Y = y11 + dy1 * t1
     and line 2 is:
       X = x21 + dx2 * t2
       Y = y21 + dy2 * t2
     Setting these equal gives:
       x11 + dx1 * t1 = x21 + dx2 * t2
       y11 + dy1 * t1 = y21 + dy2 * t2
     Rearranging:
       x11 - x21 + dx1 * t1 = dx2 * t2
       y11 - y21 + dy1 * t1 = dy2 * t2
       (x11 - x21 + dx1 * t1) *   dy2  = dx2 * t2 *   dy2
       (y11 - y21 + dy1 * t1) * (-dx2) = dy2 * t2 * (-dx2)
     Adding the equations gives:
       (x11 - x21) * dy2 + ( dx1 * dy2) * t1 +
       (y21 - y11) * dx2 + (-dy1 * dx2) * t1 = 0
     Solving for t1 gives:
       t1 * (dy1 * dx2 - dx1 * dy2) =
       (x11 - x21) * dy2 + (y21 - y11) * dx2
       t1 = ((x11 - x21) * dy2 + (y21 - y11) * dx2) /
            (dy1 * dx2 - dx1 * dy2)
     Now solve for t2.
     ----------
     @Note       : If 0 &lt;= t1 &lt;= 1, then the point lies on segment 1.
                 : If 0 &lt;= t2 &lt;= 1, then the point lies on segment 1.
                 : If dy1 * dx2 - dx1 * dy2 = 0 then the lines are parallel.
                 : If the point of intersection is not on both
                 : segments, then this is almost certainly not the
                 : point where the two segments are closest.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @x11 (float) - X Ordinate of the start point for the first vector
    @y11 (float) - Y Ordinate of the start point for the first vector
    @x12 (float) - X Ordinate of the end point for the first vector
    @y12 (float) - Y Ordinate of the end point for the first vector
    @x21 (float) - X Ordinate of the start point for the second vector
    @y21 (float) - Y Ordinate of the start point for the second vector
    @x22 (float) - X Ordinate of the end point for the second vector
    @y22 (float) - Y Ordinate of the end point for the second vector
</pre>
<p class="item_name">RESULT</p>
<pre>    MultiPoint (geometry) - (iPoint)  Intersection point, 
                            (iPoint1) Intersection point on linestring 1.
                            (iPoint2) Intersection point on linestring 2.
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - May 2008 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo26"></a>
<a name="COGO2fSTFindLineIntersectionBySegment2028200829"></a>
<h1>27.  COGO/STFindLineIntersectionBySegment (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STFindLineIntersectionBySegment -- Finds intersection point between two simple, two ordinate, line segments. 
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STFindLineIntersectionBySegment (
       @p_line_segment_1 geometry,
       @p_line_segment_2 geometry
    )
     Returns geometry;
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(cogoowner)].[STFindLineIntersectionBySegment] (
                geometry::STLineFromText('LINESTRING(0 0,10 10)',0),
                geometry::STLineFromText('LINESTRING(0 10,10 0)',0)
           ).AsTextZM() as Intersection
    GO
    Intersection
    MULTIPOINT ((5 5), (5 5), (5 5))
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Finds intersection point between two lines: 
    Calls STFindLineIntersection so see its documentation.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_line_segment_1 (geometry) - 2 Point LineString.
    @p_line_segment_2 (geometry) - 2 Point LineString.
</pre>
<p class="item_name">RESULT</p>
<pre>    MultiPoint (geometry) - (iPoint)  Intersection point, 
                            (iPoint1) Intersection point on linestring 1.
                            (iPoint2) Intersection point on linestring 2.
</pre>
<p class="item_name">NOTES</p>
<pre>    Only Supports 2 Point LineStrings.
    Assumes planar projection eg UTM.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - May 2008 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo27"></a>
<a name="COGO2fSTFindLineIntersectionDetails2028200829"></a>
<h1>28.  COGO/STFindLineIntersectionDetails (2008) [ Methods ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Methods ]</p>
<p class="item_name">NAME</p>
<pre>    STFindLineIntersectionDetails -- Interprets intersection that results from a call to STFindLineIntersectionBySegment with same parameter values.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Create Function STFindLineIntersectionDetails 
       @p_line_segment_1 geometry,
       @p_line_segment_2 geometry
    )
     Returns varchar(max);
</pre>
<p class="item_name">USAGE</p>
<pre>    with data as (
    select c.IntValue as offset, 
           geometry::STGeomFromText('LINESTRING (0.0 0.0, 20.0 0.0, 20.0 10.0)',0) as line
      from [$(owner)].[Generate_Series] (0,-25,-5) as c
    )
    select f.offset,
           [$(owner)].[STRound]([$(cogoowner)].[STFindLineIntersectionBySegment] (first_segment,second_segment),3,1).STAsText() as geom,
           [$(cogoowner)].[STFindLineIntersectionDetails](first_segment,second_segment) as reason
      from (select b.offset,
                   [$(owner)].[STParallelSegment](                                                   a.geom,b.offset,8,8) as first_segment,
                   [$(owner)].[STParallelSegment](lead(a.geom,1) over (partition by b.offset order by a.id),b.offset,8,8) as second_segment 
              from data as b
                   cross apply 
                   [$(owner)].[STSegmentLine] (b.line) as a
           ) as f
     where second_segment is not null
    order by offset;
    GO
    offset geom                                   reason
    -25    MULTIPOINT ((-5 25), (0 25), (-5 10))  Virtual Intersection Near Start 1 and End 2
    -20    MULTIPOINT ((0 20), (0 20), (0 10))    Virtual Intersection Within 1 and Near End 2
    -15    MULTIPOINT ((5 15), (5 15), (5 10))    Virtual Intersection Within 1 and Near End 2
    -10    MULTIPOINT ((10 10), (10 10), (10 10)) Intersection within both segments
     -5    MULTIPOINT ((15 5), (15 5), (15 5))    Intersection within both segments
      0    MULTIPOINT ((20 0), (20 0), (20 0))    Intersection at End 1 Start 2 
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Describes intersection point between two lines: 
    Internal code is same as STFindLineIntersection with parameters from STFindLineIntersectionBySegment so see their documentation.
    Processes code that determines intersections as per STFindLineIntersection but determines nature of intersection ie whether physical, virtual, nearest point on segment etc.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_line_segment_1 (geometry) - 2 Point LineString.
    @p_line_segment_2 (geometry) - 2 Point LineString.
</pre>
<p class="item_name">RESULT</p>
<pre>    Interpretation (varchar) - One of:
      Intersection at End 1 End 2
      Intersection at End 1 Start 2
      Intersection at Start 1 End 2
      Intersection at Start 1 Start 2
      Intersection within both segments
      Parallel
      Unknown
      Virtual Intersection Near End 1 and End 2
      Virtual Intersection Near End 1 and Start 2
      Virtual Intersection Near Start 1 and End 2
      Virtual Intersection Near Start 1 and Start 2
      Virtual Intersection Within 1 and Near End 2
      Virtual Intersection Within 1 and Near Start 2
      Virtual Intersection Within 2 and Near End 1
      Virtual Intersection Within 2 and Near Start 1
</pre>
<p class="item_name">NOTES</p>
<pre>    Only Supports 2 Point LineStrings.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - March 2018 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo28"></a>
<a name="COGO2fSTFindPointBisector2028201229"></a>
<h1>29.  COGO/STFindPointBisector (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   FindPointBisector - Computes offset point on the bisector between two linestrings.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STFindPointBisector
               @p_line      geometry 
               @p_next_line geometry,
               @p_offset    Float = 0.0,
               @p_round_xy  int   = 3,
               @p_round_z   int   = 2,
               @p_round_m   int   = 1
             )
      Return Geometry (Point)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with a second linestring (@p_next_line) whose first point is the same as 
    the last point of @p_line, this function computes the bisector between the two linestrings 
    and then creates a new vertex at a distance of @p_offset from the shared intersection point. 
    If an @p_offset value of 0.0 is supplied, the intersection point is returned. 
    If the @p_offset value is &lt;&gt; 0, the function computes a new position for the point at a 
    distance of @p_offset on the left (-ve) or right (+ve) side of the linestrings.
    The returned vertex has its ordinate values rounded using the relevant decimal place values.
</pre>
<p class="item_name">NOTES</p>
<pre>    Only supports CircularStrings from SQL Server Spatial 2012 onwards, otherwise supports LineStrings from 2008 onwards.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_line      (geometry) - A vector that touches the next vector at one end point.
    @p_next_line (geometry) - A vector that touches the previous vector at one end point.
    @p_offset       (float) - The perpendicular distance to offset the point generated using p_ratio.
                              A negative value instructs the function to offet the point to the left (start-end),
                              and a positive value to the right. 
    @p_round_xy       (int) - Number of decimal digits of precision for an X or Y ordinate.
    @p_round_z        (int) - Number of decimal digits of precision for an Z ordinate.
    @p_round_m        (int) - Number of decimal digits of precision for an M ordinate.
</pre>
<p class="item_name">RESULT</p>
<pre>    point        (geometry) - New point on bisection point or along bisector line with optional perpendicular offset.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2013 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo29"></a>
<a name="COGO2fSTGreatCircleBearing2028200829"></a>
<h1>30.  COGO/STGreatCircleBearing (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STGreatCircleBearing -- Returns a (Normalized) bearing in Degrees between two lat/long coordinates
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STGreatCircleBearing (
               @p_dLon1 float,
               @p_dLat2 float,
               @p_dLon1 float,
               @p_dLat2 float
             )
     Returns float 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [GISDB].[$(owner)].[STGreatCircleBearing](0,0,45,45) as Great_Circle_Bearing;
    Great_Circle_Bearing
    35.2643896827547
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that computes the bearing from the supplied start point (@p_dx1) to the supplied end point (@p_dx2).
    The result is expressed as a whole circle bearing in decimal degrees.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dLon1 (float) - Longitude of starting point.
    @p_dLat1 (float) - Latitude of starting point.
    @p_dLon2 (float) - Longitude of finish point.
    @p_dLat2 (float) - Latitude of finish point.
</pre>
<p class="item_name">RESULT</p>
<pre>    decimal degrees -- Bearing from point 1 to 2 in range 0-360.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo30"></a>
<a name="COGO2fSTGreatCircleDistance2028200829"></a>
<h1>31.  COGO/STGreatCircleDistance (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STGreatCircleDistance -- Computes great circle distance between two lat/long coordinates
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STGreatCircleDistance (
               @p_dLon1             float,
               @p_dLat2             float,
               @p_dLon1             float,
               @p_dLat2             float,
               @p_equatorial_radius Float = 6378137,      -- Default is WGS-84 in meters
               @p_flattening        Float = 298.257223563 -- Default is WGS-84 ellipsoid flattening factor 
             )
     Returns float 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT well_known_text FROM sys.spatial_reference_systems where spatial_reference_id = 4326;
    well_known_text
    GEOGCS["WGS 84", DATUM["World Geodetic System 1984", ELLIPSOID["WGS 84", 6378137, 298.257223563]], PRIMEM["Greenwich", 0], UNIT["Degree", 0.0174532925199433]]

    select [GISDB].[$(owner)].[STGreatCircleDistance](0,0,45,45,6378137,298.257223563) as Great_Circle_Distance
    union all
    select [GISDB].[$(owner)].[STGreatCircleDistance](0,0,45,45,default,default)       as Great_Circle_Distance
    union all
    select geography::Point(0,0,4326).STDistance(geography::Point(45,45,4326))    as Great_Circle_Distance;

    Great_Circle_Distance
    6662444.94352008
    6662444.94352008
    6662473.57317356
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that computes a great circle distance between the supplied start (@p_dx1) and end points (@p_dx2).
    The result is expressed in meters. 
</pre>
<p class="item_name">NOTES</p>
<pre>    Should be same as geographic::STPointFromText(
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dLon1             (float) - Longitude of starting point.
    @p_dLat1             (float) - Latitude of starting point.
    @p_dLon2             (float) - Longitude of finish point.
    @p_dLat2             (float) - Latitude of finish point.
    @p_equatorial_radius (float) - Radius at equator: default is WGS-84 of 6378.137.
    @p_flattening        (float) - Ellipsoid flattening factor: Default is WGS-84 
</pre>
<p class="item_name">RESULT</p>
<pre>    distance -- Distance from point 1 to 2 in meters.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo31"></a>
<a name="COGO2fSTisClockwiseAngle2028200829"></a>
<h1>32.  COGO/STisClockwiseAngle (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STisClockwiseAngle - Supplied with a positive or negative angle this function returns 1 or 0 to indicate if Clockwise (+) or AntiClockwise (-)
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STisClockwiseAngle (
               @p_angle float 
             )
     Returns bit 
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with an angle this function returns 1 if clockwise and 0 is anticlockwise.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_angle (float) - Angle in radians
</pre>
<p class="item_name">RESULT</p>
<pre>    TrueFalse  (bit) - 1 if clockwise and 0 is anticlockwise.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo32"></a>
<a name="COGO2fSTisClockwiseArc2028200829"></a>
<h1>33.  COGO/STisClockwiseArc (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STisClockwiseArc - Supplied with a positive or negative angle this function returns 1 or 0 to indicate if Clockwise (+) or AntiClockwise (-)
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STisClockwiseArc (
               @p_circular_arc geometry 
             )
     Returns Int 
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with a single CircularString this function returns 1 if CircularString is defecting to the right (clockwise) or -1 to the left (anticlockwise).
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_CircularArc (geometry) - Single CircularString geometry (3 points)
</pre>
<p class="item_name">RESULT</p>
<pre>    TrueFalse  (bit) - 1 if clockwise and -1 is anticlockwise.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2018 - Original TSQL coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo33"></a>
<a name="COGO2fSTLine2Cogo2028200829"></a>
<h1>34.  COGO/STLine2Cogo (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STLine2Cogo - Converts LineString into COGO XML structure for use in STCogo2Line.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>   Function STLine2Cogo (
       @p_linestring  geometry,
       @pDegreeSymbol NVarChar(1),
       @pMinuteSymbol NVarChar(1),
       @pSecondSymbol NVarChar(1) 
    )
    Returns XML
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    -- Write 2D with DMS string bearings
    SELECT [$(cogoowner)].[STLine2Cogo] (
              geometry::STGeomFromText('LINESTRING (10 10, 8.163 17.034, 158.755 35.432, 157.565 25.108)',0),
              CHAR(176),CHAR(39),'"')
    GO
    &lt;Cogo srid="0"&gt;
      &lt;Segments&gt;
        &lt;Segment&gt;
          &lt;MoveTo&gt;POINT (10 10)&lt;/MoveTo&gt;
          &lt;DegMinSec&gt; 345°21'48.75"&lt;/DegMinSec&gt;
          &lt;Distance&gt;345.364&lt;/Distance&gt;
        &lt;/Segment&gt;
        &lt;Segment&gt;
          &lt;DegMinSec&gt;  83° 2'4.652"&lt;/DegMinSec&gt;
          &lt;Distance&gt;83.0346&lt;/Distance&gt;
        &lt;/Segment&gt;
        &lt;Segment&gt;
          &lt;DegMinSec&gt; 186°34'30.73"&lt;/DegMinSec&gt;
          &lt;Distance&gt;186.575&lt;/Distance&gt;
        &lt;/Segment&gt;
      &lt;/Segments&gt;
    &lt;/Cogo&gt;
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function converts each segment of a (multi)linestring into a COGO bearing and distance XML Segment.
    The COGO references are returning in the order they appear in the geometry object.
    The first point of the start of a LineString element is returned as a &lt;MoveTo&gt; element.
    If all three symbol parameters are NULL, &lt;Bearing&gt; elements are created holding decimal degrees, else &lt;DegMinSec&gt; elements are written.
  NOTE
    Measured lines are unsupported.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring  (geometry)    - A LINESTRING or MULTILINESTRING object.
    @pDegreeSymbol (NVarChar(1)) - Degrees symbol eg ^
    @pMinuteSymbol (NVarChar(1)) - Seconds symbol eg '
    @pSecondSymbol (NVarChar(1)) - Seconds symbol eg "
</pre>
<p class="item_name">RESULT</p>
<pre>    COGO Object    (XML);
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - June 2018 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2017 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo34"></a>
<a name="COGO2fSTLine2CogoAsTable2028200829"></a>
<h1>35.  COGO/STLine2CogoAsTable (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STLine2CogoAsTable - Dumps all segment of supplied linestring geometry object to bearing and distance tuples.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>   Function STLine2CogoAsTable (
       @p_linestring  geometry,
       @pDegreeSymbol NVarChar(1),
       @pMinuteSymbol NVarChar(1),
       @pSecondSymbol NVarChar(1) 
    )
    Returns @segments Table (
        segment_id int,          -- Unique integer 
        element_id int,          -- If Linestring, 1, else part of MULTILINESTRING 
        dms        varchar(100), -- Bearing expressed as DMS string
        bearing    float,        -- Bearing expressed as DD
        distance   float,        -- Length of segment
        deltaZ     float         -- delta Z along segment
    )  
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT t.*
      FROM [$(cogoowner)].[STLine2CogoAsTable](geometry::STGeomFromText('MULTILINESTRING((0 0,1 1,2 2),(100 100,110 110,130 130))',0),
                                               NULL,NULL,NULL) as t
     ORDER BY t.segment_id;
    GO
    segment_id element_id    dms          bearing distance         deltaZ
    1          1          45° 0'0.000" 45      1.4142135623731  NULL
    2          1          45° 0'0.000" 45      1.4142135623731  NULL
    3          2          45° 0'0.000" 45      14.142135623731  NULL
    4          2          45° 0'0.000" 45      28.2842712474619 NULL
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function converts each segment of a (multi)linestring into a COGO bearing and distance.
    The COGO references are returning in the order they appear in the geometry object.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring  (geometry)    - A LINESTRING or MULTILINESTRING object.
    @pDegreeSymbol (NVarChar(1)) - Degrees symbol eg ^
    @pMinuteSymbol (NVarChar(1)) - Seconds symbol eg '
    @pSecondSymbol (NVarChar(1)) - Seconds symbol eg "
</pre>
<p class="item_name">RESULT</p>
<pre>    Table (Array) of Points :
     segment_id  (int) - Unique segment id starting at first and ending at last regardless as to whether multilinestring.
     element_id  (int) - Identifier unique to each element eg MultiLineString first LINESTRING is 1, second is 2 etc.
     dms     (varchar) - DMS eg 149^10'11.1" 
     bearing   (float) - DD eg 149.1334343
     distance  (float) - length of segment (if geodetic SRID will be in meters).
     deltaZ    (float) - end z ordinate minus start z ordinate for each segment.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - June 2018 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2017 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo35"></a>
<a name="COGO2fSTNormalizeBearing2028200829"></a>
<h1>36.  COGO/STNormalizeBearing (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STNormalizeBearing -- Function ensures supplied bearing is between 0 and 360. 
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STNormalizeBearing(@p_bearing float)
     Returns Float
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(cogoowner)].[STNormalizeBearing](450.39494) as bearing;
    bearing
    90.39494
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that ensures supplied bearing is between 0 and 360 degrees (360 = 0).
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_bearing (float) : Non-NULL decimal bearing.
</pre>
<p class="item_name">RESULT</p>
<pre>    bearing (float) : Bearing between 0 and 360 degrees.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo36"></a>
<a name="COGO2fSTOptimalCircleSegments2028200829"></a>
<h1>37.  COGO/STOptimalCircleSegments (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STOptimalCircleSegments -- Computes optimal number of chord segments to stroke circle as vertex-connected polygon.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STOptimalCircleSegments ( 
                @p_dRadius               Float,
                @p_dArcToChordSeparation Float
             )
     Returns int
    SELECT [$(cogoowner)].[STOptimalCircleSegments](100, 0.003);
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns the optimal integer number of circle segments for an arc-to-chord separation given the radius
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dRadius               (float) : Radius of Circle
    @p_dArcToChordSeparation (float) : Distance between the midpoint of the Arc and the Chord in metres
</pre>
<p class="item_name">RESULT</p>
<pre>    number of segments         (int) : The optimal number of segments at the given arc2chord separation
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>   Simon Greener - May 2011 - Converted to TSQL for SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo37"></a>
<a name="COGO2fSTPointFromBearingAndDistance2028200829"></a>
<h1>38.  COGO/STPointFromBearingAndDistance (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STPointFromBearingAndDistance -- Returns a projected point given starting point, a bearing in Degrees, and a distance (geometry SRID units).
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STPointFromBearingAndDistance (
               @p_dStartE   float,
               @p_dStartN   float,
               @p_dBearing  float,
               @p_dDistance float
               @p_round_xy  int = 3,
               @p_srid      int = 0 
             )
     Returns float 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(cogoowner)].[STPointFromBearingAndDistance] (0,0,45,100,3,0).STAsText() as endPoint;
    endPoint
    POINT (70.711 70.711)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that computes a new point given a starting coordinate, a whole circle bearing and a distance (SRID Units).
    Returned point's XY ordinates are rounded to @p_round_xy decimal digits of precision.
    @p_SRID is the SRID of the supplied start point.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dStartE   (float) - Easting of starting point.
    @p_dStartN   (float) - Northing of starting point.
    @p_dBearing  (float) - Whole circle bearing between 0 and 360 degrees.
    @p_dDistance (float) - Distance in SRID units from starting point to required point.
    @p_round_xy    (int) - XY ordinates decimal digitis of precision.
    @p_srid        (int) - SRID associated with @p_dStartE/p_dStartN.
</pre>
<p class="item_name">RESULT</p>
<pre>    point    (geometry) - Point
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo38"></a>
<a name="COGO2fSTPointFromCOGO2028200829"></a>
<h1>39.  COGO/STPointFromCOGO (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STPointFromCOGO -- Returns a projected point given starting point, a bearing in Degrees, and a distance (geometry SRID units).
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STPointFromCOGO (
               @p_Start_Point geometry,
               @p_dBearing    float,
               @p_dDistance   float
               @p_round_xy    int = 3
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(cogoowner)].[STPointFromCOGO] (geometry::Point(0,0,0),45,100,3).STAsText() as endPoint;
    endPoint
    POINT (70.711 70.711)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Is a wrapper function over STPointFromBearingAndDistance.
    Function that computes a new point given a starting coordinate, a whole circle bearing and a distance (SRID Units).
    Returned point's XY ordinates are rounded to @p_round_xy  decimal digits of precision.
    SRID of the returned geometry is the SRID supplied start point.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_Start_Point (geometry) - Starting point.
    @p_dBearing       (float) - Whole circle bearing between 0 and 360 degrees.
    @p_dDistance      (float) - Distance in SRID units from starting point to required point.
    @p_round_xy         (int) -    XY ordinates decimal digitis of precision.
</pre>
<p class="item_name">RESULT</p>
<pre>    point          (geometry) - Point
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo39"></a>
<a name="COGO2fSTResection202d20Computes20resection20point20using20Tienstra27s20Method20from20supplied20parameters2e"></a>
<h1>40.  COGO/STResection - Computes resection point using Tienstra's Method from supplied parameters. [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">TODO</p>
<pre>   Still under development.
</pre>
<a name="robo40"></a>
<a name="COGO2fSTSubtendedAngle2028200829"></a>
<h1>41.  COGO/STSubtendedAngle (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STSubtendedAngle - Returns the angle (radians) between three points.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STSubtendedAngle (
               @p_startX  float,
               @p_startY  float,
               @p_centreX float,
               @p_centreY float,
               @p_endX    float,
               @p_endY    float
             )
     Returns float (angle in radians)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with three points, this function computes the angle from the first to the third subtended by the seconds.
    Angle could be positive or negative.
    Result is radians.
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
    Always choses smallest angle ie 90 not 270
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_startX  (float) - X ordinate of first point
    @p_startY  (float) - Y ordinate of first point
    @p_centreX (float) - X ordinate of first point
    @p_centreY (float) - Y ordinate of first point
    @p_endX    (float) - X ordinate of first point
    @p_endY    (float) - Y ordinate of first point
</pre>
<p class="item_name">RESULT</p>
<pre>    angle      (float) - Subtended angle in radians.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo41"></a>
<a name="COGO2fSTSubtendedAngleByPoint2028200829"></a>
<h1>42.  COGO/STSubtendedAngleByPoint (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STSubtendedAngleByPoint - Returns the angle (radians) between three points.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STSubtendedAngle (
               @p_start  geometry,
               @p_centre geometry,
               @p_end    geometry
             )
     Returns float (angle in radians)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with three points, this function computes the angle from the first to the third subtended by the seconds.
    Angle could be positive or negative.
    Result is radians.
</pre>
<p class="item_name">NOTES</p>
<pre>    Assumes planar projection eg UTM.
    Always choses smallest angle ie 90 not 270
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_start  (geometry) - First point
    @p_centre (geometry) - Second point
    @p_end    (geometry) - Third point
</pre>
<p class="item_name">RESULT</p>
<pre>    angle      (float) - Subtended angle in radians.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo42"></a>
<a name="COGO2fSTTileGeom2028200829"></a>
<h1>43.  COGO/STTileGeom (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STTileGeom -- Covers envelope of supplied goemetry with a mesh of tiles of size TileX and TileY.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STTileGeom (
               @p_geometry geometry,
               @p_TileX float,
               @p_TileY float,
             )
     Returns @table table
    (
      col  Int,
      row  Int,
      geom geometry
    )
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT t.col, t.row, t.geom.STAsText() as geom
      FROM [$(owner)].[STTileGeom] (
             geometry::STGeomFromText('POLYGON((100 100, 900 100, 900 900, 100 900, 100 100))',0),
             400,200) as t;
    GO

    col row geom
    --- --- ------------------------------------------------------------
    0   0   POLYGON ((0 0, 400 0, 400 200, 0 200, 0 0))
    0   1   POLYGON ((0 200, 400 200, 400 400, 0 400, 0 200))
    0   2   POLYGON ((0 400, 400 400, 400 600, 0 600, 0 400))
    0   3   POLYGON ((0 600, 400 600, 400 800, 0 800, 0 600))
    0   4   POLYGON ((0 800, 400 800, 400 1000, 0 1000, 0 800))
    1   0   POLYGON ((400 0, 800 0, 800 200, 400 200, 400 0))
    1   1   POLYGON ((400 200, 800 200, 800 400, 400 400, 400 200))
    1   2   POLYGON ((400 400, 800 400, 800 600, 400 600, 400 400))
    1   3   POLYGON ((400 600, 800 600, 800 800, 400 800, 400 600))
    1   4   POLYGON ((400 800, 800 800, 800 1000, 400 1000, 400 800))
    2   0   POLYGON ((800 0, 1200 0, 1200 200, 800 200, 800 0))
    2   1   POLYGON ((800 200, 1200 200, 1200 400, 800 400, 800 200))
    2   2   POLYGON ((800 400, 1200 400, 1200 600, 800 600, 800 400))
    2   3   POLYGON ((800 600, 1200 600, 1200 800, 800 800, 800 600))
    2   4   POLYGON ((800 800, 1200 800, 1200 1000, 800 1000, 800 800))
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that takes a non-point geometry type, determines its spatial extent (LL/UR),
    computes the number of tiles given the tile size @p_TileX/@p_TileY (real world units),
    creates each tile as a polygon, and outputs it in the table array with its col/row reference.
    The lower left and upper right coordinates are calculated as follows:
      LL.X = @p_geometry.STEnvelope().STPointN(1).STX;
      LL.Y = @p_geometry.STEnvelope().STPointN(1).STY;
      UR.X = @p_geometry.STEnvelope().STPointN(3).STX;
      UR.Y = @p_geometry.STEnvelope().STPointN(3).STY;
    The number of columns and rows that cover this area is calculated.
    All rows and columns are visited, with polygons being created that represent each tile.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) -- Column reference 
    @p_TileX       (float) -- Size of a Tile's X dimension in real world units.
    @p_TileY       (float) -- Size of a Tile's Y dimension in real world units.
</pre>
<p class="item_name">RESULT</p>
<pre>    A Table of the following is returned
    (
      col  Int      -- The column reference for a tile
      row  Int      -- The row reference for a tile
      geom geometry -- The polygon geometry covering the area of the Tile.
    )
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo43"></a>
<a name="COGO2fSTTiler2028201229"></a>
<h1>44.  COGO/STTiler (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STTiler -- Covers supplied envelope (LL/UR) with a mesh of tiles of size TileX and TileY,
               and writes them to a new table created with the supplied name.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Procedure STTiler (
               @p_ll_x      float,
               @p_ll_y      float,
               @p_ur_x      float,
               @p_ur_y      float,
               @p_TileX     float,
               @p_TileY     float,
               @p_srid      int,
               @p_out_table nvarchar(128),
               @p_geography Int = 1
             )
</pre>
<p class="item_name">USAGE</p>
<pre>    EXEC [$(owner)].[STTiler] 0, 0, 1000, 1000, 250, 250, 0, '[$(owner)].GridLL', 0;
    GO
    SELECT COUNT(*) as tableCount FROM [$(owner)].[GridLL];
    GO

    tableCount
    ----------
    16
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Procedure that takes a spatial extent (LL/UR), computes the number of tiles that cover it and
    The number of columns and rows that cover this area is calculated using @p_TileX/@p_TileY which
    are in @p_SRID units.
    All rows and columns are visited, with polygons being created that represent each tile.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_ll_x         (float) -- Spatial Extent's lower left X/Longitude ordinate.
    @p_ll_y         (float) -- Spatial Extent's lower left Y/Latitude  ordinate.
    @p_ur_x         (float) -- Spatial Extent's upper right X/Longitude ordinate.
    @p_ur_y         (float) -- Spatial Extent's upper right Y/Latitude  ordinate.
    @p_TileX        (float) -- Size of a Tile's X dimension in decimal degrees.
    @p_TileY        (float) -- Size of a Tile's Y dimension in decimal degrees.
    @p_srid           (int) -- Geographic SRID (default is 4326)
    @p_out_table (nvarchar) -- Name of table to hold tiles. Can be expressed as DB.OWNER.OBJECT.
    @p_geography      (int) -- If 1 (True) column in table will be geography; if 0, geometry.
</pre>
<p class="item_name">RESULT</p>
<pre>    A Table with the name @p_out_table is created with this structure:
    Create Table + @p_out_table + 
    ( 
      gid  Int Identity(1,1) not null, 
      geom geometry   -- If @p_geography = 0
      geog geography  -- If @p_geography = 1
    );
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo44"></a>
<a name="COGO2fSTTileXY2028200829"></a>
<h1>45.  COGO/STTileXY (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STTileXY -- Covers supplied envelope (LL/UR) with a mesh of tiles of size TileX and TileY.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STTileXY (
               @p_ll_x  float,
               @p_ll_y  float,
               @p_ur_x  float,
               @p_ur_y  float,
               @p_TileX float,
               @p_TileY float,
               @p_srid  int = 0
             )
     Returns @table table
    (
      col  Int,
      row  Int,
      geom geometry
    )
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT row_number() over (order by t.col, t.row) as rid, 
           t.col, t.row, t.geom.STAsText() as geom
      FROM [$(owner)].[STTileXY](0,0,1000,1000,250,250,0) as t;
    GO

    rid col row geom
    --- --- --- -----------------------------------------------------------
     1  0   0   POLYGON ((0 0, 250 0, 250 250, 0 250, 0 0))
     2  0   1   POLYGON ((0 250, 250 250, 250 500, 0 500, 0 250))
     3  0   2   POLYGON ((0 500, 250 500, 250 750, 0 750, 0 500))
     4  0   3   POLYGON ((0 750, 250 750, 250 1000, 0 1000, 0 750))
     5  1   0   POLYGON ((250 0, 500 0, 500 250, 250 250, 250 0))
     6  1   1   POLYGON ((250 250, 500 250, 500 500, 250 500, 250 250))
     7  1   2   POLYGON ((250 500, 500 500, 500 750, 250 750, 250 500))
     8  1   3   POLYGON ((250 750, 500 750, 500 1000, 250 1000, 250 750))
     9  2   0   POLYGON ((500 0, 750 0, 750 250, 500 250, 500 0))
    10  2   1   POLYGON ((500 250, 750 250, 750 500, 500 500, 500 250))
    11  2   2   POLYGON ((500 500, 750 500, 750 750, 500 750, 500 500))
    12  2   3   POLYGON ((500 750, 750 750, 750 1000, 500 1000, 500 750))
    13  3   0   POLYGON ((750 0, 1000 0, 1000 250, 750 250, 750 0))
    14  3   1   POLYGON ((750 250, 1000 250, 1000 500, 750 500, 750 250))
    15  3   2   POLYGON ((750 500, 1000 500, 1000 750, 750 750, 750 500))
    16  3   3   POLYGON ((750 750, 1000 750, 1000 1000, 750 1000, 750 750))
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that takes a spatial extent (LL/UR), computes the number of tiles that cover it and
    the table array with its col/row reference.
    The number of columns and rows that cover this area is calculated using @p_TileX/@p_TileY which
    are in @p_SRID units.
    All rows and columns are visited, with polygons being created that represent each tile.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_ll_x  (float) -- Spatial Extent's lower left X ordinate.
    @p_ll_y  (float) -- Spatial Extent's lower left Y ordinate.
    @p_ur_x  (float) -- Spatial Extent's uppre righ X ordinate.
    @p_ur_y  (float) -- Spatial Extent's uppre righ Y ordinate.
    @p_TileX (float) -- Size of a Tile's X dimension in real world units.
    @p_TileY (float) -- Size of a Tile's Y dimension in real world units.
    @p_srid    (int) -- Geometric SRID.
</pre>
<p class="item_name">RESULT</p>
<pre>    A Table of the following is returned
    (
      col  Int      -- The column reference for a tile
      row  Int      -- The row reference for a tile
      geom geometry -- The polygon geometry covering the area of the Tile.
    )
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo45"></a>
<a name="CONVERSION2fSTPointGeomAsText2028200829"></a>
<h1>46.  CONVERSION/STPointGeomAsText (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STPointGeomAsText -- Function that returns a formatted string representation of a point's ordinates rounded to supplied tolerances.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STPointGeomAsText (
        @p_point   geometry,
        @p_round_x    int = 3,
        @p_round_y    int = 3,
        @p_round_z    int = 2,
        @p_round_m    int = 2
     )
     Returns varchar(max)
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STPointGeomAsText] (
             geometry::STPointFromText('POINT (0.1232332 0.21121 0.1213 0.41)',0),
             3, 2, 1
           ) as point;
    GO
    point
    '0.123 0.211 0.12 0.4'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function returns a formatted string representation of a point with up to 4 ordinates.
    The function is suitable for use in WKT text constructors as shown in the USAGE element of this documentation.
    The function correctly rounds each ordinate using the supplied rounding factor.
    This function is different from the standard .AsTextZM() as it also rounds the ordinates and does not return the POINT () elements.
</pre>
<p class="item_name">NOTES</p>
<pre>    Wrapper over STPointAsText
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_point (geometry) - Geometry Point
    @p_round_xy   (int) - XY Ordinates rounding factor.
    @p_round_z    (int) - Z Ordinate rounding factor.
    @p_round_m    (int) - M Ordinate rounding factor.
</pre>
<p class="item_name">RESULT</p>
<pre>    formatted string (varchar max) - Formatted string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2008 - Original Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo46"></a>
<a name="CONVERSION2fSTToGeography2028200829"></a>
<h1>47.  CONVERSION/STToGeography (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STToGeography - Given a geometry object returns a geography object.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STToGeography (
       @p_geom geometry,
       @p_srid Int = NULL
     )
     Returns geography
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT [$(owner)].[STToGeography] (
             geometry::STGeomFromText('LINESTRING(147.234 -43.2345, 148.234 -43.2345)',0),
             4326
           ).STAsText() 
     as geog
    GO
    geog
    LINESTRING(147.234 -43.2345, 148.234 -43.2345)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Given valid geometry object this function converts it to a geography object, assigns @p_srid value and returns. 
    The @p_srid value should be a valid geography SRID.
    Mainly useful for converting 2008 geometry objects with geographic data to 2012+ geography objects.  *  INPUTS
    @p_geom (geometry) - A valid geometry object.
    @p_srid      (int) - Valid geographic SRID. If null, uses SRID associated with supplied geometry.
</pre>
<p class="item_name">RESULT</p>
<pre>    geography (geography) - Geography object.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Aug 20012 - Initial SQL Server 20012 implementation
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo47"></a>
<a name="CONVERSION2fSTToGeometry2028201229"></a>
<h1>48.  CONVERSION/STToGeometry (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STToGeometry - Given a geography object returns a geometry object.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STToGeometry (
       @p_geog geography,
       @p_srid Int = NULL
     )
     Returns geometry
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT [$(owner)].[STToGeometry] (
             geography::STGeomFromText('LINESTRING(147.234 -43.2345, 148.234 -43.2345)',4326),
             NULL
           ).STAsText() as geom;
    GO
    geom
    LINESTRING (147.234 -43.2345, 148.234 -43.2345)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Given valid geography object this function converts it to a geometry object, assigns @p_srid value and returns. 
    The @p_srid value should be a valid projected SRID.
    Mainly useful for converting 2012 geography objects to geometry equalivalent to be able to use functions only available for geometry. 
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geog (geography) - A valid geographic object.
    @p_srid       (int) - Valid projected SRID. If null, uses SRID associated with supplied geography
</pre>
<p class="item_name">RESULT</p>
<pre>    geometry (geometry) - Geometry object.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Aug 20012 - Initial SQL Server 20012 implementation
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo48"></a>
<a name="CREATE2fSTMakeCircularLine2028200829"></a>
<h1>49.  CREATE/STMakeCircularLine (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMakeCircularLine -- Creates a three point Circular linestring.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMakeCircularLine (
               @p_start_point geometry,
               @p_mid_point   geometry,
               @p_end_point   geometry,
               @p_round_xy    int = 8,
               @p_round_z     int = 8,
               @p_round_m     int = 8
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT $(owner).STMakeCircularLine(
              geometry::Point(0,0,28355),
              geometry::Point(5,5,28355),
              geometry::Point(10,10,28355),
              1,1,null
           ) as cline;
    LINE
    45
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function creates a three point Circular linestring from supplied start, mid and end points.
    The output linestring's XY ordinates are rounded to the supplied p_round_xy value.
    The output linestring's Z ordinates are rounded to the supplied p_round_z value.
    The output linestring's M ordinates are rounded to the supplied p_round_m value.
</pre>
<p class="item_name">NOTES</p>
<pre>    If @p_start_point, or @p_mid_point, or @p_end_point are null, a null result is returned.
    If @p_start_point, or @p_mid_point, or @p_end_point have different SRIDS, a null result is returned.
    If points are collinear (XY only), null is returned.
    Z is returned if ALL points have Z ordinates and all values are equal.
    M is returned if ALL points have M ordinates.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_start_point (geometry) - Not null start point.
    @p_mid_point   (geometry) - Not null start point.
    @p_end_point   (geometry) - Not null end point.
    @p_round_xy         (int) - XY ordinate precision.
    @p_round_z          (int) - Z ordinate precision.
    @p_round_m          (int) - M ordinate precision.
</pre>
<p class="item_name">RESULT</p>
<pre>    circular linestring (geometry) - Circular LineString from start point, through mid point, to end point.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - March 2018 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo49"></a>
<a name="CREATE2fSTMakeEnvelope2028200829"></a>
<h1>50.  CREATE/STMakeEnvelope (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMakeEnvelope -- Function that constructs a 5 point polygon from supplied ordinates.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STMakeEnvelope] (
               @p_mbr_coords in varchar,
               @p_srid       in integer default null
             )
     Returns geometry 
</pre>
<p class="item_name">DESCRIPTION</p>
<p class="item_name">NOTES</p>
<pre>    2D only.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_minx   (float) - Lower left x ordinate.
    @p_miny   (float) - Lower left y ordinate.
    @p_maxx   (float) - Upper left x ordinate.
    @p_maxy   (float) - Upper left x ordinate.
    @p_srid (integer) - geometry srid
</pre>
<p class="item_name">RESULT</p>
<pre>    geometry (geometry) - Input coordinates converted to 5 point polygon.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    USE GISDB
    GO
    SELECT [$(owner)].[STMakeEnvelope](0,0,1,1,null) as mbr;
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - August 2019 - Original TSQL Coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2019 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo50"></a>
<a name="CREATE2fSTMakeEnvelopeFromText2028200829"></a>
<h1>51.  CREATE/STMakeEnvelopeFromText (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMakeEnvelopeFromText -- Function that constructs a 5 point polygon from supplied string.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [dbo].[STMakeEnvelopeFromText] (
               @p_mbr_coords varchar,
               @p_delim      varchar(1) = ' ',
               @p_srid       integer    = 0
             )
     Returns geometry 
</pre>
<p class="item_name">DESCRIPTION</p>
<p class="item_name">NOTES</p>
<pre>    2D only.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_mbr_coords (varchar) - 2 coordinates, 4 ordinates
    @p_delim      (varchar) - delimiter separating ordinates
    @p_srid       (integer) - geometry srid
</pre>
<p class="item_name">RESULT</p>
<pre>    geometry     (geometry) - Input coordinates converted to 5 point polygon.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    USE GISDB
    GO
    SELECT [dbo].[STMakeEnvelopeFromText](0,0,1,1,null) as mbr;
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - August 2019 - Original TSQL Coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2019 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo51"></a>
<a name="CREATE2fSTMakeLine2028200829"></a>
<h1>52.  CREATE/STMakeLine (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMakeLine -- Creates a two point linestring.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMakeLine (
               @p_start_point geometry,
               @p_end_point   geometry,
               @p_round_xy    int = 10,
               @p_round_zm    int = 10
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].STMakeLine(geometry::Point(0,0,0),geometry::Point(10,10,28355)) as line;
    LINE
    45
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function creates a two point linestring from supplied start and end points.
    The output linestring's XY ordinates are rounded to the supplied @p_round_xy value.
    The output linestring's ZM ordinates are rounded to the supplied @p_round_zm value.
</pre>
<p class="item_name">NOTES</p>
<pre>    If @p_start_point or @p_end_point are null, a null result is returned.
    If @p_start_point or @p_end_point have different SRIDS, a null result is returned.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_start_point  (geometry) - Not null start point.
    @p_end_point    (geometry) - Not null end point.
    @p_round_xy     (int)      - XY ordinate precision.
    @p_round_zm     (int)      - ZM ordinate precision.
</pre>
<p class="item_name">RESULT</p>
<pre>    linestring      (geometry) - LineString from start point to end point.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo52"></a>
<a name="CREATE2fSTMakeLineFromGeometryCollection2028200829"></a>
<h1>53.  CREATE/STMakeLineFromGeometryCollection (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMakeLineFromGeometryCollection -- Creates a linestring from supplied GeometryCollection geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMakeLineFromGeometryCollection (
               @p_points geometry
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].STMakeLineFromGeometryCollection(geometry::STGeomFromText('GEOMETRYCOLLECTION(POINT(0,0),POINT(10,10))',28355) as line;
    LINE
    LINESTRING(0 0,10 10)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function creates linestring from supplied Points in @p_points (GeometryCollection).
</pre>
<p class="item_name">NOTES</p>
<pre>    Only Point geometries within @p_points supported (LineString etc sub-geometries ignored).
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_points (geometry) - Not null GeometryCollection containing Point geometry types.
</pre>
<p class="item_name">RESULT</p>
<pre>    linestring -- LineString from provided GeometryCollection's Point geometries.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - February 2018 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo53"></a>
<a name="CREATE2fSTMakeLineFromMultiPoint2028200829"></a>
<h1>54.  CREATE/STMakeLineFromMultiPoint (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMakeLineFromMultiPoint -- Creates a linestring from supplied MULTIPOINT geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMakeLineFromMultiPoint (
               @p_points geometry
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].STMakeLineFromMultiPoint(geometry::STGeomFromText('MULTIPOINT(((0,0),(10,10))',28355) as line;
    LINE
    LINESTRING(0 0,10 10)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function creates linestring from supplied points in @p_points (MultiPoint).
</pre>
<p class="item_name">NOTES</p>
<pre>    Only MultiPoint input geometry supported.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_points (geometry) - Not null MultiPoint geometry.
</pre>
<p class="item_name">RESULT</p>
<pre>    linestring -- LineString from provided multipoint geometry.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
  LICENSE
      Creative Commons Attribution-Share Alike 2.5 Australia License.
      <a href="http://creativecommons.org/licenses/by-sa/2.5/au/">http://creativecommons.org/licenses/by-sa/2.5/au/</a>
</pre>
<a name="robo54"></a>
<a name="CREATE2fSTMakeLineWktFromGeographyCollection2028200829"></a>
<h1>55.  CREATE/STMakeLineWktFromGeographyCollection (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMakeLineWktFromGeographyCollection -- Creates a linestring from supplied GeometryCollection geography.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [STMakeLineWktFromGeographyCollection] (
               @p_points geography
             )
     Returns varchar(max) 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STMakeLineWktFromGeographyCollection](geography::STGeomFromText('GEOMETRYCOLLECTION(POINT(0,0),POINT(10,10))',28355) as line;
    LINE
    LINESTRING(0 0,10 10)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function creates linestring from supplied Points in @p_points (GeometryCollection).
</pre>
<p class="item_name">NOTES</p>
<pre>    Only Point geometries within @p_points supported (LineString etc sub-geometries ignored).
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_points (geography) - Not null GeometryCollection containing Point geography types.
</pre>
<p class="item_name">RESULT</p>
<pre>    linestring (varchar) - LineString from provided GeometryCollection's Point geometries.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - February 2018 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo55"></a>
<a name="CREATE2fSTMakeLineWktFromGeometryCollection2028200829"></a>
<h1>56.  CREATE/STMakeLineWktFromGeometryCollection (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMakeLineWktFromGeometryCollection -- Creates a linestring from supplied GeometryCollection geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [STMakeLineWktFromGeometryCollection] (
               @p_points geometry
             )
     Returns varchar(max) 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STMakeLineWktFromGeometryCollection](geometry::STGeomFromText('GEOMETRYCOLLECTION(POINT(0,0),POINT(10,10))',28355) as line;
    LINE
    LINESTRING(0 0,10 10)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function creates linestring from supplied Points in @p_points (GeometryCollection).
</pre>
<p class="item_name">NOTES</p>
<pre>    Only Point geometries within @p_points supported (LineString etc sub-geometries ignored).
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_points (geometry) - Not null GeometryCollection containing Point geometry types.
</pre>
<p class="item_name">RESULT</p>
<pre>    linestring (varchar) - LineString from provided GeometryCollection's Point geometries.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - February 2018 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo56"></a>
<a name="CREATE2fSTMakeLineXY2028200829"></a>
<h1>57.  CREATE/STMakeLineXY (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMakeLineXY -- Creates a two point 2D XY linestring.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMakeLine (
               @p_start_x  float,
               @p_start_y  float,
               @p_end_x    float,
               @p_end_y    float,
               @p_srid     int = 0,
               @p_round_xy int = 10
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].STMakeLineXY(0,0,10,10,28355).STAsText() as line;
    LINE
    LINESTRING (0 0,10 10)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function creates a two point 2D linestring from supplied start and end XY values.
    The output linestring's XY ordinates are rounded to the supplied @p_round_xy value.
</pre>
<p class="item_name">NOTES</p>
<pre>    If any of @p_start_x/y or @p_end_x/y are null, a null result is returned.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_start_x  (float) - Start X ordinate
    @p_start_y  (float) - Start Y ordinate
    @p_end_x    (float) - End X ordinate
    @p_end_y    (float) - End Y ordinate
    @p_srid       (int) - Srid 
    @p_round_xy   (int) - rounding value for ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    linestring (geometry) - LineString from start point to end point.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo57"></a>
<a name="CREATE2fSTMakePoint2028200829"></a>
<h1>58.  CREATE/STMakePoint (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMakePoint -- Creates a point from input ordinates.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMakePoint (
               @p_x    float,
               @p_y    float,
               @p_z    float,
               @p_m    float,
               @p_srid int = 0
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT f.point.AsTextZM() as point, f.point.STSrid as srid
      FROM (SELECT [$(owner)].[STMakePoint](1,2,3,4,28355) as point) as f;
    point    srid
    POINT (1 2 3 4)    28355
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function creates a point from the supplied ordinates.
</pre>
<p class="item_name">NOTES</p>
<pre>    Extends supplied non-OGC static function Point.
    Alternative to extended WKT constructor:
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_x        (float) - Not null X Ordinate.
    @p_y        (float) - Not null Y Ordinate.
    @p_z        (float) - Not null Z Ordinate.
    @p_m        (float) - Not null M Ordinate.
</pre>
<p class="item_name">RESULT</p>
<pre>    Point                      - Geometry point.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
  LICENSE
    Creative Commons Attribution-Share Alike 2.5 Australia License.
    <a href="http://creativecommons.org/licenses/by-sa/2.5/au/">http://creativecommons.org/licenses/by-sa/2.5/au/</a>
</pre>
<a name="robo58"></a>
<a name="EDITOR2fSTAppend2028201229"></a>
<h1>59.  EDITOR/STAppend (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STAppend -- Appends second linestring to end of first linestring.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(lrsowner)].[STAppend] (
               @p_linestring1 geometry,
               @p_linestring2 geometry,
               @p_round_xy    int   = 3,
               @p_round_zm    int   = 2
             )
     Returns geometry 
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Given two linestrings, this function appends the second to the first, though their direction could change (eg Start/Start Point relationship).
    While one can use STUnion() for this, STUnion does not handle geometries with Z and M.
    This function specifically supports Z and M for LRS type operations.
    The input geometry objects must conform to the following:
      1. Normally, both linestrings should be either a CircularString or a Linestring.
      2. A CompoundCurve is supported only when it is supplied as @p_linestring1.
      3. A MultiLineString can only be supplied via @p_linestring1.
      4. A LineString can only be supplied via @p_linestring2 when @p_linestring1 is a MultiLineString.
      5. Two supplied MultiLineString geometries are not currently supported.
      6. Both linestring parameters must have the same SRID
      7. Both linestring parameters must have the same Coordinate Dimension ie XYZ=XYZ, XYM=XYM or XYZM=XYZM. 
      8. Both linestring parameters geometries must be valid.
    It is up to the caller to ensure these conditions are met.
    For optimal performance one should append a smaller second geometry (@p_linestring2) to a larger @p_linestring1.
</pre>
<p class="item_name">NOTES</p>
<pre>    Supports Linestrings with CircularString elements.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring1 (geometry) - Linestring geometry possibly with elevation (Z) and measures (M).
    @p_linestring2 (geometry) - Linestring geometry possibly with elevation (Z) and measures (M).
    @p_round_xy         (int) - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm         (int) - Decimal degrees of precision to which calculated ZM ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    appended line  (geometry) - New line with second appended to first
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2018 - Original Coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo59"></a>
<a name="EDITOR2fSTConvertToLineString2028200829"></a>
<h1>60.  EDITOR/STConvertToLineString (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STConvertToLineString -- Creates a (multi)linestring from supplied GeometryCollection geometry's (multi)linestring objects.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STConvertToLineString (
               @p_geometry_collection geometry
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [dbo].STConvertToLineString(geometry::STGeomFromText('GEOMETRYCOLLECTION(LINESTRING(0 0,1 1),MULTILINESTRING((3 3,8 8),(9 9,20 20)))'',0) as line;
    LINE
    LINESTRING(0 0,10 10)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function creates linestring from linestrings within supplied @p_geometry_collection (GeometryCollection).
</pre>
<p class="item_name">NOTES</p>
<pre>    Only LineString/MultiLinestring/CircularString/CompoundString geometries within @p_geometry_collection supported 
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry_collection (geometry) - Not null GeometryCollection containing some linear geometry types.
</pre>
<p class="item_name">RESULT</p>
<pre>    (Multi)LineString -- (Multi)LineString from provided GeometryCollection's linear geometries.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    With gc As (
      select geometry::STGeomFromText('GEOMETRYCOLLECTION(POINT(0 0), POLYGON((0 0,10 0,10 10,0 10,0 0)) )',0) as geom
       union all
      select geometry::STGeomFromText('GEOMETRYCOLLECTION (MULTILINESTRING((0 0,20 0),(20 20,0 20,0 0)))', 0) as geom
       union all
      select geometry::STGeomFromText('GEOMETRYCOLLECTION(LINESTRING(0 0,20 0,20 20,0 20,0 0), POINT(0 0), POLYGON((0 0,10 0,10 10,0 10,0 0)) )',0) as geom
       union all
      select geometry::STGeomFromText('GEOMETRYCOLLECTION(LINESTRING(0 0,20 0,20 20,0 20,0 0),LINESTRING(1 1,2 2),LINESTRING(3 3,19 19),POINT(0 0), POLYGON((0 0,10 0,10 10,0 10,0 0)) )',0) as geom
       union all
      select geometry::STGeomFromText('GEOMETRYCOLLECTION(MULTILINESTRING((0 0,20 0),(20 20,0 20,0 0)), LINESTRING(1 1,2 2),LINESTRING(3 3,19 19),POINT(0 0),POLYGON((0 0,10 0,10 10,0 10,0 0)) )',0) as geom
    )
    select [dbo].[STConvertToLineString](geom).STAsText() as geomWKT
      from gc as a
    go

    geomWKT
    ---------------------------------------------------------------------------
    LINESTRING EMPTY
    MULTILINESTRING ((0 0, 20 0), (20 20, 0 20, 0 0))
    LINESTRING (0 0, 20 0, 20 20, 0 20, 0 0)
    MULTILINESTRING ((0 0, 20 0, 20 20, 0 20, 0 0), (1 1, 2 2), (3 3, 19 19))
    MULTILINESTRING ((0 0, 20 0), (20 20, 0 20, 0 0), (1 1, 2 2), (3 3, 19 19))
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - August  2018 - Original TSQL Coding for SQL Server.
    Simon Greener - October 2019 - Fixed bug with single MultiLineString in Geometry Collection.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2019 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo60"></a>
<a name="EDITOR2fSTDelete2028200829"></a>
<h1>61.  EDITOR/STDelete (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STDelete -- Function which deletes one or more coordinates from the supplied geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STDelete (
               @p_geometry   geometry,
               @p_point_list varchar(max) 
               @p_round_xy   int = 3,
               @p_round_zm   int = 2
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STDelete(STGeomFromText('LINESTRING(0.1 0.2,1.4 45.2,120 394.23)',0),'2',3,2).STAsText() as deleteGeom; 
    # deleteGeom
    'LINESTRING(0.1 0.2,120 394.23)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that removes one or more coordinates from the supplied geometry.
    The function does not process POINT or GEOMETRYCOLLECTION geometries.
    The list of points to be deleted is supplied as a comma separated string of point numbers.
    The point numbers are from 1 to the total number of points in a WKT representation of the object.
    Point numbers do not refer to specific points within a specific sub-geometry eg point number 1 in the 2nd interiorRing in a polygon object.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry     (geometry) - supplied geometry of any type.
    @p_point_line    (varchar) - Comma separated list of point numbers from 1 to the total number in a geometry's WKT representation.
    @p_round_xy          (int) - Rounding value for XY ordinates.
    @p_round_zm          (int) - Rounding value for ZM ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    modified geom   (geometry) - With referenced points deleted. 
</pre>
<p class="item_name">NOTES</p>
<pre>    May throw error message STGeomFromText error if point deletion invalidates the geometry.
</pre>
<p class="item_name">TODO</p>
<pre>    Support for CircularString and CompundCurve objects.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original Coding for MySQL.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo61"></a>
<a name="EDITOR2fSTDeleteN2028200829"></a>
<h1>62.  EDITOR/STDeleteN (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STDeleteN -- Function which deletes referenced coordinate from the supplied geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STDeleteN (
               @p_geometry geometry,
               @p_position int, 
               @p_round_xy int = 3,
               @p_round_zm int = 2 
             (
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STDeleteN(STGeomFromText('LINESTRING(0.1 0.2,1.4 45.2,120 394.23)',0),2,3,2).STAsText() as deleteGeom; 
    # deleteGeom
    'LINESTRING(0.1 0.2,120 394.23)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that removes a single, nominated, coordinates from the supplied geometry.
    The function does not process POINT or GEOMETRYCOLLECTION geometries.
    The point to be deleted is supplied as a single integer.
    The point number can be supplied as -1 (last number), or 1 to the total number of points in a WKT representation of the object.
    A point number does not refer to a specific point within a specific sub-geometry eg point number 1 in the 2nd interiorRing in a polygon object.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry   (geometry) - supplied geometry of any type.
    @p_position   (int) - Valid point number in geometry.
    @p_round_xy   (int) - Rounding value for XY ordinates.
    @p_round_zm   (int) - Rounding value for ZM ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    modified geom (geometry) - With referenced point deleted. 
</pre>
<p class="item_name">NOTES</p>
<pre>    May throw error message STGeomFromText error if point deletion invalidates the geometry.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original Coding for MySQL.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo62"></a>
<a name="EDITOR2fSTDensify2028201229"></a>
<h1>63.  EDITOR/STDensify (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STDensify -- Implements a basic geometry densification algorithm.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STDensify](
               @p_geometry geometry,
               @p_distance Float,
               @p_round_xy int = 10,
               @p_round_zm int = 10
             )
      Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function add vertices to an existing vertex-to-vertex described (m)linestring or (m)polygon sdo_geometry.
    New vertices are added in such a way as to maintain existing vertices, that is, no existing vertices are removed.
    Densification occurs on a single vertex-to-vertex segment basis.
    If segment length is &lt; p_distance no vertices are added.
    The implementation does not guarantee that the added vertices will be exactly p_distance apart; mostly they will be &lt; @p_distance..
    The implementation honours 3D and 4D shapes and averages these dimension values for the new vertices.
    The function does not support compound objects or objects with circles, or described by arcs.
    Any non (m)polygon/(m)linestring shape is simply returned as it is.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre>    @p_geometry (geometry) - (M)Linestring or (m) polygon.
    @p_distance    (Float) - The desired optimal distance between added vertices.
    @p_round_xy      (int) - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm      (int) - Decimal degrees of precision to which ZM ordinates are compared.
</pre>
<p class="item_name">RESULT</p>
<pre>    geometry (T_GEOMETRY) -- Densified geometry.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    -- Densify 2D line into 4 segments
    with data as (
    select geometry::STGeomFromText('LINESTRING(0 0,10 10)',0) as geom
    )
    select [dbo].[STDensify](a.geom,a.geom.STLength()/4.0,3,2).AsTextZM() as dGeom
      from data as a;

    dGeom
    LINESTRING (0 0, 2.5 2.5, 5 5, 7.5 7.5, 10 10)

    -- Distance between all vertices is &lt; 4.0
    select [dbo].[STDensify](geometry::STGeomFromText('LINESTRING (5 5, 5 7, 7 7, 7 5, 5 5)',0),4.0,3,2).AsTextZM() as dGeom;

    dGeom
    LINESTRING (5 5, 5 7, 7 7, 7 5, 5 5)

    -- Simple Straight line.
    select [$(owner)].[STDensify] (geometry::STGeomFromText('LINESTRING(100 100,900 900.0)',0),125.0,3,2).AsTextZM() as dGeom;

    DGeom
    LINESTRING (100 100, 188.889 188.889, 277.778 277.778, 366.667 366.667, 455.556 455.556, 544.444 544.444, 633.333 633.333, 722.222 722.222, 811.111 811.111, 900 900)

    -- LineString with Z
    select [dbo].[STDensify] (geometry::STGeomFromText('LINESTRING(100 100 1.0,900 900.0 9.0)',0),125.0,3,2).AsTextZM() as dGeom;
    
    dGeom
    LINESTRING (100 100 1, 180 180 1.8, 260 260 2.6, 340 340 3.4, 420 420 4.2, 500 500 5, 580 580 5.8, 660 660 6.6, 740 740 7.4, 820 820 8.2, 900 900 9)

    -- LineStrings with ZM
    select [dbo].[STDensify] (geometry::STGeomFromText('LINESTRING(100.0 100.0 -4.56 0.99, 110.0 110.0 -6.73 1.1)',0),2.5,3,2).AsTextZM() as dGeom;
    
    dGeom
    LINESTRING (100 100 -4.56 0.99, 101.667 101.667 -4.92 1.01, 103.333 103.333 -5.28 1.03, 105 105 -5.64 1.04, 106.667 106.667 -6.01 1.06, 108.333 108.333 -6.37 1.08, 110 110 -6.73 1.1)

    GEOM
      LINESTRING (1100.765 964.286, 1107.568 939.343, 1114.371 914.399, 1121.173 889.456, 1127.976 864.513, 1134.779 839.569, 1141.582 814.626, 1148.384 789.683, 1155.187 764.739, 1161.99 739.796, 1139.881 723.923, 
                  1117.772 708.05, 1095.663 692.177, 1073.554 676.304, 1051.446 660.431, 1029.337 644.558, 1007.228 628.685, 985.119 612.812, 963.01 596.939, 941.032 610.675, 919.054 624.411, 897.076 638.148,
                  875.098 651.884, 853.12 665.62, 831.142 679.356, 809.164 693.093, 787.186 706.829, 765.208 720.565, 743.23 734.301, 721.252 748.038, 699.274 761.774, 677.296 775.51, 653.203 787.131, 629.11 
                  798.753, 605.017 810.374, 580.924 821.995, 556.831 833.617, 532.738 845.238, 508.645 856.859, 484.552 868.481, 460.459 880.102, 434.63 869.26, 408.801 858.418, 382.972 847.576, 357.143 
                  836.735, 331.314 825.893, 305.485 815.051, 279.656 804.209, 253.827 793.367, 242.53 770.043, 231.232 746.72, 219.935 723.396, 208.637 700.073, 197.34 676.749, 186.042 653.426, 174.745 
                  630.102, 185.459 603.571, 196.173 577.041, 206.888 550.51, 217.602 523.98, 228.316 497.449, 253.543 500.85, 278.77 504.252, 303.996 507.653, 329.223 511.054, 354.45 514.456, 379.677 
                  517.857, 404.903 521.258, 430.13 524.66, 455.357 528.061, 479.244 520.64, 503.131 513.219, 527.017 505.798, 550.904 498.377, 574.791 490.956, 598.678 483.534, 622.565 476.113, 646.452 468.692, 
                  670.338 461.271, 694.225 453.85, 718.112 446.429, 717.262 420.493, 716.411 394.558, 715.561 368.622, 714.711 342.687, 713.86 316.751, 713.01 290.816, 698.66 270.089, 684.311 249.362, 
                  669.962 228.635, 655.612 207.908, 641.263 187.181, 626.913 166.454, 612.564 145.727, 598.214 125, 573.271 120.181, 548.327 115.363, 523.384 110.544, 498.441 105.726, 473.497 100.907, 
                  448.554 96.089, 423.611 91.27, 398.667 86.452, 373.724 81.633, 351.858 94.935, 329.992 108.236, 308.126 121.538, 286.261 134.84, 264.395 148.142, 242.529 161.443, 220.663 174.745, 
                  198.797 188.047, 176.931 201.348, 155.065 214.65, 133.2 227.952, 111.334 241.254, 89.468 254.555, 67.602 267.857)

    -- MultiLineString.
    select [dbo].[STDensify](geometry::STGeomFromText('MULTILINESTRING ((0 0, 5 5, 10 10),(20 20, 25 25, 30 30))',0),2.1,3,2).AsTextZM() as dGeom;

    dGeom
    MULTILINESTRING ((0 0, 1.25 1.25, 2.5 2.5, 3.75 3.75, 5 5, 6.25 6.25, 7.5 7.5, 8.75 8.75, 10 10), (20 20, 21.25 21.25, 22.5 22.5, 23.75 23.75, 25 25, 26.25 26.25, 27.5 27.5, 28.75 28.75, 30 30))

    -- Polygon 
    select [dbo].[STDensify](
                  geometry::STGeomFromText('POLYGON((0 0,20 0,20 20,0 20,0 0),(10 10,10 11,11 11,11 10,10 10),(5 5,5 7,7 7,7 5,5 5))',0),
                  4.0,
                  3,2
           ).AsTextZM() as dGeom;
    
    dGeom
    POLYGON ((0 0, 4 0, 8 0, 12 0, 16 0, 20 0, 20 4, 20 8, 20 12, 20 16, 20 20, 16 20, 12 20, 8 20, 4 20, 0 20, 0 16, 0 12, 0 8, 0 4, 0 0), (10 10, 10 11, 11 11, 11 10, 10 10), (5 5, 5 7, 7 7, 7 5, 5 5))

    -- MultiPolygon
    select [dbo].[STDensify](
                  geometry::STGeomFromText('MULTIPOLYGON(((100 100,110 100,110 110,100 110,100 100)),((0 0,20 0,20 20,0 20,0 0),(10 10,10 11,11 11,11 10,10 10),(5 5,5 7,7 7,7 5,5 5)))',0),
                  4.0,
                  3,2
           ).AsTextZM() as dGeom;
    
    dGeom
    MULTIPOLYGON (((100 100, 103.333 100, 106.667 100, 110 100, 110 103.333, 110 106.667, 110 110, 106.667 110, 103.333 110, 100 110, 100 106.667, 100 103.333, 100 100)), 
                  ((0 0, 4 0, 8 0, 12 0, 16 0, 20 0, 20 4, 20 8, 20 12, 20 16, 20 20, 16 20, 12 20, 8 20, 4 20, 0 20, 0 16, 0 12, 0 8, 0 4, 0 0), (10 10, 10 11, 11 11, 11 10, 10 10), (5 5, 5 7, 7 7, 7 5, 5 5)))
</pre>
<p class="item_name">NOTES</p>
<pre>    Only supports stroked (m)linestrings and (m)polygon rings.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - June  2006 - Original coding in Oracle.
    Simon Greener - April 2019 - Port to SQL Server Spatial
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2005-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo63"></a>
<a name="EDITOR2fSTExtend2028200829"></a>
<h1>64.  EDITOR/STExtend (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STExtend -- Function which extends the supplied linestring required distance at its start/end or both.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STExtend (
               @p_linestring    geometry,
               @p_extend_length float,
               @p_end           int,
               @p_keep          int,
               @p_round_xy      int = 3,
               @p_round_zm      int = 2
             )
     Returns geometry
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STExtend](geometry::ST_GeomFromText('LINESTRING(0.1 0.2,1.4 45.2)',0),5.0,'START',1,2,1).AsTextZM() as extendedGeom;
    # extendedGeom
    'LINESTRING(-4.9 30.2,-3.6 31.5)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that extends the supplied linestring at either its start or end (p_end), in the direction of a line formed by the
    first and second vertices (if START) or last and second last vertices (if END). @p_end value of BOTH means line is extended at both ends.
    If @p_keep is set to 1, the start or end vertex is kept and a new vertex added at the extended length from the start/end.
    If @p_keep is 0, the actual first or last vertex is moved.
    The computed ordinates of the new geometry are rounded to @p_round_xy/@p_round_zm number of decimal digits of precision.
</pre>
<p class="item_name">NOTES</p>
<pre>    MultiLinestrings and CircularString linestrings are not supported.
    Assumes planar projection eg UTM.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring    (geometry) - Supplied geometry of type LINESTRING only.
    @p_extend_length (float)    - Length to extend linestring in SRID units.
    @p_end           (varchar5) - START means extend line at the start; END means extend at the end and BOTH means extend at both START and END of line.
    @p_keep          (int)      - Keep existing first/last vertex and add new (1) vertices, or move (0) existing start/end vertex.
    @p_round_xy      (int)      - Round XY ordinates to supplied decimal digits of precision.
    @p_round_zm      (int)      - Round ZM ordinates to supplied decimal digits of precision.
</pre>
<p class="item_name">RESULT</p>
<pre>    linestring       (geometry) - Input geometry extended as instructed.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo64"></a>
<a name="EDITOR2fSTInsertN2028200829"></a>
<h1>65.  EDITOR/STInsertN (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STInsertN -- Function which inserts new coordinate (p_point) at position @p_position in the supplied geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STInsertN (
               @p_geometry geometry,
               @p_point    geometry,
               @p_position int,
               @p_round_xy int = 3,
               @p_round_zm int = 2
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STInsertN(
             STGeomFromText ('LINESTRING(0 0,2 2)',0),
             STPointFromText('POINT(1 1)',0),
             2,
             1,1).AsTextZM() as newGeom;
    # newGeom
    'LINESTRING(0 0,1 1,2 2)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that inserts the coordinate @p_point into position @p_position in the supplied geometry.
    @p_position Values:
      1. null -&gt; defaults to 1;
      2. -1   -&gt; maximum number of points ie STNumPoints(p_geometry) 
      3. Greater than STNumPoints(p_geometry) -&gt; maximum number of points ie STNumPoints(p_geometry)
    The inserted coordinate's ordinates are rounded to @p_round_xy number of decimal digits of precision.
</pre>
<p class="item_name">NOTES</p>
<pre>    This version is for SQL Server 2008 only.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Supplied geometry of any type.
    @p_point    (geometry) - Insert coordinate
    @p_position (int)      - Coordinate position in @p_geometry: between 1 and STNumPoints.
    @p_round_xy (int)      - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm (int)      - Decimal degrees of precision to which calculated ZM ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    geometry -- Input geometry with coordinate inserted.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original Coding for MySQL.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo65"></a>
<a name="EDITOR2fSTInsertN2028201229"></a>
<h1>66.  EDITOR/STInsertN (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STInsertN -- Function which inserts new coordinate (p_point) at position @p_position in the supplied geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STInsertN (
               @p_geometry geometry,
               @p_point    geometry,
               @p_position int,
               @p_round_xy int,
               @p_round_zm int 
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STInsertN(
             STGeomFromText ('LINESTRING(0 0,2 2)',0),
             STPointFromText('POINT(1 1)',0),
             2,
             1,1 ).AsTextZM() as newGeom;
    # updatedGeom
    'LINESTRING(0 0,1 1,2 2)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that inserts the coordinate @p_point into position @p_position in the supplied geometry.
    @p_position Values:
      1. null -&gt; defaults to 1;
      2. -1   -&gt; maximum number of points ie STNumPoints(p_geometry) 
      3. Greater than STNumPoints(p_geometry) -&gt; maximum number of points ie STNumPoints(p_geometry)
    The inserted coordinate's ordinates are rounded to @p_round_xy number of decimal digits of precision.
</pre>
<p class="item_name">NOTES</p>
<pre>    This version is for SQL Server versions from 2012 onwards.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Supplied geometry of any type.
    @p_point    (geometry) - Insert coordinate
    @p_position (int)      - Coordinate position in @p_geometry: between 1 and STNumPoints.
    @p_round_xy (int)      - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm (int)      - Decimal degrees of precision to which calculated ZM ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    geometry -- Input geometry with coordinate inserted.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original Coding for MySQL.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo66"></a>
<a name="EDITOR2fSTIsCompound2028201229"></a>
<h1>67.  EDITOR/STIsCompound (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STIsCompound -- Tests if supplied geometry has circularString elements.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STIsCompound (
               @p_geometry geometry 
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STIsCompound](geometry::STGeomFromText('
     CURVEPOLYGON(
       COMPOUNDCURVE(
            CIRCULARSTRING(0 5,5 0,10 5,5 10,0 5)
       )
     )',0)) as isCompound
    GO
    isCompound 
    1
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that checks if the supplied geometry is described by CircularString elements.
</pre>
<p class="item_name">NOTES</p>
<pre>    While will run in SQL Server 2008 (always 0), is aimed at 2012 onwards.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Any geometry object.
</pre>
<p class="item_name">RESULT</p>
<pre>    true/false  (bit)      - 1 (True) or 0 (False)
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2012 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo67"></a>
<a name="EDITOR2fSTMulti2028201229"></a>
<h1>68.  EDITOR/STMulti (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMulti -- Function that return @p_geometry as a MULTI* geometry
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMulti (
               @p_geometry geometry
             )
     Returns geometry 
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns @p_geometry as a MULTI* geometry. 
    For example: POINT -&gt; MULTIPOINT
    If @p_geometry is already a MULTI*, it is returned unchanged.
    For example: MULTIPOINT -&gt; MULTIPOINT
    MULTI returned only contains 1 geometry so STNumGeometries will return 1.
</pre>
<p class="item_name">NOTES</p>
<pre>    CircularString input geometry is returned as a GEOMETRYCOLLECTION as it 
    cannot be returned as a MUTLICURVE as it is not instantiable. Additionally,
    one cannot construct a MULTILINESTRING containing it MUTLILINESTRING(CIRCULARSTRING(....)).
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - supplied geometry of any type.
</pre>
<p class="item_name">RESULT</p>
<pre>    geometry    (geometry) - Input geometry converted to MULTI geometry.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    USE GISDB
    GO
    
    SELECT f.mGeom.AsTextZM() as mGeom, f.mGeom.STNumGeometries() as numGeometries
      FROM (SELECT [dbo].[STMulti](geometry::STPointFromText('POINT(0 0)',0)) as mGeom
             UNION ALL
            SELECT [dbo].[STMulti](geometry::STGeomFromText ('POLYGON ((0 0,10 0,10 10,0 10,0 0))',0)) as mgeom
             UNION ALL
            SELECT [dbo].[STMulti](geometry::STGeomFromText ('LINESTRING(0 0,10 10,20 20)',0)) as mgeom
             UNION ALL
            SELECT [dbo].[STMulti](geometry::STGeomFromText('CIRCULARSTRING(9.962 -0.872,10.1 0,9.962 0.872)',0)) as mgeom
       ) as f;
    GO

    mGeom                                                                  numGeometries
    MULTIPOINT ((0 0))                                                                 1
    MULTIPOLYGON (((0 0, 10 0, 10 10, 0 10, 0 0)))                                     1
    MULTILINESTRING ((0 0, 10 10, 20 20))                                              1
    GEOMETRYCOLLECTION (CIRCULARSTRING (9.962 -0.872, 10.1 0, 9.962 0.872))            1
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - August 2019 - Original TSQL Coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2019 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo68"></a>
<a name="EDITOR2fSTReduce2028200829"></a>
<h1>69.  EDITOR/STReduce (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STReduce -- Function which extends the first or last vertex connected segment of a linestring.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STReduce (
               @p_linestring       geometry,
               @p_reduction_length float,
               @p_end              varchar(5),
               @p_round_xy         int = 3,
               @p_round_zm         int = 2
             )
     Returns geometry
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STReduce](geometry::ST_GeomFromText('LINESTRING(0.1 0.2,1.4 45.2)',0),5.0,'START',2,1).AsTextZM() as reducedGeom;
    # reducedGeom
    'LINESTRING(-4.9 30.2,-3.6 31.5)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that shortens the supplied linestring at either its start or end (p_end) the required length.
    The function can apply the reduction at either ends (or both).
    The function will remove existing vertices as the linestring is shortened. 
    If the linestring reduces to nothing, an error will be thrown by STGeomFromText.
    Any computed ordinates of the new geometry are rounded to @p_round_xy/@p_round_zm number of decimal digits of precision.
</pre>
<p class="item_name">NOTES</p>
<pre>    MultiLinestrings and CircularString linestrings are not supported.
    Assumes planar projection eg UTM.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring        (geometry) - Supplied geometry of type LINESTRING only.
    @p_reduction_length  (float)    - Length to reduce linestring by in SRID units.
    @p_end               (varchar5) - START means reduce line at its start; END means extend at its end and BOTH means extend at both START and END of line.
    @p_round_xy          (int)      - Round XY ordinates to supplied decimal digits of precision.
    @p_round_zm          (int)      - Round ZM ordinates to supplied decimal digits of precision.
</pre>
<p class="item_name">RESULT</p>
<pre>    linestring           (geometry) - Input geometry extended as instructed.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2012-2017 by TheSpatialDBAdvisor/Simon Greener
  LICENSE
    Creative Commons Attribution-Share Alike 2.5 Australia License.
    <a href="http://creativecommons.org/licenses/by-sa/2.5/au/">http://creativecommons.org/licenses/by-sa/2.5/au/</a>
</pre>
<a name="robo69"></a>
<a name="EDITOR2fSTRemoveCollinearPoints2028201229"></a>
<h1>70.  EDITOR/STRemoveCollinearPoints (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STRemoveCollinearPoints -- Function that removes unnecessary points that lie on straight line between adjacent points.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STRemoveCollinearPoints] (
               @p_linestring          geometry,
               @p_collinear_threshold float = -1,
               @p_round_xy            int = 3,
               @p_round_z             int = 2,
               @p_round_m             int = 2
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STRemoveCollinearPoints] (
             geometry::STGeomFromText('LINESTRING(0 0,0.5 0.5,1 1)',0),
             0.5,
             3,
             2,2
           ).AsTextZM() as LineWithCollinearPointsRemoved;
    LineWithCollinearPointsRemoved
    ---------------------------------------------
    LINESTRING (0 0,1 1)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that checks each triple of adjacent points and removes middle one if collinear with start and end point.
    Collinearity is determined by computing the deflection angle (degrees) at the mid point and comparing it to the @p_collinear_threshold parameter value (degrees).
    If the collinear threshold value is &lt; the deflection angle, the mid point is removed.
    The updated coordinate's XY ordinates are rounded to p_round_xy number of decimal digits of precision.
    The updated coordinate's Z ordinate is rounded to @p_round_Z number of decimal digits of precision.
    The updated coordinate's M ordinate is rounded to @p_round_M number of decimal digits of precision.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring       (geometry) - Supplied Linestring geometry.
    @p_round_xy              (int) - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_z               (int) - Decimal degrees of precision to which any calculated Z ordinates is rounded.
    @p_round_m               (int) - Decimal degrees of precision to which any calculated M ordinates is rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    Modified linestring (geometry) - Input linestring with any collinear points removed.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - February 2018 - Original TSQL Coding for SQL Spatial.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo70"></a>
<a name="EDITOR2fSTReverse2028201229"></a>
<h1>71.  EDITOR/STReverse (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STReverse -- Function which reverses the vertices of a linestring and parts/vertices of multilinestring.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STReverse (
               @p_geometry geometry,
               @p_round_xy int = 3,
               @p_round_zm int = 2
             )
     Returns geometry 
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    select id, action, geom 
      from (select 'Before' as action, id, geom.STAsText() as geom
              from (select 1 as id, geometry::STGeomFromText('LINESTRING(0 0, 10 0)',0) as geom
                    union all
                    select 2 as id, geometry::STGeomFromText('MULTILINESTRING((1 1,2 2), (3 3, 4 4))',0) as geom
                    union all
                    select 3 as id, geometry::STGeomFromText('MULTIPOINT((1 1),(2 2),(3 3),(4 4))',0) as geom
                    ) as data
           union all
           select 'After' as action, id, STReverse(geom).STAsText() as geom
             from (select 1 as id, geometry::STGeomFromText('LINESTRING(0 0, 10 0)',0) as geom
                   union all
                   select 2 as id, geometry::STGeomFromText('MULTILINESTRING((1 1,2 2), (3 3, 4 4))',0) as geom
                   union all
                   select 3 as id, geometry::STGeomFromText('MULTIPOINT((1 1),(2 2),(3 3),(4 4))',0) as geom
                  ) as data
           ) as f
    order by id, action desc;

    id action geom
  ---- ------ --------------------------------------
     1 Before LINESTRING(0 0,10 0)
     1 After  LINESTRING(10 0,0 0)
     2 Before MULTILINESTRING((1 1,2 2),(3 3,4 4))
     2 After  MULTILINESTRING((4 4,3 3),(2 2,1 1))
     3 Before MULTIPOINT((1 1),(2 2),(3 3),(4 4))
     3 After  MULTIPOINT((4 4),(3 3),(2 2),(1 1))
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that reverses the coordinates of the following:
      1. MultiPoint 
      2. LineString
      3. CircularString (2012)
      4. CompoundCurve  (2012)
      5. MultiLineString 
    If the geometry is a MultiLineString, the parts, and then their vertices are reversed.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry   (geometry) - Supplied geometry of supported type.
    @p_round_xy   (int)      - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm   (int)      - Decimal degrees of precision to which calculated ZM ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    reversed geom (geometry) - Input geometry with parts and vertices reversed.
</pre>
<p class="item_name">NOTES</p>
<pre>    Function STGeomFromText if reversal processing invalidates the geometry.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo71"></a>
<a name="EDITOR2fSTSetZ2028201229"></a>
<h1>72.  EDITOR/STSetZ (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STSetZ -- Function that adds or updates (replaces) Z value of supplied geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STSetZ (
               @p_geometry geometry,
               @p_z        float,
               @p_round_xy int = 3,
               @p_round_zm int = 2
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STSetZ(
             STPointFromText('POINT(0 0)',0),
             1,
             3, 2 
           ).AsTextZM() as updatedPoint;
    # updatedPoint
    'POINT(0 0 1)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that adds/updates Z ordinate of the supplied @p_geometry.
    If single point, it is updated and returned. 
    If Linestring/MultiLinestring, all Z ordinates are set to the supplied value.
    The updated coordinate's XY ordinates are rounded to @p_round_xy number of decimal digits of precision.
    The updated coordinate's ZM ordinates are rounded to @p_round_ZM number of decimal digits of precision.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_point     (geometry) - Supplied geometry.
    @p_z         (float)    - Z value.
    @p_round_xy  (int)      - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm  (int)      - Decimal degrees of precision to which calculated ZM ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    point with Z (geometry) - Input point geometry with Z set to @p_Z.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Spatial.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo72"></a>
<a name="EDITOR2fSTSwapOrdinates2028200829"></a>
<h1>73.  EDITOR/STSwapOrdinates (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STSwapOrdinates -- Allows for swapping ordinate pairs in a geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STSwapOrdinates (
               @p_geometry geometry,
               @p_swap     varchar(2) = 'XY'
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STSwapOrdinates] (
             geometry::STPointFromText('POINT(143.282374 20.293874)',4326),
             'XY'
           ).AsTextZM() as correctedOrdinates;
    correctedOrdinates
    POINT (20.293874 143.282374)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Sometimes the ordinates of a geometry can be swapped such as latitude for X
    and Longitude for Y when it should be reversed. This function allows for the
    swapping of pairs of ordinates controlled by the @p_swap parameter.
    Also supports Z and M ordinate values.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry)  - Supplied geometry.
    @p_swap     (varchar 2) - The ordinate pair to swap: XY, XZ, XM, YZ, YM or ZM
</pre>
<p class="item_name">RESULT</p>
<pre>    altered geom (geometry) - Changed Geometry;
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - August 2009 - Original TSQL Coding for SQL Spatial.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo73"></a>
<a name="EDITOR2fSTUpdate2028201229"></a>
<h1>74.  EDITOR/STUpdate (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STUpdate -- Function that updates (replaces) all geometry points that are equal to the supplied point with the replacement point.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STUpdate (
               @p_geometry      geometry,
               @p_point         geometry,
               @p_replace_point geometry,
               @p_round_xy      int = 3,
               @p_round_zm      int = 2
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STUpdate(
             STGeomFromText ('POLYGON(0 0,10 0,10 10,0 10,0 0)',0),
             STPointFromText('POINT(0 0)',0),
             STPointFromText('POINT(1 1)',0),
             1 
           ).AsTextZM() as updatedGeom;
    # updatedGeom
    'POLYGON(1 1,10 0,10 10,0 10,1 1)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that updates all coordinates that equal @p_point with the supplied @p_replace_point.
    The @p_round_xy value is used when comparing geometry point's XY ordinates to @p_point's.
    The updated coordinate's XY ordinates are rounded to @p_round_xy number of decimal digits of precision.
    The updated coordinate's ZM ordinates are rounded to @p_round_ZM number of decimal digits of precision.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry      (geometry) - supplied geometry of any type.
    @p_point         (geometry) - Original coordinate to be replaced.
    @p_replace_point (geometry) - Replacement coordinate
    @p_round_xy      (int)      - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm      (int)      - Decimal degrees of precision to which calculated ZM ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    geometry         (geometry) - Input geometry with one or more coordinate replaced.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Spatial.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo74"></a>
<a name="EDITOR2fSTUpdateN2028201229"></a>
<h1>75.  EDITOR/STUpdateN (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STUpdateN -- Function which updates the coordinate at position @p_position in the supplied geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STUpdateN (
               @p_geometry   geometry,
               @p_replace_pt float,
               @p_position   int,
               @p_round_xy   int = 3,
               @p_round_zm   int = 2
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STUpdateN(
             STGeomFromText ('LINESTRING(0 0,2 2)',0),
             STPointFromText('POINT(1 1)',0),
             2,
             2, 1 ).STAsText() as updatedGeom;
    # updatedGeom
    'LINESTRING(0 0,1 1)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that updates coordinate identified by @p_position with the new point (@p_replace_point) in the supplied geometry.
    @p_position Values:
      1. null -&gt; defaults to 1;
      2. -1   -&gt; maximum number of points ie STNumPoints(p_geometry) 
      3. Greater than STNumPoints(p_geometry) -&gt; maximum number of points ie STNumPoints(p_geometry)
    The updated coordinate's ordinates are rounded to @p_round_xy number of decimal digits of precision.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry      (geometry) - supplied geometry of any type.
    @p_replace_point (geoemtry) - Replacement coordinate
    @p_position      (int)      - Coordinate position in @p_geometry: between 1 and STNumPoints.
    @p_round_xy      (int)      - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_zm      (int)      - Decimal degrees of precision to which calculated zm ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    updated geom     (geometry) - Input geometry with coordinate replaced.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original Coding for MySQL.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo75"></a>
<a name="GEOPROCESSING2fSTBoundingDiagonal2028200829"></a>
<h1>76.  GEOPROCESSING/STBoundingDiagonal (2008) [ Methods ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Methods ]</p>
<p class="item_name">NAME</p>
<pre>    STBoundingDiagonal -- Returns the diagonal of the supplied geometry's bounding box as a linestring.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [dbp].[STBoundingDiagonal] (
                @p_geom     geometry,
                @p_round_xy int = 3,
                @p_round_zm int = 2
             )
     Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function creates a linestring diagonal for the input geometry.
</pre>
<p class="item_name">NOTES</p>
<pre>    Does not support Points
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geom   (geometry) - Must not be a Point geometry.
    @p_round_xy    (int) - Rounding factor for XY ordinates.
    @p_round_zm    (int) - Rounding factor for ZM ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    linstring (geometry) - Result is diagonal of envelope around input geometry.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    with data as (
      select geometry::STGeomFromText('POLYGON ((0 0,100 0,100 10,0 10,0 0))',0) as geom
    )
    select [$(owner)].[STBoundingDiagonal] (b.geom,3,2).STAsText() as bLine
      from data as b;

    bLine
    LINESTRING (0 0, 100 10)
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Oct 2019 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2012-2019 by TheSpatialDBAdvisor/Simon Greener
  LICENSE
    Creative Commons Attribution-Share Alike 2.5 Australia License.
    <a href="http://creativecommons.org/licenses/by-sa/2.5/au/">http://creativecommons.org/licenses/by-sa/2.5/au/</a>
</pre>
<a name="robo76"></a>
<a name="GEOPROCESSING2fSTCentroid"></a>
<h1>77.  GEOPROCESSING/STCentroid [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>STCentroid</strong> -- Wrapper that creates centroid geometry for any multipoint, (multi)line or (multi)Polygon object. 
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function ST_Centroid (
       @p_geometry             geometry,
       @p_multi_Mode           int   = 2,    
       @p_area_x_start         int   = 0,
       @p_area_x_ordinate_seed Float = 0,
       @p_line_position_ratio  Float = 0.5,
       @p_round_xy             int   = 3,
       @p_round_zm             int   = 2
    )
   Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function creates a single centroid by calling the Centroid_P, Centroid_L or Centroid_A functions
    according to @p_geometry.STGeometryType().
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry          (geometry) - Geometry object.
    @p_multi_mode             (int) - Maps to STCentroid_L/@p_multiLineStringMode or STCentroid_P/@p_multiPolygonMode.
    @p_area_x_start           (int) - Maps to STCentroid_A/@p_area_x_start.
    @p_area_x_ordinate_seed (Float) - Maps to STCentroid_A/@p_seed_x.
    @p_line_position_ratio  (Float) - Maps to STCentroid_L/@p_position_as_ratio.
    @p_round_xy               (int) - Ordinate rounding precision for XY ordinates.
    @p_round_zm               (int) - Ordinate rounding precision for ZM ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    centroid(s) (geometry) - Centroid of input object.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan 2013 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo77"></a>
<a name="GEOPROCESSING2fSTCentroid5fA2028200829"></a>
<h1>78.  GEOPROCESSING/STCentroid_A (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STCentroid_A - Generates centroid for a polygon or multiPolygon geometry object.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STCentroid_A (
       @p_geometry          geometry,
       @p_multiPolygonMode  int   = 2,    
       @p_area_x_start      int   = 0,
       @p_seed_x            Float = NULL,
       @p_round_xy          int   = 3,
       @p_round_zm          int   = 2
    )
     Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function creates a centroid for a Polygon or MultiPolygon geometry object.
    The standard geometry.<a href="#robo76">STCentroid</a>() function does not guarantee that the centroid it generates falls inside a polygon.
   This function ensures that the centroid of any arbitrary polygon falls within the polygon.
    IF @p_geometry is MultiPolygon four modes are available that control the creation of the centroid(s).
      0 = All      (A multiPoint object is created one for each part)
      1 = First    (First Polygon @p_geometry.STGeometryN(1) is used).
      2 = largest  (Largest Polygon part of MultiPolygon is used).
      3 = smallest (Smallest Polygon part of MultiPolygon is used).
    The function works by computing a X ordinate for which a Y ordinate will be found that falls within the polygon.
    The X ordinate position can be controlled by the @p_area_x_start parameter as follows:
      0 = Average (Use average of X ordinates of Area's vertices for starting X centroid calculation).
      1 = MBR     (Compute and use the Centre X ordinate of the MBR of the geometry object).
      2 = User    (Use the user supplied starting @p_seed_X).
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry    (geometry) - Point or Multipoint geometry object.
    @p_multiPolygonMode (int) - Mode controlling centroid(s) generation when @p_geometry is MultiLineString.
    @p_area_x_start     (int) - How to determine the starting X ordinate.
    @p_seed_x         (Float) - If @p_area_x_start = 2 then user must supply a value.
    @p_round_xy         (int) - Ordinate rounding precision for XY ordinates.
    @p_round_zm         (int) - Ordinate rounding precision for ZM ordinates.
  RETURN
    centroid(s)    (geometry) - One or more centroid depending on input.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - July 2008 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo78"></a>
<a name="GEOPROCESSING2fSTCentroid5fL2028200829"></a>
<h1>79.  GEOPROCESSING/STCentroid_L (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STCentroid_L - Generates centroid for a Linestring or multiLinestring geometry object.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STCentroid_L (
       @p_geometry            geometry,
       @p_multiLineStringMode int   = 2,    
       @p_position_as_ratio   Float = 0.5,
       @p_round_xy            int = 3,
       @p_round_zm            int = 2
    )
     Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function creates a centroid for a Linestring or MultiLineString geometry object.
    IF @p_geometry is MultiLineString four modes are available that control the creation of the centroid(s).
      0 = All      (A multiPoint object is created one for each part)
      1 = First    (First linestring @p_geometry.STGeometryN(1) is used).
      2 = largest  (Longest linestring part of MultiLineString is used).
      3 = smallest (Shortest linestring part of MultiLineString is used).
    The position of the centroid for a single linestring is computed at exactly 1/2 way along its length (0.5).
    The position can be varied by supplying a @p_position_as_ratio value other than 0.5.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry       (geometry) - LineString or MultiLineString geometry object.
    @p_multiLineStringMode (int) - Mode controlling centroid(s) generation when @p_geometry is MultiLineString/GeometryCollection.
    @p_position_as_ratio (float) - Position along linestring where centroid location is computed.
    @p_round_xy            (int) - Ordinate rounding precision for XY ordinates.
    @p_round_zm            (int) - Ordinate rounding precision for ZM ordinates.
  RETURN
    centroid(s)       (geometry) - One or more centroid depending on input.
  TOBEDONE
    Support for MultiLineStrings within GeometryCollections.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - July 2008   - Original coding.
    Simon Greener - August 2018 - Support for GeometryCollection
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo79"></a>
<a name="GEOPROCESSING2fSTCentroid5fP2028200829"></a>
<h1>80.  GEOPROCESSING/STCentroid_P (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STCentroid_P - Generates centroid for a point (itself) or multipoint.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STCentroid_P (
       @p_geometry geometry,
       @p_round_xy int = 3,
       @p_round_zm int = 2
    )
     Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function creates centroid of multipoint via averaging of ordinates.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Point or Multipoint geometry object.
    @p_round_xy (int)      - Ordinate rounding precision for XY ordinates.
    @p_round_zm (int)      - Ordinate rounding precision for ZM ordinates.
  RETURN
    centroid (geometry) - The centroid.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - July 2008 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo80"></a>
<a name="GEOPROCESSING2fSTCheckRadii2028200829"></a>
<h1>81.  GEOPROCESSING/STCheckRadii (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STCheckRadii -- Checks if radius of any three points in a linestring.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STCheckRadii] (
      @p_geom       geometry, 
      @p_min_radius Float, 
      @p_precision  int
    )
    Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that checks vertices in a linestring/multilinestring to see if
    the circular arc they describe have radius less than the provided amount.
    Each set of three vertices (which could be overlapping) that fail the test
    are written to a single MultiPoint object. If no circular arcs in the linestring
    describe a circle with radius less than the required amount a NULL geometry is returned.
    If another other than a (Multi)linestring is provided it is returned as is. 
</pre>
<p class="item_name">NOTES</p>
<pre>    Supports Linestrings with CircularString elements.
    Supplied geometry must not be geographic: function only guaranteed for projected data.
    Does not honour dimensions over 2.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring (geometry) - Projected Linestring geometry 
    @p_min_radius    (Float) - A not null value that describes the minimum radiue of any arc within the linestring.
    @p_precision       (int) - Decimal degrees of precision to which calculated XY ordinates are rounded.
</pre>
<p class="item_name">RESULT</p>
<pre>    points        (geometry) - For (m)linestrings the point triplets have a radius less than required; 
                               For CircularString itself if radius less than required, otherwise null
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT [$(owner)].[STCheckRadii](geometry::STGeomFromText('LINESTRING(0.0 0.0,10.0 0.0,10.0 10.0)',0),10.0,3).STAsText() as failingPoints;
    
    failingPoints
    MULTILINESTRING ((0 0, 10 0, 10 10))
    
    SELECT [$(owner)].[STCheckRadii](geometry::STGeomFromText('MULTILINESTRING((0.0 0.0,10.0 0.0,10.0 10.0),(20.0 0.0,30.0 0.0,30.0 10.0,35 15))',0), 15.0,3).STAsText()  as failingPoints; 
    
    failingPoints
    MULTILINESTRING ((0 0, 10 0, 10 10), (20 0, 30 0, 30 10), (30 0, 30 10, 35 15))
    
    with data as (
      select geometry::STGeomFromText('CIRCULARSTRING(0.0 0.0,10.0 10.0,20.0 0.0)',0) as circulararc
    )
    select gs.IntValue as requiredMinRadius,
           [$(cogoowner)].[STFindCircleFromArc](circularArc).Z as ArcRadius,
           [$(owner)].[STCheckRadii](
                    circulararc,
                    gs.IntValue,
                              3).STAsText() as failingArc
      from data as a
           cross apply
         [$(owner)].[generate_series](5,15,5) as gs;
    
    requiredMinRadius ArcRadius failingArc
    5                 10        NULL
    10                10        NULL
    15                10        CIRCULARSTRING (0 0, 10 10, 20 0)
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2018 - Original Coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo81"></a>
<a name="GEOPROCESSING2fSTDump2028201229"></a>
<h1>82.  GEOPROCESSING/STDump (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STDump -- Extracts the subelements that describe the input geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STDump](
               @p_geometry geometry
             )
     Returns @geometries TABLE 
     (
       id   integer,
       geom geometry
     )  
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function allows a user to extract the subelements of the supplied geometry.
    Some geometries have no subelements: eg Point, LineString
    The subelements of a geometry change depending on the geometry type: 
      1. A MultiPoint only has one or more Point subelements; 
      2. A MultiLineString only more than one LineString subelements; 
      3. A Polygon has zero one or more inner rings and only one outer ring;
      4. A MultiPolygon has zero one or more inner rings and one or more outer rings;
    Some subelements can have subelements when they are Compound:
      1. A CircularCurve can be described by one or more three point circular arcs.
    If subelements exist they are extracted and returned.
</pre>
<p class="item_name">NOTES</p>
<pre>    This version is for versions of SQL Server from 2012 onwards.

    This version is a wrapper over STExtract to mirror the PostGIS function.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - (Multi)geometry or geometryCollection object.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    -- MultiPoint
    SELECT d.id, d.geom.AsTextZM() as geom
      FROM [$(owner)].[STDump] (geometry::STGeomFromText('MULTIPOINT((0 0),(10 0),(10 10),(0 10),(0 0))',0)) as d;
    GO
    
    id   geom
    1    POINT (0 0)
    2    POINT (10 0)
    3    POINT (10 10)
    4    POINT (0 10)
    5    POINT (0 0)
    -- Polygon with hole
    SELECT d.id, d.geom.AsTextZM() as geom
      FROM [$(owner)].[STDump] (geometry::STGeomFromText('POLYGON ((0 0, 10 0, 10 10, 0 10, 0 0),(1 1, 9 1,9 9,1 9,1 1))',0)) as d;
    GO

    id   geom
    1    POLYGON ((0 0, 10 0, 10 10, 0 10, 0 0))
    2    POLYGON ((1 1, 9 1, 9 9, 1 9, 1 1))
    
    -- 2 Polygons, one with hole.
    SELECT d.id, d.geom.AsTextZM() as geom
      FROM [$(owner)].[STDump] (geometry::STGeomFromText('MULTIPOLYGON(((0 0, 10 0, 10 10, 0 10, 0 0),(1 1, 9 1,9 9,1 9,1 1)),((100 100,110 100,110 110, 100 110,100 100)))',0)) as d;
    GO
    
    id   geom
    1    POLYGON ((0 0, 10 0, 10 10, 0 10, 0 0))
    2    POLYGON ((1 1, 9 1, 9 9, 1 9, 1 1))
    3    POLYGON ((100 100, 110 100, 110 110, 100 110, 100 100))
    
    SELECT d.id, d.geom.AsTextZM() as geom
      FROM [$(owner)].[STDump] (geometry::STGeomFromText('GEOMETRYCOLLECTION (POLYGON ((100 200, 180 300, 100 300, 100 200)), LINESTRING (100 200, 100 75), POINT (100 0))',0)) as d;
    GO
    
    id   geom
    1    POLYGON ((100 200, 180 300, 100 300, 100 200))
    2    LINESTRING (100 200, 100 75)
    3    POINT (100 0)
    
    -- MultiLineString
    SELECT d.id, d.geom.AsTextZM() as geom
      FROM [$(owner)].[STDump] (geometry::STGeomFromText('MULTILINESTRING((0 0,5 5,10 10,11 11,12 12),(100 100,200 200))',0)) as d;
    GO
    
    id   geom
    1    LINESTRING (0 0, 5 5, 10 10, 11 11, 12 12)
    2    LINESTRING (100 100, 200 200)
    
    -- geometryCollection
    SELECT d.id, d.geom.AsTextZM() as geom
      FROM [$(owner)].[STDump] (geometry::STGeomFromText('GEOMETRYCOLLECTION (COMPOUNDCURVE(CIRCULARSTRING (3 6.32, 0 7, -3 6.32),(-3 6.32, 0 0, 3 6.32)))',0)) as d;
    GO
    
    id   geom
    1    CIRCULARSTRING (3 6.32, 0 7, -3 6.32)
    2    LINESTRING (-3 6.32, 0 0)
    3    LINESTRING (0 0, 3 6.32)
</pre>
<p class="item_name">RESULT</p>
<pre>    Array of subelements:
    id  - Unique identifier ordered from first element to las.
    geom - Geometry representation of element.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - July 2019
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2019 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo82"></a>
<a name="GEOPROCESSING2fSTDumpPoints2028200829"></a>
<h1>83.  GEOPROCESSING/STDumpPoints (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STDumpPoints - Dumps all vertices of supplied geometry object to ordered array.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>   Function [$(owner)].[STDumpPoints] (
       @p_geometry  geometry 
    )
    Returns @Points Table (
      uid  int,
      pid  int,
      mid  int,
      rid  int,
      x    float,  
      y    float,
      z    float,
      m    float
    )  
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    -- Points from multipolygon
    SELECT e.[uid], e.[mid], e.[rid], e.[pid], e.[x], e.[y], e.[z], e.[m]
      FROM [$(owner)].[STDumpPoints] (
             geometry::STGeomFromText(
               'MULTIPOLYGON( ((200 200, 400 200, 400 400, 200 400, 200 200)),
                              ((0 0, 100 0, 100 100, 0 100, 0 0),(40 40,60 40,60 60,40 60,40 40)) )',0)
           ) as e
    GO
    uid mid rid pid   x   y    z    m
      1   1   1   1 200 200 NULL NULL
      2   1   1   2 400 200 NULL NULL
      3   1   1   3 400 400 NULL NULL
      4   1   1   4 200 400 NULL NULL
      5   1   1   5 200 200 NULL NULL
      6   2   1   1   0   0 NULL NULL
      7   2   1   2 100   0 NULL NULL
      8   2   1   3 100 100 NULL NULL
      9   2   1   4   0 100 NULL NULL
     10   2   1   5   0   0 NULL NULL
     11   2   2   1  40  40 NULL NULL
     12   2   2   2  60  40 NULL NULL
     13   2   2   3  60  60 NULL NULL
     14   2   2   4  40  60 NULL NULL
     15   2   2   5  40  40 NULL NULL
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function extracts the fundamental points that describe a geometry object.
</pre>
<p class="item_name">NOTES</p>
<pre>    This is a wrapper function over STVertices
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Any non-point geometry object
</pre>
<p class="item_name">RESULT</p>
<pre>    Table (Array) of Points :
     uid (int)   - Unique Point identifier across whole geometry
     pid (int)   - Point identifier with element/subelement (1 to Number of Points in element).
     mid (int)   - Unique identifier that describes the geometry object's elements (eg linestring in MultiLineString).
     rid (int)   - SubElement or Ring identifier.
     x   (float) - Start Point X Ordinate 
     y   (float) - Start Point Y Ordinate 
     z   (float) - Start Point Z Ordinate 
     m   (float) - Start Point M Ordinate
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2008 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo83"></a>
<a name="GEOPROCESSING2fSTDumpRings2028201229"></a>
<h1>84.  GEOPROCESSING/STDumpRings (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STDumpRings -- Dumps the rings of a CurvePolygon, Polygon or MultiPolygon
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STDumpRings] (
               @p_geometry geometry
             )
     Returns @rings TABLE
     (
       id   integer,
       geom geometry
     )  
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function allows a user to extract the subelements of the supplied polygon including all compound element descriptions.
    This function is a wrapper over STExtract.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - CurvePolygon, Polygon or MultiPolygon geometry object.
</pre>
<p class="item_name">NOTES</p>
<pre>    Depends on STExtract.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT t.*
     FROM [$(owner)].[STDumpRings](geometry::STGeomFromText('POLYGON((0 0,20 0,20 20,0 20,0 0),(10 10,10 11,11 11,11 10,10 10),(5 5,5 7,7 7,7 5,5 5))',0)) as t
    GO
</pre>
<p class="item_name">RESULT</p>
<pre>    Array of subelements:
    id   - Unique ring identifier starting at first and ending at last in order exist within (multi)polygon
    geom - Geometry representation of subelement.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan  2013 - Original coding.
    Simon Greener - Jan  2015 - Port to TSQL SQL Server
    Simon Greener - July 2019 - Modfied to return only id and geom and no subelements.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2019 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo84"></a>
<a name="GEOPROCESSING2fSTExplode2028201229"></a>
<h1>85.  GEOPROCESSING/STExplode (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STExplode -- STExplode is a wrapper function over STExtract with sub_element parameter set to 1 
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STExplode] (
               @p_geometry geometry,
             )
     Returns @geometries TABLE 
     (
       gid  integer,
       sid  integer,
       geom geometry
     )  
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function calls STExtract with @p_sub_geom set to 2.
    This ensures all possible elements and subelements of a geometry are extracted.
</pre>
<p class="item_name">NOTES</p>
<pre>    This version is for versions of SQL Server from 2012 onwards.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Polygon or Multipolygon geometry object.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT t.gid, t.sid, t.geom.STAsText() as geom
      FROM [$(owner)].[STExplode] (
    GEOMETRY::STGeomFromText (
    'CURVEPOLYGON(
      COMPOUNDCURVE(
       (0 -23.43778, 0 23.43778),
       CIRCULARSTRING(0 23.43778, -45 23.43778, -90 23.43778), 
       (-90 23.43778, -90 -23.43778),
       CIRCULARSTRING(-90 -23.43778, -45 -23.43778, 0 -23.43778)
      )
    )',0)) as t;
    GO
    
    gid sid geom
    --- --- -------------------------------------------
      1   1 LINESTRING (0 -23.43778, 0 23.43778)
      1   2 CIRCULARSTRING (0 23.43778, -45 23.43778, -90 23.43778)
      1   3 LINESTRING (-90 23.43778, -90 -23.43778)
      1   4 CIRCULARSTRING (-90 -23.43778, -45 -23.43778, 0 -23.43778)
</pre>
<p class="item_name">RESULT</p>
<pre>    Array of subelements:
    gid  - Geometry Identifier (for multigeomemtry objects, the individual high level geometry objects it describes).
    sid  - Sub Element Identifier
    geom - Geometry representation of subelement.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan 2013 - Original coding.
    Simon Greener - Jan 2015 - Port to TSQL SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo85"></a>
<a name="GEOPROCESSING2fSTExtract2028200829"></a>
<h1>86.  GEOPROCESSING/STExtract (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STExtract -- Extracts the subelements that describe the input geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STExtract] (
               @p_geometry geometry,
               @p_sub_geom int = 0
             )
     Returns @geometries TABLE 
     (
       gid  integer,
       sid  integer,
       geom geometry
     )  
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function allows a user to extract the subelements of the supplied geometry.
    Some geometries have no subelements: eg Point, LineString
    The subelements of a geometry change depending on the geometry type: 
      1. A MultiPoint only has one or more Point subelements; 
      2. A MultiLineString only more than one LineString subelements; 
      3. A Polygon has zero one or more inner rings and only one outer ring;
      4. A MultiPolygon has zero one or more inner rings and one or more outer rings;
    Some subelements can have subelements when they are Compound:
      1. A CircularCurve can be described by one or more three point circular arcs.
    If @p_sub_geom is set to 1, any subelements of a subelement are extracted.
</pre>
<p class="item_name">NOTES</p>
<pre>    This version is for SQL Server 2008 only.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Polygon or Multipolygon geometry object.
    @p_sub_geom    (float) - Extract elements (individual circular arcs) of a compound subelement.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT t.*
      FROM [$(owner)].[STExtract](geometry::STGeomFromText('POLYGON((0 0,20 0,20 20,0 20,0 0),(10 10,10 11,11 11,11 10,10 10),(5 5,5 7,7 7,7 5,5 5))',0),0).AsTextZM() as t
    GO
</pre>
<p class="item_name">RESULT</p>
<pre>    Array of subelements:
    gid  - Geometry Identifier (for multigeomemtry objects, the individual high level geometry objects it describes).
    sid  - Sub Element Identifier
    geom - Geometry representation of subelement.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan 2013 - Original coding.
    Simon Greener - Jan 2015 - Port to TSQL SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo86"></a>
<a name="GEOPROCESSING2fSTExtract2028201229"></a>
<h1>87.  GEOPROCESSING/STExtract (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STExtract -- Extracts the subelements that describe the input geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STExtract] (
               @p_geometry geometry,
               @p_sub_geom int = 0
             )
     Returns @geometries TABLE 
     (
       gid  integer,
       sid  integer,
       geom geometry
     )  
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function allows a user to extract the subelements of the supplied geometry.
    Some geometries have no subelements: eg Point, LineString
    The subelements of a geometry change depending on the geometry type: 
      1. A MultiPoint only has one or more Point subelements; 
      2. A MultiLineString only more than one LineString subelements; 
      3. A Polygon has zero one or more inner rings and only one outer ring;
      4. A MultiPolygon has zero one or more inner rings and one or more outer rings;
    Some subelements can have subelements when they are Compound:
      1. A CircularCurve can be described by one or more three point circular arcs.
    If @p_sub_geom is set to 0, only single geometry elements of a multi geometry are extracted.
    If @p_sub_geom is set to 1, any subelements (eg ring) of a geometry (eg polygon) are extracted.
    If @p_sub_geom is set to 2, any subelements (CIRCULARSTRING) of a subelement (COMPOUNDCURVE) are extracted.
</pre>
<p class="item_name">NOTES</p>
<pre>    This version is for versions of SQL Server from 2012 onwards.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Polygon or Multipolygon geometry object.
    @p_sub_geom    (float) - Extract elements (individual circular arcs) of a compound subelement.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT e.gid, sid, geom.AsTextZM() as egeom
      FROM [$(owner)].[STExtract] (
                 geometry::STGeomFromText('GEOMETRYCOLLECTION (POLYGON ((100 200, 180 300, 100 300, 100 200)), LINESTRING (100 200, 100 75), POINT (100 0))',0),0) as e;
    GO
    gid sid egeom
    --- --- ----------------------------------------------
      1   0 POLYGON ((100 200, 180 300, 100 300, 100 200))
      2   0 LINESTRING (100 200, 100 75)
      3   0 POINT (100 0)

    SELECT e.gid, sid, geom.AsTextZM() as egeom
      FROM [$(owner)].[STExtract] (geometry::STGeomFromText('MULTILINESTRING((0 0,5 5,10 10,11 11,12 12),(100 100,200 200))',0),1) as e;
    GO
    gid sid egeom
    --- --- ------------------------------------------
      1   0 LINESTRING (0 0, 5 5, 10 10, 11 11, 12 12)
      2   0 LINESTRING (100 100, 200 200)

    SELECT e.gid, sid, geom.AsTextZM() as egeom
      FROM [$(owner)].[STExtract] (
              geometry::STGeomFromText('GEOMETRYCOLLECTION (COMPOUNDCURVE(CIRCULARSTRING (3 6.32, 0 7, -3 6.32),(-3 6.32, 0 0, 3 6.32)))',0),
               1
           ) as e;
    GO
    gid sid egeom
    --- --- -------------------------------------
      1   1 CIRCULARSTRING (3 6.32, 0 7, -3 6.32)
      1   2 LINESTRING (-3 6.32, 0 0)
      1   3 LINESTRING (0 0, 3 6.32)
</pre>
<p class="item_name">RESULT</p>
<pre>    Array of subelements:
    gid  - Geometry Identifier (for multigeomemtry objects, the individual high level geometry objects it describes).
    sid  - Sub Element Identifier
    geom - Geometry representation of subelement.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan 2013 - Original coding.
    Simon Greener - Jan 2015 - Port to TSQL SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo87"></a>
<a name="GEOPROCESSING2fSTExtractPolygon2028201229"></a>
<h1>88.  GEOPROCESSING/STExtractPolygon (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STExtractPolygon -- Extracts polygons from GeometryCollection
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STExtractPolygon] (
               @p_geometry geometry
             )
     Returns geometry 
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function allows a user to extract polygons from a GeometryCollection.
    Useful where result of an STIntersection between two polygons results in points, lines and polygons.
    If input is already a polygon it is returned unchanged.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - CurvePolygon, Polygon, MultiPolygon or GeometryCollection geometry objects.
</pre>
<p class="item_name">NOTES</p>
<pre>    Depends on STExtract.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    -- Result of STIntersection() between two overlapping polygons can result in points, lines and polygons.
    -- Extract only polygons...
    WITH data As (
    SELECT geometry::STGeomFromText('POLYGON ((100.0 0.0, 400.0 0.0, 400.0 480.0, 160.0 480.0, 160.0 400.0, 240.0 400.0,240.0 300.0, 100.0 300.0, 100.0 0.0))',0) as geoma,
           geometry::STGeomFromText('POLYGON ((-175.0 0.0, 100.0 0.0, 0.0 75.0, 100.0 75.0, 100.0 200.0, 200.0 325.0, 200.0 525.0, -175.0 525.0, -175.0 0.0))',0) as geomb
    )
    SELECT CAST('POLY A' as varchar(12)) as source, d.geoma.AsTextZM() as geoma from data as d
    union all
    SELECT 'POLY B' as source, d.geomb.AsTextZM() as geomb from data as d
    union all
    SELECT 'Intersection' as source, d.geoma.STIntersection(d.geomb).AsTextZM() as geom FROM data as d
    union all
    SELECT 'RESULT' as source, [$(owner)].[STExtractPolygon](d.geoma.STIntersection(d.geomb)).AsTextZM() as geom FROM data as d;
    GO
    source       geoma
    ------------ -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    POLY A       POLYGON ((100 0, 400 0, 400 480, 160 480, 160 400, 240 400, 240 300, 100 300, 100 0))
    POLY B       POLYGON ((-175 0, 100 0, 0 75, 100 75, 100 200, 200 325, 200 525, -175 525, -175 0))
    Intersection GEOMETRYCOLLECTION (POLYGON ((160 400, 200 400, 200 480, 160 480, 160 400)), POLYGON ((100 200, 180 300, 100 300, 100 200)), LINESTRING (100 200, 100 75), POINT (100 0))
    RESULT       MULTIPOLYGON (((160 400, 200 400, 200 480, 160 480, 160 400)), ((100 200, 180 300, 100 300, 100 200)))
</pre>
<p class="item_name">RESULT</p>
<pre>    (multi)polygon - Polygon or MultiPolygon object including CUrvePolygons..
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan 2013 - Original coding.
    Simon Greener - Jan 2015 - Port to TSQL SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo88"></a>
<a name="GEOPROCESSING2fSTFilterRings2028200829"></a>
<h1>89.  GEOPROCESSING/STFilterRings (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STFilterRings -- Removes rings from polygon/multipolygon below supplied area.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STFilterRings] (
               @p_geometry geometry,
               @p_area     float
             )
     Returns geometry 
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function allows a user to remove the inner rings of a polygon/multipolygon based on an area value.
    Will remove both outer and inner rings.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Polygon or Multipolygon geometry object.
    @p_area        (float) - Area in square SRID units below which an inner ring is removed.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT [$(owner)].[STFilterRings](geometry::STGeomFromText('POLYGON((0 0,20 0,20 20,0 20,0 0),(10 10,10 11,11 11,11 10,10 10),(5 5,5 7,7 7,7 5,5 5))',0),2).AsTextZM() as geom
    GO
    geom
    ------------------------------------------------------------------
    POLYGON ((0 0, 20 0, 20 20, 0 20, 0 0), (5 5, 5 7, 7 7, 7 5, 5 5))
</pre>
<p class="item_name">RESULT</p>
<pre>    (multi)polygon (geometry) -- Input geometry with rings possibly filtered out.
</pre>
<p class="item_name">NOTES</p>
<pre>    Depends on STExtract function.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan 2013 - Original coding.
    Simon Greener - Jan 2015 - Port to TSQL SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo89"></a>
<a name="GEOPROCESSING2fSTFlipVectors2028200829"></a>
<h1>90.  GEOPROCESSING/STFlipVectors (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STFlipVectors - Turns linestring and polygon rings into vectors and then flips each vector until all point in the same direction.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STFlipVectors (
       @p_geometry geometry
    )
     Returns geometry
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    With gc As (
    select geometry::STGeomFromText(
    'GEOMETRYCOLLECTION(
    POLYGON((10 0,20 0,20 20,10 20,10 0)),
    POLYGON((20 0,30 0,30 20,20 20,20 0)),
    POINT(0 0))',0) as geom
    )
    select v.sx,v.sy,v.ex,v.ey,count(*)
      from gc as a
           cross apply
           [$(owner)].[STVectorize] (
             [$(owner)].[STFlipVectors] ( a.geom )
           ) as v
     group by v.sx,v.sy,v.ex,v.ey
    go
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function extracts all vectors from supplied linestring/polygon rings, and then flips each vector until all point in the same direction.
    This function is useful for such operations as finding "slivers" between two polygons that are supposed to share a boundary.
    Once the function has flipped the vectors the calling function can analyse the vectors to do things like find duplicate segment
    which are part of a shared boundaries that are exactly the same (no sliver).
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Any geometry containing linestrings.
  RETURN
    geometry (GeometryCollection) - The set of flipped vectors.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - August 2018 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo90"></a>
<a name="GEOPROCESSING2fSTOneSidedBuffer2028201229"></a>
<h1>91.  GEOPROCESSING/STOneSidedBuffer (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STOneSidedBuffer -- Creates a square buffer to left or right of a linestring.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STOneSidedBuffer (
                @p_linestring      geometry,
                @p_buffer_distance Float, 
                @p_square          int = 1, 
                @p_round_xy        int = 3,
                @p_round_zm        int = 2
             )
     Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function creates a square buffer to left or right of a linestring.
    To create a buffer to the LEFT of the linestring (direction start to end) supply a negative @p_buffer_distance; 
    a +ve value will create a buffer on the right side of the linestring.
    Square ends can be created by supplying a positive value to @p_square parameter. 
    A value of 0 will create a rounded end at the start or end point.
    Where the linestring either crosses itself or starts and ends at the same point, the result may not be as expected.
    The final geometry will have its XY ordinates rounded to @p_round_xy of precision.
    Support for Z and M ordinates is experimental: where supported the final geometry has its ZM ordinates rounded to @p_round_zm of precision.
</pre>
<p class="item_name">NOTES</p>
<pre>    Supports circular strings and compoundCurves.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring (geometry) - Must be a linestring geometry.
    @p_distance   (float)    - if &lt; 0 then left side buffer; if &gt; 0 then right sided buffer.
    @p_square     (int)      - 0 = no (round mitre); 1 = yes (square mitre)
    @p_round_xy   (int)      - Rounding factor for XY ordinates.
    @p_round_zm   (int)      - Rounding factor for ZM ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    polygon       (geometry) - Result of one sided buffering of a linestring.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan 2013 - Original coding (Oracle).
    Simon Greener - Nov 2017 - Original coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo91"></a>
<a name="GEOPROCESSING2fSTParallel2028201229"></a>
<h1>92.  GEOPROCESSING/STParallel (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STParallel -- Creates a line at a fixed offset from the input line.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STParallel (
               @p_linestring geometry,
               @p_distance   float, 
               @p_round_xy   int = 3,
               @p_round_zm   int = 2
             )
     Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function creates a parallel line at a fixed offset to the supplied line.
    To create a line on the LEFT of the linestring (direction start to end) supply a negative @p_distance; 
    a +ve value will create a line on the right side of the linestring.
    Where the linestring either crosses itself or starts and ends at the same point, the result may not be as expected.
    The final geometry will have its XY ordinates rounded to @p_round_xy of precision.
    Support for Z and M ordinates is experimental: where supported the final geometry has its ZM ordinates rounded to @p_round_zm of precision.
</pre>
<p class="item_name">NOTES</p>
<pre>    Supports simple linestrings, circular strings and compoundCurves (not multilinestrings).
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring (geometry) - Must be a linestring geometry.
    @p_distance   (float)    - if &lt; 0 then linestring is created on left side of original; if &gt; 0 then offset linestring it to right side of original.
    @p_round_xy   (int)      - Rounding factor for XY ordinates.
    @p_round_zm   (int)      - Rounding factor for ZM ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    linestring    (geometry) - On left or right side of supplied line at required distance.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan 2013 - Original coding (Oracle).
    Simon Greener - Nov 2017 - Original coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo92"></a>
<a name="GEOPROCESSING2fSTParallelSegment2028201229"></a>
<h1>93.  GEOPROCESSING/STParallelSegment (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STParallelSegment -- Creates a line at a fixed offset from the input 2 point LineString or 3 point CircularString.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STParallelSegment (
               @p_linestring geometry,
               @p_offset     float, 
               @p_round_xy   int = 3,
               @p_round_zm   int = 2
             
     Returns geometry
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    WITH data AS (
     SELECT geometry::STGeomFromText('CIRCULARSTRING (3 6.3 1.1 0, 0 7 1.1 3.1, -3 6.3 1.1 9.3)',0) as segment
     UNION ALL
     SELECT geometry::STGeomFromText('LINESTRING (-3 6.3 1.1 9.3, 0 0 1.4 16.3)',0) as segment
  )
  SELECT 'Before' as text, d.segment.AsTextZM() as rGeom from data as d
  UNION ALL
  SELECT 'After' as text, [$(owner)].STParallelSegment(d.segment,1,3,2).AsTextZM() as rGeom from data as d;
  GO
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function creates a parallel line at a fixed offset to the supplied 2 point LineString or 3 point CircularString.
    To create a line on the LEFT of the segment (direction start to end) supply a negative @p_distance; 
    a +ve value will create a line on the right side of the segment.
    The final geometry will have its XY ordinates rounded to @p_round_xy of precision, and its ZM ordinates rounded to @p_round_zm of precision.
</pre>
<p class="item_name">NOTES</p>
<pre>    A Segment is defined as a simple two point LineString geometry or three point CircularString geometry. 
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring  (geometry) - Must be a simple LineString or CircularString.
    @p_offset         (float) - if &lt; 0 then linestring is created on left side of original; if &gt; 0 then offset linestring it to right side of original.
    @p_round_xy         (int) - Rounding factor for XY ordinates.
    @p_round_zm         (int) - Rounding factor for ZM ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    offset segment (geometry) - On left or right side of supplied segment at required distance.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan 2013 - Original coding (Oracle).
    Simon Greener - Nov 2017 - Original coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo93"></a>
<a name="GEOPROCESSING2fSTSegmentize202812e029"></a>
<h1>94.  GEOPROCESSING/STSegmentize (1.0) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STSegmentize - Extracts 2 point linestring or 3 point CircularString segments/vectors from non-point geometry objects.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>   Function STSegmentize (
       @p_geometry  geometry 
    )
    Returns @Vector Table (
      id             int,
      element_id     int,
      subelement_id  int,
      segment_id     int,
      sx             float,  
      sy             float,
      sz             float,
      sm             float,
      mx             float,  
      my             float,
      mz             float,
      mm             float,
      ex             float, 
      ey             float,
      ez             float,
      em             float,
      length         float,
      geom           geometry
    )  
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function is the same as STVectorize.
    This function segments the supplied geometry into 2-point linestrings or 3 point CircularStrings. 
    The returned data includes all the metadata about the segmented linestring:
    - Segment identifiers (ie from 1 through n);
    - Start/Mid/End Coordinates as ordinates;
    - Length of vector.
    - Geometry representation of segment.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Any non-point geometry object
</pre>
<p class="item_name">RESULT</p>
<pre>    Table (Array) of Segments:
     id             (int)      - Unique identifier starting at segment 1.
     element_id     (int)      - Top level element identifier eg 1 for first polygon in multiPolygon.
     subelement_id  (int)      - SubElement identifier of subelement of element with parts eg OuterRing of Polygon
     segment_id     (int)      - Unique identifier for all segments of a specific element.
     sx             (float)    - Start Point X Ordinate 
     sy             (float)    - Start Point Y Ordinate 
     sz             (float)    - Start Point Z Ordinate 
     sm             (float)    - Start Point M Ordinate
     mx             (float)    - Mid Point X Ordinate (Only if CircularString)
     my             (float)    - Mid Point Y Ordinate (Only if CircularString)
     mz             (float)    - Mid Point Z Ordinate (Only if CircularString)
     mm             (float)    - Mid Point M Ordinate (Only if CircularString)
     ex             (float)    - End Point X Ordinate 
     ey             (float)    - End Point Y Ordinate 
     ez             (float)    - End Point Z Ordinate 
     em             (float)    - End Point M Ordinate 
     length         (float)    - Length of this segment in SRID units
     geom           (geometry) - Geometry representation of segment.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2008 - Original coding.
    Simon Greener - January 2017 - Support for Circular Curve objects and subobjects.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo94"></a>
<a name="GEOPROCESSING2fSTSquareBuffer2028201229"></a>
<h1>95.  GEOPROCESSING/STSquareBuffer (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STSquareBuffer -- Creates a square buffer to left or right of a linestring.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STSquareBuffer (
               @p_linestring      geometry,
               @p_buffer_distance Float, 
               @p_round_xy        int = 3,
               @p_round_zm        int = 2
             )
     Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function buffers a linestring creating a square mitre at the end where a normal buffer creates a round mitre.
    A value of 0 will create a rounded end at the start or end point.
    Where the linestring either crosses itself or starts and ends at the same point, the result may not be as expected.
    The final geometry will have its XY ordinates rounded to @p_round_xy of precision.
    Support for Z and M ordinates is experimental: where supported the final geometry has its ZM ordinates rounded to @p_round_zm of precision.
     -- Simple Linestring
     with data as (
     select geometry::STGeomFromText('LINESTRING(0 0,5 0,5 10)',0) as linestring
     )
     select [$(owner)].[STSquareBuffer](a.linestring,-5.0,3,2).AsTextZM() as sqBuff from data as a
     GO
     sqBuff
     ---------------------------------------------
     POLYGON ((0 -15, 10 -15, 10 15, 0 15, 0 -15))
</pre>
<p class="item_name">NOTES</p>
<pre>    Supports circular strings and compoundCurves.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_linestring (geometry) - Must be a linestring geometry.
    @p_distance      (float) - Buffer distance.
    @p_round_xy        (int) - Rounding factor for XY ordinates.
    @p_round_zm        (int) - Rounding factor for ZM ordinates.
</pre>
<p class="item_name">RESULT</p>
<pre>    polygon       (geometry) - Result of square buffering a linestring.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Jan 2013 - Original coding (Oracle).
    Simon Greener - Nov 2017 - Original coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo95"></a>
<a name="GEOPROCESSING2fSTVectorize2028200829"></a>
<h1>96.  GEOPROCESSING/STVectorize (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STVectorize - Dumps all vertices of supplied geometry object to ordered array.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>   Function STVectorize (
       @p_geometry  geometry 
    )
    Returns @Vector Table (
      id             int,
      element_id     int,
      subelement_id  int,
      vector_id      int,
      sx             float,  
      sy             float,
      sz             float,
      sm             float,
      mx             float,  
      my             float,
      mz             float,
      mm             float,
      ex             float, 
      ey             float,
      ez             float,
      em             float,
      length         float,
      geom           geometry
    )  
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT e.[id], e.[element_id], e.[subelement_id], e.[vector_id], 
           e.[sx], e.[sy], e.[ex], e.[ey], 
           e.length, geom.STAsText() as geomWKT
     FROM [$(owner)].[STVectorize] (geometry::STGeomFromText(
          'MULTIPOLYGON( ((200 200, 400 200, 400 400, 200 400, 200 200)),
                         ((0 0, 100 0, 100 100, 0 100, 0 0),(40 40,60 40,60 60,40 60,40 40)) )',0)) as e
    GO
    id element_id subelement_id vector_id sx  sy  ex  ey  length geomWKT
    -- ---------- ------------- --------- --  --  --  --  ------ -------
     1 1          1             1         200 200 400 200 200    LINESTRING (200 200, 400 200)
     2 1          1             2         400 200 400 400 200    LINESTRING (400 200, 400 400)
     3 1          1             3         400 400 200 400 200    LINESTRING (400 400, 200 400)
     4 1          1             4         200 400 200 200 200    LINESTRING (200 400, 200 200)
     5 2          1             1           0   0 100   0 100    LINESTRING (0 0, 100 0)
     6 2          1             2         100   0 100 100 100    LINESTRING (100 0, 100 100)
     7 2          1             3         100 100   0 100 100    LINESTRING (100 100, 0 100)
     8 2          1             4           0 100   0   0 100    LINESTRING (0 100, 0 0)
     9 2          2             1          40  40  60  40  20    LINESTRING (40 40, 60 40)
    10 2          2             2          60  40  60  60  20    LINESTRING (60 40, 60 60)
    11 2          2             3          60  60  40  60  20    LINESTRING (60 60, 40 60)
    12 2          2             4          40  60  40  40  20    LINESTRING (40 60, 40 40)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function segments the supplied geometry into 2-point linestrings or 3 point CircularStrings. 
    The returned data includes all the metadata about the segmented linestring:
    - Segment identifiers (ie from 1 through n);
    - Start/Mid/End Coordinates as ordinates;
    - Length of vector.
    - Geometry representation of segment.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Any non-point geometry object
</pre>
<p class="item_name">RESULT</p>
<pre>    Table (Array) of Vectors:
     id             (int)      - Unique identifier starting at segment 1.
     element_id     (int)      - Top level element identifier eg 1 for first polygon in multiPolygon.
     subelement_id  (int)      - SubElement identifier of subelement of element with parts eg OuterRing of Polygon
     vector_id      (int)      - Unique identifier for all segments of a specific element.
     sx             (float)    - Start Point X Ordinate 
     sy             (float)    - Start Point Y Ordinate 
     sz             (float)    - Start Point Z Ordinate 
     sm             (float)    - Start Point M Ordinate
     mx             (float)    - Mid Point X Ordinate (Only if CircularString)
     my             (float)    - Mid Point Y Ordinate (Only if CircularString)
     mz             (float)    - Mid Point Z Ordinate (Only if CircularString)
     mm             (float)    - Mid Point M Ordinate (Only if CircularString)
     ex             (float)    - End Point X Ordinate 
     ey             (float)    - End Point Y Ordinate 
     ez             (float)    - End Point Z Ordinate 
     em             (float)    - End Point M Ordinate 
     length         (float)    - Length of this segment in SRID units
     geom           (geometry) - Geometry representation of segment.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2008, Original Coding; January 2017 - Support for Circular Curve objects and subobjects.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2017 by TheSpatialDBAdvisor/Simon Greener
    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo96"></a>
<a name="GEOPROCESSING2fSTVertices2028200829"></a>
<h1>97.  GEOPROCESSING/STVertices (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STVertices - Dumps all vertices of supplied geometry object to ordered array.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>   Function STVertices (
       @p_geometry  geometry 
    )
    Returns @Points Table (
      uid int,
      pid int,
      mid int,
      x   float,  
      y   float,
      z   float,
      m   float
    )  
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT e.[uid], e.[mid], e.[rid], e.[pid], e.[x], e.[y], e.[z], e.[m]
      FROM [$(owner)].[STVertices] (
             geometry::STGeomFromText(
               'MULTIPOLYGON( ((200 200, 400 200, 400 400, 200 400, 200 200)),
                              ((0 0, 100 0, 100 100, 0 100, 0 0),(40 40,60 40,60 60,40 60,40 40)) )',0)
           ) as e
    GO
    uid mid rid pid   x   y    z    m
      1   1   1   1 200 200 NULL NULL
      2   1   1   2 400 200 NULL NULL
      3   1   1   3 400 400 NULL NULL
      4   1   1   4 200 400 NULL NULL
      5   1   1   5 200 200 NULL NULL
      6   2   1   1   0   0 NULL NULL
      7   2   1   2 100   0 NULL NULL
      8   2   1   3 100 100 NULL NULL
      9   2   1   4   0 100 NULL NULL
     10   2   1   5   0   0 NULL NULL
     11   2   2   1  40  40 NULL NULL
     12   2   2   2  60  40 NULL NULL
     13   2   2   3  60  60 NULL NULL
     14   2   2   4  40  60 NULL NULL
     15   2   2   5  40  40 NULL NULL
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function extracts the fundamental points that describe a geometry object.
    The points are returning in the order they appear in the geometry object.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Any non-point geometry object
</pre>
<p class="item_name">RESULT</p>
<pre>    Table (Array) of Points :
     uid (int)   - Point identifier unique across the whole geometry object.
     pid (int)   - Point identifier with element/subelement (1 to Number of Points in element).
     mid (int)   - Unique identifier that describes the geometry object's multipart elements (eg linestring in MultiLineString).
     rid (int)   - SubElement or Ring identifier.
     x   (float) - Start Point X Ordinate 
     y   (float) - Start Point Y Ordinate 
     z   (float) - Start Point Z Ordinate 
     m   (float) - Start Point M Ordinate
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2008 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo97"></a>
<a name="INSPECT2fSTCoordDim2028200829"></a>
<h1>98.  INSPECT/STCoordDim (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STCoordDim -- Function that returns the coordinate dimension of a geometry point.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STCoordDim (
               @p_point geometry,
             )
     Returns int 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STCoordDim (
             STPointFromText('POINT(0 0)',0)
           ).AsTextZM() as coordDim;
    # coordDim
    2
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function returns the coordinate dimension of a geometry point.
    If only XY ordinates, 2 is returned.
    If only XYZ or XYM ordinates, 3 is returned.
    If XYZM ordinates, 4 is returned.
</pre>
<p class="item_name">NOTES</p>
<pre>    Whether an ordinate exists is determined by whether it has a non-null value.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_point (geometry) - Supplied point geometry.
</pre>
<p class="item_name">RESULT</p>
<pre>    dimensionality (int) - 2,3 or 4.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Spatial.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo98"></a>
<a name="INSPECT2fSTCoordDim2028201229"></a>
<h1>99.  INSPECT/STCoordDim (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STCoordDim -- Function that returns the coordinate dimension of a  geometry point.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STCoordDim (
               @p_point geometry,
             )
     Returns int 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STCoordDim (
             STPointFromText('POINT(0 0)',0)
           ) as coordDim;
    # coordDim
    2
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function returns the coordinate dimension of a geometry point.
    If only XY ordinates, 2 is returned.
    If only XYZ or XYM ordinates, 3 is returned.
    If XYZM ordinates, 4 is returned.
</pre>
<p class="item_name">NOTES</p>
<pre>    Uses HasZ and HasM extended methods to determine whether an ordinate exists.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_point (geometry) - Supplied point geometry.
</pre>
<p class="item_name">RESULT</p>
<pre>    dimensionality (int) - 2,3 or 4.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Spatial.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo99"></a>
<a name="INSPECT2fSTDetermine2028200829"></a>
<h1>100.  INSPECT/STDetermine (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>   STDetermine - Determines all possible spatial relations between two geometry instances.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STDetermine]
             (
               @p_geometry1 geometry,
               @p_geometry2 geometry
             )
      Return varchar(500)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Compares the first geometry against the second using all the instance comparison methods, 
    returning a comma separated string containing tokens representing each method: STContains -&gt; CONTAINS.
    Methods and returned Strings are:
     STDisjoint   -&gt; DISJOINT
     STEquals     -&gt; EQUALS
     STContains   -&gt; CONTAINS
     STCrosses    -&gt; CROSSES
     STOverlaps   -&gt; OVERLAPS
     STTouches    -&gt; TOUCHES
     STIntersects -&gt; INTERSECTS
    So if two polygons overlap each othre, a string containing "OVERLAPS" will be returned (see Example).
    Or is a point lies inside a polygon the "CONTAINS" relationship would be returned (see Example); 
    Two lines that meet at a start/end point will return "TOUCHES".
    Note that in all the cases above, "INTERSECTS" is always returned as a catch-all relationship: it always appears at the end of the returned string. 
    If two geometry objects are equal or disjoint a string containing only "EQUALS" or "DISJOINT" is returned.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry1 (geometry) - Non-null geometry instance.
    @p_geometry2 (geometry) - Non-null geometry instance.
</pre>
<p class="item_name">RESULT</p>
<pre>    relations found (varchar) - Comma separated string containing tokens representing each method: STContains -&gt; CONTAINS.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    Select [$(owner)].[STDetermine] ( 
             geometry::STGeomFromText('POLYGON ((100.0 0.0, 400.0 0.0, 400.0 480.0, 160.0 480.0, 160.0 400.0, 240.0 400.0,240.0 300.0, 100.0 300.0, 100.0 0.0))',0),
             geometry::STGeomFromText('POLYGON ((-175.0 0.0, 100.0 0.0, 0.0 75.0, 100.0 75.0, 100.0 200.0, 200.0 325.0, 200.0 525.0, -175.0 525.0, -175.0 0.0))',0)
           ) as relations;
    go
    relations
    -------------------
    OVERLAPS,INTERSECTS

    Select [$(owner)].[STDetermine] ( 
             geometry::STGeomFromText('LINESTRING (100.0 0.0, 400.0 0.0)',0),
             geometry::STGeomFromText('LINESTRING (90.0 0.0, 100.0 0.0)',0)
     ) as relations;
    go
    relations
    -------------------
    TOUCHES,INTERSECTS

    Select [$(owner)].[STDetermine] ( 
             geometry::STGeomFromText('POLYGON ((100.0 0.0, 400.0 0.0, 400.0 480.0, 160.0 480.0, 160.0 400.0, 240.0 400.0,240.0 300.0, 100.0 300.0, 100.0 0.0))',0) ,
             geometry::STPointFromText('POINT (250 150)',0)
           ) as relations;
    go
    relations
    -------------------
    CONTAINS,INTERSECTS

    Select [$(owner)].[STDetermine] ( 
             geometry::STPointFromText('POINT (250 150)',0),
             geometry::STPointFromText('POINT (250 150)',0)
           ) as relations;
    go
    relations
    -------------------
    EQUALS
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2018 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo100"></a>
<a name="INSPECT2fSTEndPoint2028200829"></a>
<h1>101.  INSPECT/STEndPoint (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STEndPoint - Function which returns last point in supplied geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STEndPoint (
                @p_geometry geometry
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STEndPoint (
             ST_GeomFromText('LINESTRING(0.1 0.2,1.4 45.2)',0)
           ).STAsText() as endPoint;
    # endPoint
    'POINT(1.4 45.2)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that returns last point in the supplied geometry.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - supplied geometry of any type.
</pre>
<p class="item_name">RESULT</p>
<pre>    point      (geometry) - Last point in Geometry
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo101"></a>
<a name="INSPECT2fSTEquals2028201229"></a>
<h1>102.  INSPECT/STEquals (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STEquals -- Checks if all XYZM ordinates of two points are equal.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STEquals] (
               @p_point1   geometry,
               @p_point2   geometry,
               @p_round_xy int   = 3,
               @p_round_z  int   = 2,
               @p_round_m  int   = 2
             )
     Returns geometry 
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Standqard STIsEquals() function only processes XY ordinates of a point.
    This function checks XY but also Z and M.
    Decimal digits of precision are used in the comparison.
    The input geometry objects must conform to the following:
      1. Both must be of geometry type point
      2. Both must have the same SRID
      3. Both must have the same Coordinate Dimension ie XYZ=XYZ, XYM=XYM or XYZM=XYZM. 
    It is up to the caller to ensure these conditions are met.
</pre>
<p class="item_name">ARGUMENTS</p>
<pre>    @p_point1   (geometry) - Point geometry possibly with elevation (Z) and measures (M).
    @p_point2   (geometry) - Point geometry possibly with elevation (Z) and measures (M).
    @p_round_xy      (int) - Decimal degrees of precision to which calculated XY ordinates are rounded.
    @p_round_z       (int) - Decimal degrees of precision to which Z ordinates are compared.
    @p_round_m       (int) - Decimal degrees of precision to which M ordinates are compared.
</pre>
<p class="item_name">RESULT</p>
<pre>    1/0              (bit) - True is 1 and False is 0
</pre>
<p class="item_name">NOTES</p>
<pre>    Supports Linestrings with CircularString elements.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January 2018 - Original Coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo102"></a>
<a name="INSPECT2fSTGeometryTypes2028201229"></a>
<h1>103.  INSPECT/STGeometryTypes (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STGeometryTypes -- Extracts all geometry type keywords from a geometry (and its sub-elements)
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STGeometryTypes](
               @p_geometry geometry
             )
      Returns geometry
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns list of geometry types (from OGC STGeometryType function)
    that describe the contents of the passed in geometry.
    All complex geometries are "exploded" to extract sub element geometry types
    Geography objects can be processed by converting to geometry using
    dbo.STToGeometry() function. 
</pre>
<p class="item_name">ARGUMENTS</p>
<pre>    @p_geometry (geometry) - Any valid geomtery
</pre>
<p class="item_name">RESULT</p>
<pre>    string -- list of geometry types are appear (in order) in geometry.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    -- Simple geometry
    select dbo.[STGeometryTypes](geometry::STGeomFromText('POINT(0 1 2)',0)) as gtypes;
    go
    gtypes
    POINT

    -- Single CurvePolygon with one interior ring
    select [$(owner)].[STGeometryTypes](geometry::STGeomFromText('CURVEPOLYGON(CIRCULARSTRING(0 5, 5 0, 0 -5, -5 0, 0 5), (-2 2, 2 2, 2 -2, -2 -2, -2 2))',0)) as gtypes;
    GO
    gtypes
    CURVEPOLYGON,CIRCULARSTRING

    -- GeometryCollection
    select  [$(owner)].[STGeometryTypes](
    geometry::STGeomFromText(
             'GEOMETRYCOLLECTION(
                      LINESTRING(0 0,20 0,20 20,0 20,0 0), 
                      CURVEPOLYGON(
                           COMPOUNDCURVE(
                                   (0 -23.43778, 0 23.43778),
                                   CIRCULARSTRING(0 23.43778, -45 23.43778, -90 23.43778),
                                   (-90 23.43778, -90 -23.43778),
                                   CIRCULARSTRING(-90 -23.43778, -45 -23.43778, 0 -23.43778))), 
                      COMPOUNDCURVE(
                              CIRCULARSTRING(-90 -23.43778, -45 -23.43778, 0 -23.43778), 
                              (0 -23.43778, 0 23.43778)))',0)) as gTypes;
    GO
    gTypes
    GEOMETRYCOLLECTION,LINESTRING,CURVEPOLYGON,COMPOUNDCURVE,CIRCULARSTRING,CIRCULARSTRING,COMPOUNDCURVE,CIRCULARSTRING
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - April 2019 - SQL Server Spatial
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2005-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo103"></a>
<a name="INSPECT2fSTIsPseudoMultiCurve2028201229"></a>
<h1>104.  INSPECT/STIsPseudoMultiCurve (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STIsPseudoMultiCurve -- Checks if supplied @p_geometry is a GeometryCollection object containing only LineString, CircularString and CompoundCurve elements.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STIsPseudoMultiCurve] (
       @p_geometry geometry
    )
    Returns bit
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function checks if the supplied @p_geometry is a GeometryCollection object containing only LineString, CircularString and CompoundCurve elements.

    One cannot create a MultiLineString object where an element is a CircularString or CompoundCurve.

    Any attempt to do so causes the GeometryType to be set to GeometryCollection rather than MultiLineString or MultiCurve.

    If these sorts of GeometryCollection objects are not supported, it is impossible to represent a MultiLine object with a mix of CircularCurve and LineString types.

    Function returns 1 (true) if provided geometry is a pseudo MultiCurve (or MultiLineString)
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - GeometryCollection or MultiLineString.
</pre>
<p class="item_name">RESULT</p>
<pre>    1/0              (bit) - 1 (true) if pseudo MultiCurve, 0 (false) otherwise.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    -- This is how SQL Server merges a LineString and a CircularString that do not touch
    -- 
    SELECT geometry::STGeomFromText('LINESTRING(0 0 0 5.6, 5 5 0 6.3,5 10 0 9.6)',0)
           .STUnion(
             geometry::STGeomFromText('CIRCULARSTRING(-0.5 -0.5 0 5.6,-0.2 -0.4 0 5.5, -0.1 -0.1 0 5.65)',0)
           ).AsTextZM() as MultiCurve;
    GO

    MultiCurve
    --------------------------------------------------------------------------------------------------
    GEOMETRYCOLLECTION (LINESTRING (5 10, 5 5, 0 0), CIRCULARSTRING (-0.5 -0.5, -0.2 -0.4, -0.1 -0.1))

    -- Note that STUnion removes Z and M ordinates

    -- Now put result through STIsPseudoMultiCurve
    -- 
    SELECT [$(owner)].STIsPseudoMultiCurve ( geometry::STGeomFromText('GEOMETRYCOLLECTION (LINESTRING (5 10, 5 5, 0 0), CIRCULARSTRING (-0.5 -0.5, -0.2 -0.4, -0.1 -0.1))',0)) as isMultiCurve
    GO

    isMultiCurve
    ------------
    1
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - January  2018 - Original coding for SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo104"></a>
<a name="INSPECT2fSTNumDims2028201229"></a>
<h1>105.  INSPECT/STNumDims (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STCoordDim -- Function that returns the coordinate dimension of a geometry object.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STNumDims (
               @p_point geometry,
             )
     Returns int 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STNumDims] (
           ) as coordDim;
    coordDim
    3
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function processes geometry types other than a point (STCoordDim)
    If only XY ordinates, 2 is returned.
    If only XYZ or XYM ordinates, 3 is returned.
    If XYZM ordinates, 4 is returned.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Supplied geometry.
</pre>
<p class="item_name">RESULT</p>
<pre>    dimensionality (int) - 2,3 or 4.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original TSQL Coding for SQL Spatial.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo105"></a>
<a name="INSPECT2fSTNumRings2028201229"></a>
<h1>106.  INSPECT/STNumRings (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STNumRings -- Function that returns a count of the number of rings of the supplied polygon object.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STNumRings (
               @p_geometry geometry,
             )
     Returns int 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STNumRings](geometry::STGeomFromText('POLYGON((0 0,20 0,20 20,0 20,0 0),(10 10,10 11,11 11,11 10,10 10),(5 5,5 7,7 7,7 5,5 5))',0)) as numRings
    NumRings
    3
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function returns the number of rings describing the supplied polygon geometry object.
    Supports Polygon, MultiPolygon and CurvePolygon objects.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Supplied polygon geometry.
</pre>
<p class="item_name">RESULT</p>
<pre>    Number of Rings (int) - N where N = 1 or more.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2012 - Original TSQL Coding for SQL Spatial.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo106"></a>
<a name="INSPECT2fSTStartPoint2028200829"></a>
<h1>107.  INSPECT/STStartPoint (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    ST_Start_Point -- Function which returns first point in supplied geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STStartPoint (
                @p_geometry geometry
             )
     Returns geometry 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STStartPoint(
             ST_GeomFromText('LINESTRING(0.1 0.2,1.4 45.2)',0)
           ).STAsText() as startPoint;

    # startPoint
    'POINT(0.1 0.2)'
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that returns first point in supplied geometry.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - supplied geometry of any type.
</pre>
<p class="item_name">RESULT</p>
<pre>    point       (geometry) - First point in Geometry
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo107"></a>
<a name="MBR2fSTGeography2MBR2028200829"></a>
<h1>108.  MBR/STGeography2MBR (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STGeography2MBR - Returns lower left and upper right coordinates of supplied geography's Envelope.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STGeography2MBR (
       @p_geography geography
     )
     Returns @table TABLE 
     (
        minx Float,
        miny Float,
        maxx Float,
        maxy Float
     ) 
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT t.minx, t.miny, t.maxx, t.maxy
      FROM [$(owner)].[STGeography2MBR](geography::STGeogFromText('LINESTRING(0 0,0.1 0.1,0.5 0.5,0.8 0.8,1 1)',4326)) as t
    GO
    minx miny maxx maxy
    ---- ---- ---- ----
       0    0    1    1
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with a non-NULL geometry, this function returns the ordinates of the lower left and upper right corners of the geography's STEnvelope/MBR. 
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geography (ge-graphy) - Any geography object type.
</pre>
<p class="item_name">RESULT</p>
<pre>    Table (Array) of Floats
      minx (float) - X Ordinate of Lower Left Corner of Geography's MBR.
      miny (float) - Y Ordinate of Lower Left Corner of Geography's MBR.
      maxx (float) - X Ordinate of Upper Right Corner of Geography's MBR.
      maxy (float) - Y Ordinate of Upper Right Corner of Geography's MBR.
</pre>
<p class="item_name">NOTES</p>
<pre>    Uses [$(owner)].[STToGeometry]
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Aug 2008 - Converted to SQL Server 2008
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo108"></a>
<a name="MBR2fSTGeometry2MBR2028200829"></a>
<h1>109.  MBR/STGeometry2MBR (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STGeometry2MBR - Returns lower left and upper right coordinates of supplied geoemtry's Envelope.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STGeometry2MBR (
       @p_geometry geometry
     )
     Returns @table TABLE 
     (
        minx Float,
        miny Float,
        maxx Float,
        maxy Float
     ) 
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT t.minx, t.miny, t.maxx, t.maxy
      FROM [$(owner)].[STGeometry2MBR](geometry::STGeomFromText('LINESTRING(0 0,0.1 0.1,0.5 0.5,0.8 0.8,1 1)',0)) as t
    GO
    minx miny maxx maxy
    ---- ---- ---- ----
       0    0    1    1
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with a non-NULL geometry, this function returns the ordinates of the lower left and upper right corners of the geometries STEnvelope/MBR. 
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Any geometry object type.
</pre>
<p class="item_name">RESULT</p>
<pre>    Table (Array) of Floats
      minx (float) - X Ordinate of Lower Left Corner of Geometry MBR.
      miny (float) - Y Ordinate of Lower Left Corner of Geometry MBR.
      maxx (float) - X Ordinate of Upper Right Corner of Geometry MBR.
      maxy (float) - Y Ordinate of Upper Right Corner of Geometry MBR.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Aug 2008 - Converted to SQL Server 2008
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo109"></a>
<a name="MBR2fSTMBR2Geography2028200829"></a>
<h1>110.  MBR/STMBR2Geography (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMBR2Geography - Given lower left and upper right coordinates of geometry's envelope/mbr this function returns a 5 point polygon geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMBR2Geography (
       @p_minx     Float,
       @p_miny     Float,
       @p_maxx     Float,
       @p_maxy     Float
       @p_srid     Int,
       @p_round_ll int = 3 
     )
     Returns geometry
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT [$(owner)].[STMBR2Geography](0,0,1,1,0,3)',0)).STAsText() as polygon
    GO
    polygon
    POLYGON((0 0,1 0,1 1,0 1,0 0))
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Given lower left and upper right coordinates of geometry's envelope/mbr this function returns a 5 point polygon geometry.
    The resultant polygons XY ordinates are rounded to the supplied value. 
    The SRID should be a valid projected SRID.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_minx   (float) - X Ordinate of Lower Left Corner of Geography MBR.
    @p_miny   (float) - Y Ordinate of Lower Left Corner of Geography MBR.
    @p_maxx   (float) - X Ordinate of Upper Right Corner of Geography MBR.
    @p_maxy   (float) - Y Ordinate of Upper Right Corner of Geography MBR.
    @p_srid     (int) - Valid projected SRID.
    @p_round_ll (int) - Value used to round Latitude/Longitude ordinates to fixed decimal digits of precision.
</pre>
<p class="item_name">RESULT</p>
<pre>    @p_geometry (geometry) - Polygon geometry with single exterior ring.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Aug 2008 - Converted to SQL Server 2008
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo110"></a>
<a name="MBR2fSTMBR2Geometry2028200829"></a>
<h1>111.  MBR/STMBR2Geometry (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMBR2Geometry - Given lower left and upper right coordinates of geometry's envelope/mbr this function returns a 5 point polygon geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMBR2Geometry (
       @p_minx    Float,
       @p_miny    Float,
       @p_maxx    Float,
       @p_maxy    Float
       @p_srid     Int,
       @p_round_xy int = 3 
     )
     Returns geometry
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT [$(owner)].[STMBR2Geometry](0,0,1,1,0,3)',0)).STAsText() as polygon
    GO
    polygon
    POLYGON((0 0,1 0,1 1,0 1,0 0))
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Given lower left and upper right coordinates of geometry's envelope/mbr this function returns a 5 point polygon geometry.
    The resultant polygons XY ordinates are rounded to the supplied value. 
    The SRID should be a valid projected SRID.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_minx   (float) - X Ordinate of Lower Left Corner of Geometry MBR.
    @p_miny   (float) - Y Ordinate of Lower Left Corner of Geometry MBR.
    @p_maxx   (float) - X Ordinate of Upper Right Corner of Geometry MBR.
    @p_maxy   (float) - Y Ordinate of Upper Right Corner of Geometry MBR.
    @p_srid     (int) - Valid projected SRID.
    @p_round_xy (int) - Value used to round XY ordinates to fixed decimal digits of precision.
</pre>
<p class="item_name">RESULT</p>
<pre>    @p_geometry (geometry) - Polygon geometry with single exterior ring.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Aug 2008 - Converted to SQL Server 2008
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo111"></a>
<a name="MBR2fSTMBRLongestSide2028200829"></a>
<h1>112.  MBR/STMBRLongestSide (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMBRLongestSide - Returns length of shortest side of Envelope/MBR of supplied geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STMBRLongestSide] (
       @p_geometry geometry
     )
     Returns Float
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    with data as (
      select geometry::STGeomFromText('POLYGON ((0 0,100 0,100 10,0 10,0 0))',0) as geom
    )
    SELECT [$(owner)].[STMBRLongestSide] (a.geom) as length
      FROM data as a;
    GO

    length 
    ------
      10.0
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with a non-NULL geometry, this function returns the length of the longest side of its Envelope.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Any geometry object type.
</pre>
<p class="item_name">RESULT</p>
<pre>    length (float) - length of shortest side of envelope
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Oct 2019 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2019 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo112"></a>
<a name="MBR2fSTMBRShortestSide2028200829"></a>
<h1>113.  MBR/STMBRShortestSide (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMBRShortestSide - Returns length of shortest side of Envelope/MBR of supplied geometry.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function [$(owner)].[STMBRShortestSide] (
       @p_geometry geometry
     )
     Returns Float
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    with data as (
      select geometry::STGeomFromText('POLYGON ((0 0,100 0,100 10,0 10,0 0))',0) as geom
    )
    SELECT [$(owner)].[STMBRShortestSide] (a.geom) as length
      FROM data as a;
    GO

    length 
    ------
     100.0
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied with a non-NULL geometry, this function returns the length of the shortest side of its Envelope.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_geometry (geometry) - Any geometry object type.
</pre>
<p class="item_name">RESULT</p>
<pre>    length (float) - length of shortest side of envelope
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Oct 2019 - Original coding.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2019 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo113"></a>
<a name="SORT2fST5fMorton2028200829"></a>
<h1>114.  SORT/ST_Morton (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    ST_Morton -- Function which creates a Morton (Space) Key from a supplied point object.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function ST_Morton ( 
               @p_point geography
             )
     Returns int
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[ST_Morton](geography::Point(-34.53561,147.2320392,4326)) as mKey;
    mKey
    390
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that creates a Morton Key from a point's XY real world ordinates
    Implementation within a specific site is normally a constant based on a standard row/column division
    of the MBR of all the data within an organisation.
</pre>
<p class="item_name">NOTES</p>
<pre>    Could be rewritten with geometry @p_point and not geography.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_point (geometry) - Real world point whose XY ordinates are converted to Row/Col references.
</pre>
<p class="item_name">RESULT</p>
<pre>    morton_key  (float) - Single integer morton key value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2011 - Original Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo114"></a>
<a name="SORT2fSTMorton2028200829"></a>
<h1>115.  SORT/STMorton (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STMorton -- Function which creates a Morton (Space) Key from the supplied row and column reference.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STMorton ( 
               @p_col int,
               @p_row int  
             )
     Returns int
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT STMorton (10, 10) as mKey;
     # mKey
     828
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that creates a Morton Key from a row/col (grid) reference. 
    The generated value can be used to order/sort geometry objects.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_col      (int) - Grid Column Reference.
    @p_row      (int) - Grid Row Reference.
</pre>
<p class="item_name">RESULT</p>
<pre>    morton_key  (int) - single integer morton key.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Professor David M. Mark - January  1984 - C;
    Simon Greener           - December 2011 - Original Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo115"></a>
<a name="TOOLS2f5fSTArray2028200829"></a>
<h1>116.  TOOLS/_STArray (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    _STArray -- Base function for implementing arrays of geometry and geography.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function _STArray 
    (
       @p_array  xml,
       @p_i      int            = 1,
       @p_action varchar(10)    = 'select',
       @p_wkb    varbinary(max) = null, -- Ensures can save geometry and geography
       @p_srid   int            = 0
    )
    Returns xml 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[_STArray] (........) as result;
    Result
    &lt;Depends on @p_action&gt;
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function implements all the basic operations of an array of geometry/geography objects.
    XML is used for the implementation.
    The function is "hidden" due to the various methods returning different results eg count -&gt; integer; array[i] -&gt; srid,wkb.
    The @p_action methods are:
      insert : inserts geometry/geography into provided position @p_i in array.If @p_i exists, the position is updated.
      update : updates geometry/geography at @p_i position in array.
      delete : deleted geometry/geography at @p_i position in array.
      select : returns geometry/geography WKB and SRID at @p_i position in array.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_array  (xml)           : Array itself
    @p_i      (int)           : 1,
    @p_action (varchar 10)    : select, update, delete, insert
    @p_wkb    (varbinary max) : geometry/geography as WKB so can hold both object types.
    @p_srid   (int)           : SRID of @p_wkb. It is possible for the array to hold heterogeneous SRIDed geom/geog objects.
</pre>
<p class="item_name">RESULT</p>
<pre>    Depends on @p_action. 
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - May 2018 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo116"></a>
<a name="TOOLS2fdhms2028200829"></a>
<h1>117.  TOOLS/dhms (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    dhms -- Function that takes a duration/time in seconds and returns a string that include the number of elapsed days.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function dhms(@p_seconds float)
     Returns varchar(100)
</pre>
<p class="item_name">USAGE</p>
<pre>     SELECT [$(owner)].dhms((2.0 * 24.0 * 60.0 * 60.0) + 923.3) as dhms;
     dhms
     2:00:15:23:300
     SELECT [$(owner)].dhms((2.0 * 24.0 * 60.0 * 60.0) + 923) as dhms;
     dhms
     2:00:15:23
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Function that takes a duration expressed in seconds, and returns a string that included days, hours, minutes and seconds.
    ie  DAYS:HOURS:MINUTES:SECONDS{:MICROSECONDS}
    If the input seconds has decimal places, they are returned, if not they aren't.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_seconds      (float) : Non-NULL duration expressed in seconds.
</pre>
<p class="item_name">RESULT</p>
<pre>    formated date (varchar) : Date formatted as DAYS:HOURS:MINUTES:SECONDS{:MICROSECONDS}
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - June 2018 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo117"></a>
<a name="TOOLS2fGenerate5fSeries2028200829"></a>
<h1>118.  TOOLS/Generate_Series (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    Generate_Series - Creates a series of integers.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function Generate_Series(
       @p_start int,
       @p_end   int,
       @p_step  int
     )
     Returns @Integers TABLE 
     (
       IntValue int
     )  
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function creates an array or series of integers starting at @p_start and finishing at @p_end.
    The increment between the integer values is supplied by @p_step.
    To generate 2, 4, 6, 8, 10 one calls the function as follows Generate_Series(2,10,2).
    Negative values are supported.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_start (int) - Starting integer.
    @p_end   (int) - Finishing integer.
    @p_step  (int) - Step or increment.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT t.IntValue
      FROM [$(owner)].[Generate_Series](2,10,2) as t;
    GO
    IntValue
    --------
           2
           5
           6
           8
          10
</pre>
<p class="item_name">RESULT</p>
<pre>    Table (Array) of Integers
     IntValue (int) - Generates integer value
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Dec 2017 - TSQL SQL Server
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo118"></a>
<a name="TOOLS2fSTIsGeographicSrid2028201229"></a>
<h1>119.  TOOLS/STIsGeographicSrid (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STIsGeographicSrid -- Checks @p_srid to see if exists in sys.spatial_reference_systems table (which holds geodetic SRIDS)
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STIsGeographicSrid (
               @p_srid int 
             )
     Returns bit 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STIsGeographicSrid](4283) as isGeographicSrid
    GO
    isGeographicSrid
    ----------------
    1
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    All geographic/geodetic SRIDs are stored in the sys.spatial_reference_systems table.
    This function checks to see if the supplied SRID is in that table. 
    If it is, 1 is returned otherwise 0.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_srid (int) - Srid value.
</pre>
<p class="item_name">RESULT</p>
<pre>    Y/N     (bit) - 1 if True; 0 if False
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - June 2018 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo119"></a>
<a name="TOOLS2fSTNumArray2028200829"></a>
<h1>120.  TOOLS/STNumArray (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STNumArray -- Return number of elements in the array (size).
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STNumArray 
    (
       @p_array xml
    )
    Returns int 
</pre>
<p class="item_name">USAGE</p>
<pre>    SELECT [$(owner)].[STNumArray](@p_array) as count;
    Count
    45
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function returns the number of element in the supplied array (count)
    Returns 0 is @p_array is NULL
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_array  (xml) : Array itself
</pre>
<p class="item_name">RESULT</p>
<pre>    Size/Count (int)
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - May 2018 - Original TSQL Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo120"></a>
<a name="TOOLS2fSTPointAsText2028200829"></a>
<h1>121.  TOOLS/STPointAsText (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    STPointAsText -- Function that returns a formatted string representation of a coordinate.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function STPointAsText (
        @p_dimensions varchar(4),  - XY, XYZ, XYM, XYZM or NULL (XY)
        @p_X          float,
        @p_Y          float,
        @p_Z          float,
        @p_M          float,
        @p_round_x    int = 3,
        @p_round_y    int = 3,
        @p_round_z    int = 2,
        @p_round_m    int = 2
     )
     Returns varchar(max)
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    With Data As (
      select CAST('XY' as varchar(4)) as ords, CAST([dbo].[STPointAsText]('XY',0.1,0.2,0.3,0.41,3,3,2,1) as varchar(40)) as coords
      union all
      select 'XYZ'                    as ords, [dbo].[STPointAsText]('XYZ',0.1,0.2,0.3,0.41,3,3,2,1) as coords
      union all
      select 'XYM'                    as ords, [dbo].[STPointAsText]('XYM',0.1,0.2,0.3,0.41,3,3,2,1) as coords
      union all
      select 'XYZM'                   as ords, [dbo].[STPointAsText]('XYZM',0.1,0.2,0.3,0.41,3,3,2,1) as coords
    )
    select a.ords,
           geometry::STGeomFromText (
             'POINT (' + a.coords + ')',0).AsTextZM() as point
      from data as a;
    GO

    ords point
    XY   POINT (0.1 0.2)
    XYZ  POINT (0.1 0.2 0.3)
    XYM  POINT (0.1 0.2 NULL 0.4)
    XYZM POINT (0.1 0.2 0.3 0.4)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    This function returns a formatted string representation of a coordinate with up to 4 ordinates.
    Because ordinates can be NULL, the @p_dimensions instructs the function which ordinates are to be used.
    The function is suitable for use in WKT text constructors as shown in the USAGE element of this documentation.
    The function correctly rounds each ordinate using the supplied rounding factor.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_dimensions (varchar 4) - Ordinates to process. Valid values are XY, XYZ, XYM, XYZM or NULL (XY)
    @p_X          (float)     - X Ordinate
    @p_Y          (float)     - Y Ordinate
    @p_Z          (float)     - Z Ordinate
    @p_M          (float)     - M Ordinate
    @p_round_x    (int)       - X Ordinate rounding factor.
    @p_round_y    (int)       - Y Ordinate rounding factor.
    @p_round_z    (int)       - Z Ordinate rounding factor.
    @p_round_m    (int)       - M Ordinate rounding factor.
</pre>
<p class="item_name">RESULT</p>
<pre>    formatted string (varchar max) - Formatted string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - December 2017 - Original Coding for SQL Server.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo121"></a>
<a name="TOOLS2fTokenizer2028200829"></a>
<h1>122.  TOOLS/Tokenizer (2008) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    Tokenizer - Splits any string into tokens and separators.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function Tokenizer (
       @p_string     varchar(max),
       @p_separators varchar(254)
     )
     Returns @varchar_table TABLE 
     (
       id        int,
       token     varchar(MAX),
       separator varchar(MAX)
     ) 
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT t.id, t.token, t.separator
      FROM [$(owner)].[TOKENIZER]('LINESTRING(0 0,1 1)',' ,()') as t
    GO
    id token       separator
    -- ---------- ---------
     1 LINESTRING (
     2 0          NULL
     3 0          ,
     4 1          NULL 
     5 1          )
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied a string and a list of separators this function returns resultant tokens as a table collection.
    Function returns both the token and the separator.
    Returned table collection contains a unique identifier to ensure tokens and separators are always correctly ordered.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_string     (varchar max) - Any non-null string.
    @p_separators (varchar 254) - List of separators eg '(),'
</pre>
<p class="item_name">RESULT</p>
<pre>    Table (Array) of Integers
      id        (int)         - Unique identifier for each row starting with first token/separator found.
      token     (varchar MAX) - Token between separators
      separator (varchar MAX) - Separator between tokens.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Pawel Barut, <a href="http://pbarut.blogspot.com/2007/03/yet-another-tokenizer-in-oracle.html">http://pbarut.blogspot.com/2007/03/yet-another-tokenizer-in-oracle.html</a>
    Simon Greener - Aug 2008 - Converted to SQL Server 2008
    Simon Greener - Aug 2012 - Added extra return variables.
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<a name="robo122"></a>
<a name="TOOLS2fTokenizer2028201229"></a>
<h1>123.  TOOLS/Tokenizer (2012) [ Functions ]  </h1>
<p>[ <a href="#robo_top_of_doc">Top</a> ] [ Functions ]</p>
<p class="item_name">NAME</p>
<pre>    Tokenizer - Splits any string into tokens and separators.
</pre>
<p class="item_name">SYNOPSIS</p>
<pre>    Function Tokenizer (
       @p_string     varchar(max),
       @p_separators varchar(254)
     )
     Returns @varchar_table TABLE 
     (
       id        int,
       token     varchar(MAX),
       separator varchar(MAX)
     ) 
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    SELECT t.id, t.token, t.separator
      FROM [$(owner)].[TOKENIZER]('LINESTRING(0 0,1 1)',' ,()') as t
    GO
    id token       separator
    -- ---------- ---------
     1 LINESTRING (
     2 0          NULL
     3 0          ,
     4 1          NULL 
     5 1          )
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Supplied a string and a list of separators this function returns resultant tokens as a table collection.
    Function returns both the token and the separator.
    Returned table collection contains a unique identifier to ensure tokens and separators are always correctly ordered.
</pre>
<p class="item_name">INPUTS</p>
<pre>    @p_string     (varchar max) - Any non-null string.
    @p_separators (varchar 254) - List of separators eg '(),'
</pre>
<p class="item_name">RESULT</p>
<pre>    Table (Array) of Integers
      id        (int)         - Unique identifier for each row starting with first token/separator found.
      token     (varchar MAX) - Token between separators
      separator (varchar MAX) - Separator between tokens.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Simon Greener
</pre>
<p class="item_name">HISTORY</p>
<pre>    Simon Greener - Aug 2012 - Converted to SQL Server 2012 (Uses new Lag/Lead function and returns separators)
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    (c) 2008-2018 by TheSpatialDBAdvisor/Simon Greener
</pre>
<div id="footer">
<p>Generated from ./src/general/ on Thu Oct 10 2019 09:54:20
</p>
</div> <!-- footer -->
</body>
</html>
